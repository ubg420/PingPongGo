var Utils,Elements,previousTime,canvasX,canvasY,sound,music,assetLib,preAssetLib,delta,prevGameState,panel,background,aLevelUps,levelBonusScore,bonusScore,panelFrame,oLogoBut,tableTop,userBat,enemyBat,aSeasonFlags,aSeasonFlagsRender,startTouchY,aEffects,gameType,aProgressButs,curTournLevelId,isSpecialGame,lastUnlockedChar,curTime,hitFirstShot,bottleGameState,batShop,prevGameplayState,aBalls,awardPanel,__extends=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function s(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(s.prototype=a.prototype,new s)}}();!function(e){var t=function(){function e(e,t,a,s,i,r){void 0===r&&(r=!0),this.oAssetData={},this.assetsLoaded=0,this.textData={},this.spinnerRot=0,this.totalAssets=t.length,this.showBar=r;for(var o=0;o<t.length;o++)-1!=t[o].file.indexOf(".json")?this.loadJSON(t[o]):this.loadImage(t[o]);r&&(this.oLoaderImgData=preAssetLib.getData("loader"),this.oLoadSpinnerImgData=preAssetLib.getData("loadSpinner"))}return e.prototype.render=function(){ctx.fillStyle="rgba(0, 0, 0, 1)",ctx.fillRect(0,0,canvas.width,canvas.height),ctx.fillStyle="#FFFFFF",ctx.fillRect(canvas.width/2-150,canvas.height/2+20,300/this.totalAssets*this.assetsLoaded,30),ctx.drawImage(this.oLoaderImgData.img,canvas.width/2-this.oLoaderImgData.img.width/2,canvas.height/2-this.oLoaderImgData.img.height/2),this.spinnerRot+=3*delta,ctx.save(),ctx.translate(canvas.width/2-38,canvas.height/2-16),ctx.scale(.7+Math.sin(2*this.spinnerRot)/10,.7+Math.sin(2*this.spinnerRot)/10),ctx.rotate(this.spinnerRot),ctx.drawImage(this.oLoadSpinnerImgData.img,-this.oLoadSpinnerImgData.img.width/2,-this.oLoadSpinnerImgData.img.height/2),ctx.restore(),this.displayNumbers()},e.prototype.displayNumbers=function(){ctx.textAlign="left",ctx.font="bold 40px arial",ctx.fillStyle="#ffffff",ctx.fillText(Math.round(this.assetsLoaded/this.totalAssets*100)+"%",canvas.width/2-0,canvas.height/2-1)},e.prototype.loadExtraAssets=function(e,t){this.showBar=!1,this.totalAssets=t.length,this.assetsLoaded=0,this.loadedCallback=e;for(var a=0;a<t.length;a++)-1!=t[a].file.indexOf(".json")?this.loadJSON(t[a]):this.loadImage(t[a])},e.prototype.loadJSON=function(e){var t=this,a=new XMLHttpRequest;a.open("GET",e.file,!0),a.onreadystatechange=function(){4==a.readyState&&200==a.status&&(t.textData[e.id]=JSON.parse(a.responseText),++t.assetsLoaded,t.checkLoadComplete())},a.send(null)},e.prototype.loadImage=function(e){var t=this,a=new Image;a.onload=function(){t.oAssetData[e.id]={},t.oAssetData[e.id].img=a,t.oAssetData[e.id].oData={};var s=t.getSpriteSize(e.file);0!=s[0]?(t.oAssetData[e.id].oData.spriteWidth=s[0],t.oAssetData[e.id].oData.spriteHeight=s[1]):(t.oAssetData[e.id].oData.spriteWidth=t.oAssetData[e.id].img.width,t.oAssetData[e.id].oData.spriteHeight=t.oAssetData[e.id].img.height),e.oAnims&&(t.oAssetData[e.id].oData.oAnims=e.oAnims),e.oAtlasData?t.oAssetData[e.id].oData.oAtlasData=e.oAtlasData:t.oAssetData[e.id].oData.oAtlasData={none:{x:0,y:0,width:t.oAssetData[e.id].oData.spriteWidth,height:t.oAssetData[e.id].oData.spriteHeight}},++t.assetsLoaded,t.checkLoadComplete()},a.src=e.file},e.prototype.getSpriteSize=function(e){for(var t=[],a="",s="",i=0,r=e.lastIndexOf("."),o=!0;o;)r--,0==i&&this.isNumber(e.charAt(r))?a=e.charAt(r)+a:0==i&&a.length>0&&"x"==e.charAt(r)?(r--,i=1,s=e.charAt(r)+s):1==i&&this.isNumber(e.charAt(r))?s=e.charAt(r)+s:1==i&&s.length>0&&"_"==e.charAt(r)?(o=!1,t=[parseInt(s),parseInt(a)]):(o=!1,t=[0,0]);return t},e.prototype.isNumber=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},e.prototype.checkLoadComplete=function(){this.assetsLoaded==this.totalAssets&&this.loadedCallback()},e.prototype.onReady=function(e){this.loadedCallback=e},e.prototype.getImg=function(e){return this.oAssetData[e].img},e.prototype.getData=function(e){return this.oAssetData[e]},e}();e.AssetLoader=t}(Utils||(Utils={})),function(e){var t=function(){function e(e,t,a,s){this.x=0,this.y=0,this.rotation=0,this.radius=10,this.removeMe=!1,this.frameInc=0,this.animType="loop",this.offsetX=0,this.offsetY=0,this.scaleX=1,this.scaleY=1,this.alpha=1,this.oImgData=e,this.oAnims=this.oImgData.oData.oAnims,this.fps=t,this.radius=a,this.animId=s,this.centreX=Math.round(this.oImgData.oData.spriteWidth/2),this.centreY=Math.round(this.oImgData.oData.spriteHeight/2)}return e.prototype.updateAnimation=function(e){this.frameInc+=this.fps*e},e.prototype.changeImgData=function(e,t){this.oImgData=e,this.oAnims=this.oImgData.oData.oAnims,this.animId=t,this.centreX=Math.round(this.oImgData.oData.spriteWidth/2),this.centreY=Math.round(this.oImgData.oData.spriteHeight/2),this.resetAnim()},e.prototype.resetAnim=function(){this.frameInc=0},e.prototype.setFrame=function(e){this.fixedFrame=e},e.prototype.setAnimType=function(e,t,a){switch(void 0===a&&(a=!0),this.animId=t,this.animType=e,a&&this.resetAnim(),e){case"loop":break;case"once":this.maxIdx=this.oAnims[this.animId].length-1}},e.prototype.render=function(e){if(e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.scale(this.scaleX,this.scaleY),e.globalAlpha=this.alpha,null!=this.animId){var t=this.oAnims[this.animId].length,a=Math.floor(this.frameInc);this.curFrame=this.oAnims[this.animId][a%t];var s=this.curFrame*this.oImgData.oData.spriteWidth%this.oImgData.img.width,i=Math.floor(this.curFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;if("once"==this.animType&&a>this.maxIdx){this.fixedFrame=this.oAnims[this.animId][t-1],this.animId=null,null!=this.animEndedFunc&&this.animEndedFunc();var s=this.fixedFrame*this.oImgData.oData.spriteWidth%this.oImgData.img.width,i=Math.floor(this.fixedFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight}}else var s=this.fixedFrame*this.oImgData.oData.spriteWidth%this.oImgData.img.width,i=Math.floor(this.fixedFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;e.drawImage(this.oImgData.img,s,i,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight,-this.centreX+this.offsetX,-this.centreY+this.offsetY,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight),e.restore()},e.prototype.renderSimple=function(e){if(null!=this.animId){var t=this.oAnims[this.animId].length,a=Math.floor(this.frameInc);this.curFrame=this.oAnims[this.animId][a%t];var s=this.curFrame*this.oImgData.oData.spriteWidth%this.oImgData.img.width,i=Math.floor(this.curFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;if("once"==this.animType&&a>this.maxIdx){this.fixedFrame=this.oAnims[this.animId][t-1],this.animId=null,null!=this.animEndedFunc&&this.animEndedFunc();var s=this.fixedFrame*this.oImgData.oData.spriteWidth%this.oImgData.img.width,i=Math.floor(this.fixedFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight}}else var s=this.fixedFrame*this.oImgData.oData.spriteWidth%this.oImgData.img.width,i=Math.floor(this.fixedFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;e.drawImage(this.oImgData.img,s,i,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight,this.x-(this.centreX-this.offsetX)*this.scaleX,this.y-(this.centreY-this.offsetY)*this.scaleY,this.oImgData.oData.spriteWidth*this.scaleX,this.oImgData.oData.spriteHeight*this.scaleY)},e}();e.AnimSprite=t}(Utils||(Utils={})),function(e){var t=function(){function e(e,t,a){void 0===a&&(a=0),this.x=0,this.y=0,this.rotation=0,this.radius=10,this.removeMe=!1,this.offsetX=0,this.offsetY=0,this.scaleX=1,this.scaleY=1,this.oImgData=e,this.radius=t,this.setFrame(a)}return e.prototype.setFrame=function(e){this.frameNum=e},e.prototype.render=function(e){e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.scale(this.scaleX,this.scaleY);var t=this.frameNum*this.oImgData.oData.spriteWidth%this.oImgData.img.width,a=Math.floor(this.frameNum/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;e.drawImage(this.oImgData.img,t,a,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight,-this.oImgData.oData.spriteWidth/2+this.offsetX,-this.oImgData.oData.spriteHeight/2+this.offsetY,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight),e.restore()},e}();e.BasicSprite=t}(Utils||(Utils={})),function(e){var t=function(){function e(e,t){var a=this;this.prevHitTime=0,this.pauseIsOn=!1,this.isDown=!1,this.sensitiveLevel=2,this.aSensitiveRates=[.25,.5,1,1.5,2],this.pointerLockState=0,this.isBugBrowser=t,this.keyDownEvtFunc=function(e){a.keyDown(e)},this.keyUpEvtFunc=function(e){a.keyUp(e)},document.addEventListener("mousemove",function(e){a.mouseX=e.pageX*=canvasScale,a.mouseY=e.pageY*=canvasScale,!isMobile&&(userBat&&(userBat.targX=a.mouseX,userBat.targY=a.mouseY),batShop&&"batShop"==gameState&&batShop.glowBut(a.mouseX,a.mouseY))},!1),e.addEventListener("contextmenu",function(e){return e.preventDefault()}),e.addEventListener("touchstart",function(e){for(var t=0;t<e.changedTouches.length;t++)a.hitDown(e,e.changedTouches[t].pageX*canvasScale,e.changedTouches[t].pageY*canvasScale,e.changedTouches[t].identifier)},!1),e.addEventListener("touchend",function(e){for(var t=0;t<e.changedTouches.length;t++)a.hitUp(e,e.changedTouches[t].pageX*canvasScale,e.changedTouches[t].pageY*canvasScale,e.changedTouches[t].identifier)},!1),e.addEventListener("touchcancel",function(e){for(var t=0;t<e.changedTouches.length;t++)a.hitCancel(e,e.changedTouches[t].pageX*canvasScale,e.changedTouches[t].pageY*canvasScale,e.changedTouches[t].identifier)},!1),e.addEventListener("touchmove",function(e){for(var t=0;t<e.changedTouches.length;t++)a.move(e,e.changedTouches[t].pageX*canvasScale,e.changedTouches[t].pageY*canvasScale,e.changedTouches[t].identifier,!0)},!1),e.addEventListener("wheel",function(e){a.wheelScroll(e,e.deltaY)},!1),e.addEventListener("mousedown",function(e){a.isDown=!0,a.hitDown(e,a.mouseX,a.mouseY,1)},!1),e.addEventListener("mouseup",function(e){a.isDown=!1,a.hitUp(e,a.mouseX,a.mouseY,1)},!1),e.addEventListener("mousemove",function(e){a.move(e,a.mouseX,a.mouseY,1,a.isDown)},!1),e.addEventListener("mouseout",function(e){2!=e.button&&(clearButtonOvers(),a.isDown=!1,a.hitUp(e,Math.abs(a.mouseX),Math.abs(a.mouseY),1))},!1),this.aHitAreas=[],this.aKeys=[]}return e.prototype.pointerLockOn=function(){},e.prototype.pointerLockOff=function(){},e.prototype.wheelScroll=function(e,t){e.preventDefault(),e.stopPropagation(),"batShop"==gameState&&(batShop.targY-=t)},e.prototype.hitDown=function(e,t,a,s){if(e.preventDefault(),e.stopPropagation(),hasFocus||visibleResume(),!this.pauseIsOn){for(var i=new Date().getTime(),r=0;r<this.aHitAreas.length;r++)if(this.aHitAreas[r].rect){var o=canvas.width*this.aHitAreas[r].align[0],n=canvas.height*this.aHitAreas[r].align[1];if(t>o+this.aHitAreas[r].area[0]&&a>n+this.aHitAreas[r].area[1]&&t<o+this.aHitAreas[r].area[2]&&a<n+this.aHitAreas[r].area[3]){if(this.aHitAreas[r].aTouchIdentifiers.push(s),this.aHitAreas[r].oData.hasLeft=!1,this.aHitAreas[r].oData.isUp=!1,!this.aHitAreas[r].oData.isDown){if(this.aHitAreas[r].oData.isDown=!0,this.aHitAreas[r].oData.x=t,this.aHitAreas[r].oData.y=a,this.aHitAreas[r].oData.button=e.button,i-this.prevHitTime<500&&("game"!=gameState||"pause"==this.aHitAreas[r].id)&&isBugBrowser)return;this.aHitAreas[r].callback(this.aHitAreas[r].id,this.aHitAreas[r].oData)}break}}this.prevHitTime=i}},e.prototype.hitUp=function(e,t,a,s){if(ios9FirstTouch||(playSound("silence"),ios9FirstTouch=!0),!this.pauseIsOn){e.preventDefault(),e.stopPropagation();for(var i=0;i<this.aHitAreas.length;i++)if(this.aHitAreas[i].rect){var r=canvas.width*this.aHitAreas[i].align[0],o=canvas.height*this.aHitAreas[i].align[1];if(t>r+this.aHitAreas[i].area[0]&&a>o+this.aHitAreas[i].area[1]&&t<r+this.aHitAreas[i].area[2]&&a<o+this.aHitAreas[i].area[3]){for(var n=0;n<this.aHitAreas[i].aTouchIdentifiers.length;n++)this.aHitAreas[i].aTouchIdentifiers[n]==s&&(this.aHitAreas[i].aTouchIdentifiers.splice(n,1),n-=1);0==this.aHitAreas[i].aTouchIdentifiers.length&&(this.aHitAreas[i].oData.isDown=!1),this.aHitAreas[i].oData.isUp=!0,this.aHitAreas[i].oData.multiTouch&&(this.aHitAreas[i].oData.x=t,this.aHitAreas[i].oData.y=a,this.aHitAreas[i].oData.button=e.button,this.aHitAreas[i].callback(this.aHitAreas[i].id,this.aHitAreas[i].oData));break}}}},e.prototype.hitCancel=function(e,t,a,s){e.preventDefault(),e.stopPropagation();for(var i=0;i<this.aHitAreas.length;i++)this.aHitAreas[i].oData.isDown&&(this.aHitAreas[i].oData.isDown=!1,this.aHitAreas[i].aTouchIdentifiers=[],this.aHitAreas[i].oData.multiTouch&&(this.aHitAreas[i].oData.x=t,this.aHitAreas[i].oData.y=a,this.aHitAreas[i].callback(this.aHitAreas[i].id,this.aHitAreas[i].oData)))},e.prototype.move=function(e,t,a,s,i){if(!isMobile&&(userBat&&(userBat.targX=t*canvasScale,userBat.targY=a*canvasScale),batShop&&"batShop"==gameState&&batShop.glowBut(t*canvasScale,a*canvasScale)),!this.pauseIsOn&&i){for(var r=0;r<this.aHitAreas.length;r++)if(this.aHitAreas[r].rect){var o=canvas.width*this.aHitAreas[r].align[0],n=canvas.height*this.aHitAreas[r].align[1];if(t>o+this.aHitAreas[r].area[0]&&a>n+this.aHitAreas[r].area[1]&&t<o+this.aHitAreas[r].area[2]&&a<n+this.aHitAreas[r].area[3])this.aHitAreas[r].oData.hasLeft=!1,this.aHitAreas[r].oData.isDraggable&&!this.aHitAreas[r].oData.isDown&&(this.aHitAreas[r].oData.isDown=!0,this.aHitAreas[r].oData.x=t,this.aHitAreas[r].oData.y=a,this.aHitAreas[r].aTouchIdentifiers.push(s),this.aHitAreas[r].oData.multiTouch&&this.aHitAreas[r].callback(this.aHitAreas[r].id,this.aHitAreas[r].oData)),this.aHitAreas[r].oData.isDraggable&&(this.aHitAreas[r].oData.isBeingDragged=!0,this.aHitAreas[r].oData.x=t,this.aHitAreas[r].oData.y=a,this.aHitAreas[r].callback(this.aHitAreas[r].id,this.aHitAreas[r].oData),this.aHitAreas[r]&&(this.aHitAreas[r].oData.isBeingDragged=!1));else if(this.aHitAreas[r].oData.isDown&&!this.aHitAreas[r].oData.hasLeft){for(var l=0;l<this.aHitAreas[r].aTouchIdentifiers.length;l++)this.aHitAreas[r].aTouchIdentifiers[l]==s&&(this.aHitAreas[r].aTouchIdentifiers.splice(l,1),l-=1);0==this.aHitAreas[r].aTouchIdentifiers.length&&(this.aHitAreas[r].oData.hasLeft=!0,this.aHitAreas[r].oData.isBeingDragged||(this.aHitAreas[r].oData.isDown=!1),this.aHitAreas[r].oData.multiTouch&&this.aHitAreas[r].callback(this.aHitAreas[r].id,this.aHitAreas[r].oData))}}}},e.prototype.keyDown=function(e){for(var t=0;t<this.aKeys.length;t++)e.keyCode==this.aKeys[t].keyCode&&(e.preventDefault(),this.aKeys[t].oData.isDown=!0,this.aKeys[t].callback(this.aKeys[t].id,this.aKeys[t].oData))},e.prototype.keyUp=function(e){for(var t=0;t<this.aKeys.length;t++)e.keyCode==this.aKeys[t].keyCode&&(e.preventDefault(),this.aKeys[t].oData.isDown=!1,this.aKeys[t].callback(this.aKeys[t].id,this.aKeys[t].oData))},e.prototype.checkKeyFocus=function(){window.focus(),this.aKeys.length>0&&(window.removeEventListener("keydown",this.keyDownEvtFunc,!1),window.removeEventListener("keyup",this.keyUpEvtFunc,!1),window.addEventListener("keydown",this.keyDownEvtFunc,!1),window.addEventListener("keyup",this.keyUpEvtFunc,!1))},e.prototype.addKey=function(e,t,a,s){null==a&&(a={}),this.aKeys.push({id:e,callback:t,oData:a,keyCode:s}),this.checkKeyFocus()},e.prototype.removeKey=function(e){for(var t=0;t<this.aKeys.length;t++)this.aKeys[t].id==e&&(this.aKeys.splice(t,1),t-=1)},e.prototype.addHitArea=function(e,t,a,s,i,r){void 0===r&&(r=!1),null==a&&(a={}),r&&this.removeHitArea(e),i.scale||(i.scale=1),i.align||(i.align=[0,0]);var o,n=[];switch(s){case"image":o=[i.aPos[0]-i.oImgData.oData.oAtlasData[i.id].width/2*i.scale,i.aPos[1]-i.oImgData.oData.oAtlasData[i.id].height/2*i.scale,i.aPos[0]+i.oImgData.oData.oAtlasData[i.id].width/2*i.scale,i.aPos[1]+i.oImgData.oData.oAtlasData[i.id].height/2*i.scale],this.aHitAreas.push({id:e,aTouchIdentifiers:n,callback:t,oData:a,rect:!0,area:o,align:i.align});break;case"rect":this.aHitAreas.push({id:e,aTouchIdentifiers:n,callback:t,oData:a,rect:!0,area:i.aRect,align:i.align})}},e.prototype.removeHitArea=function(e){for(var t=0;t<this.aHitAreas.length;t++)this.aHitAreas[t].id==e&&(this.aHitAreas.splice(t,1),t-=1)},e.prototype.resetAll=function(){for(var e=0;e<this.aHitAreas.length;e++)this.aHitAreas[e].oData.isDown=!1,this.aHitAreas[e].oData.isBeingDragged=!1,this.aHitAreas[e].aTouchIdentifiers=[];this.isDown=!1},e}();e.UserInput=t}(Utils||(Utils={})),function(e){var t=function(){function e(e){this.updateFreq=10,this.updateInc=0,this.frameAverage=0,this.display=1,this.log="",this.render=function(e){this.frameAverage+=this.delta/this.updateFreq,++this.updateInc>=this.updateFreq&&(this.updateInc=0,this.display=this.frameAverage,this.frameAverage=0),e.textAlign="left",ctx.font="10px Helvetica",e.fillStyle="#333333",e.beginPath(),e.rect(0,this.canvasHeight-15,40,15),e.closePath(),e.fill(),e.fillStyle="#ffffff",e.fillText(Math.round(1e3/(1e3*this.display))+" fps "+this.log,5,this.canvasHeight-5)},this.canvasHeight=e}return e.prototype.update=function(e){this.delta=e},e}();e.FpsMeter=t}(Utils||(Utils={})),function(e){var t=function(){function e(){this.bgId=0,this.inc=0}return e.prototype.setRandom=function(){var e=this.bgId;for(this.bgId=Math.floor(5*Math.random());e==this.bgId;)this.bgId=Math.floor(5*Math.random());4==gameVariation&&(this.bgId=Math.floor(4*Math.random())+1)},e.prototype.render=function(){(0==gameplayState||0==gameVariation)&&(this.bgId=Math.floor(curLevel/levelsPerWorld)%5),this.oImgData=assetLib.getData("bg"+this.bgId);var e=Math.max(canvas.width,canvas.height)/900;ctx.drawImage(this.oImgData.img,0,0,this.oImgData.img.width,this.oImgData.img.height,canvas.width/2-this.oImgData.img.width/2*e,canvas.height/2-this.oImgData.img.height/2*e,this.oImgData.img.height*e,this.oImgData.img.height*e)},e}();e.Background=t}(Elements||(Elements={})),function(e){var t=function(){function t(e,t){this.timer=.3,this.endTime=0,this.posY=0,this.incY=0,this.flareRot=0,this.cupFlipInc=0,this.userCardScale=1,this.enemyCardScale=1,this.userBatX=0,this.userBatY=0,this.enemyBatX=0,this.enemyBatY=0,this.ballX=0,this.ballY=0,this.ballHeight=0,this.flashInc=0,this.promptOffScreen=!1,this.starsY=0,this.starsX=0,this.levelCompleteInc=0,this.batRotation=0,this.batScale=1,this.batSpin=1,this.scoreSideY0=0,this.scoreSideY1=0,this.bugTimeY=1,this.adBlockInc=1,this.congratsInc=1,this.congratsId=0,this.mapState=0,this.mapInc=1,this.mapScale=1,this.mapPinScale=0,this.mapPos=0,this.linkTextId=0,this.shareButOn=!1,this.disconnectInc=0,this.pvpStartInc=1,this.oSplashLogoImgData=assetLib.getData("splashLogo"),this.oUiElementsImgData=assetLib.getData("uiElements"),this.oGameElementsImgData=assetLib.getData("gameElements"),this.oUiButsImgData=assetLib.getData("uiButs"),this.oSpecialSpinnerImgData=assetLib.getData("specialSpinner"),this.oTopFlareImgData=assetLib.getData("flare"),this.panelType=e,this.aButs=t,this.cupFlipInc=0}return t.prototype.update=function(){this.incY+=10*delta},t.prototype.clipboardCallback=function(e){0==e?this.linkTextId=2:1==e&&(this.linkTextId=1)},t.prototype.showDisconnect=function(e){var t=this;this.adBlocktween&&this.adBlocktween.kill(),this.errorText=e,this.disconnectInc=0,this.adBlocktween=TweenLite.to(this,.5,{disconnectInc:1,ease:"Cubic.easeOut",onComplete:function(){t.adBlocktween=TweenLite.to(t,.5,{disconnectInc:0,delay:3,ease:"Cubic.easeIn"})}})},t.prototype.adBlockInfo=function(){1!=this.adBlockInc&&(ctx.fillStyle="rgba(100, 0, 0, 1)",ctx.fillRect(canvas.width/2-260,canvas.height-60+100*this.adBlockInc,520,50),addText(0,40,500,"center",canvas.width/2,canvas.height-25+100*this.adBlockInc,"adBlock","#FFFFFF"))},t.prototype.showAdBlockMessage=function(){var e=this;this.adBlocktween&&this.adBlocktween.kill(),this.adBlockInc=1,this.adBlocktween=TweenLite.to(this,.5,{adBlockInc:0,ease:"Cubic.easeOut",onComplete:function(){e.adBlocktween=TweenLite.to(e,.5,{adBlockInc:1,delay:3,ease:"Cubic.easeIn"})}})},t.prototype.showPvpStartMessage=function(){var e=this;this.pvpStartInc=1,TweenLite.to(this,.3,{pvpStartInc:0,ease:"Cubic.easeOut",onComplete:function(){TweenLite.to(e,.3,{pvpStartInc:1,delay:.5,ease:"Cubic.easeIn"})}})},t.prototype.mapIntro=function(){var t=this;this.mapState=0,this.mapScale=2,this.mapPos=0,playSound("worldComplete",.3),TweenLite.to(this,.5,{mapScale:1,ease:"Cubic.easeOut",onComplete:function(){playSound("arcadeWin",1),t.mapState=1,t.mapPinScale=0;for(var a=0;a<200;a++){var s=new e.Confetti(Math.random()*canvas.width,Math.random()*canvas.height);aEffects.push(s)}TweenLite.to(t,1,{mapScale:1.6,mapPos:1,ease:"Cubic.easeInOut",onComplete:function(){}}),TweenLite.to(t,.5,{mapPinScale:1,ease:"Back.easeOut",onComplete:function(){playSound("hitTarget",.6),addMapButs(),t.mapState=2}})}})},t.prototype.congratsUpdate=function(){1!=this.congratsInc&&(addText(0,100,canvas.width-100,"center",canvas.width/2,.9*canvas.height+100*this.congratsInc+2,"congrats"+this.congratsId,"#D700FF"),addText(0,100,canvas.width-100,"center",canvas.width/2,.9*canvas.height+100*this.congratsInc,"congrats"+this.congratsId,"#FFFFFF"))},t.prototype.showCongrats=function(){var e=this;this.congratsTween&&this.congratsTween.kill(),tableTop.tweenColours(),this.congratsInc=1,this.congratsId=Math.floor(20*Math.random()),this.congratsTween=TweenLite.to(this,.25,{congratsInc:0,ease:"Cubic.easeOut",onComplete:function(){e.congratsTween=TweenLite.to(e,.25,{congratsInc:1,delay:1,ease:"Cubic.easeIn"})}})},t.prototype.startTween=function(){this.posY=500,TweenLite.to(this,.5,{posY:0,ease:"Back.easeOut"}),this.butsY=500,TweenLite.to(this,.3,{butsY:0,ease:"Cubic.easeOut"})},t.prototype.startGameTween=function(){this.starsTween&&this.starsTween.kill(),this.starsY=1,this.scoreSideY0=1,this.scoreSideY1=1,this.starsTween=TweenLite.to(this,.5,{starsY:0,scoreSideY0:0,scoreSideY1:0,ease:"Back.easeOut"})},t.prototype.tweenStars=function(e){var t=this;this.starsTween&&this.starsTween.kill(),e?this.starsTween=TweenLite.to(this,.1,{starsY:-.4,ease:"Cubic.easeOut",onComplete:function(){t.starsTween=TweenLite.to(t,.6,{starsY:0,ease:"Bounce.easeOut",onComplete:function(){}})}}):(this.starsX=-.3,this.starsTween=TweenLite.to(this,1,{starsX:0,ease:"Elastic.easeOut"}))},t.prototype.tweenTargetGameComplete=function(){this.levelCompleteTween&&this.levelCompleteTween.kill(),this.levelCompleteInc=1,this.levelCompleteTween=TweenLite.to(this,.5,{levelCompleteInc:0,ease:"Cubic.easeOut",onComplete:function(){}}),Math.round(curTargetScore/2)>0&&(this.aWinGems=[],this.winGemTarg=Math.round(curTargetScore/2),this.winGemCount=this.winGemTarg+30,setTimeout(function(){playSound("gemTweenOut")},800))},t.prototype.tweenBugGameComplete=function(){this.levelCompleteTween&&this.levelCompleteTween.kill(),this.levelCompleteInc=1,this.levelCompleteTween=TweenLite.to(this,.5,{levelCompleteInc:0,ease:"Cubic.easeOut",onComplete:function(){}}),Math.ceil(bugScore/4)>0&&(this.aWinGems=[],this.winGemTarg=Math.ceil(bugScore/4),this.winGemCount=this.winGemTarg+30,setTimeout(function(){playSound("gemTweenOut")},800))},t.prototype.addBugTime=function(){var e=this;bugTime=Math.max(bugTime-bugBonusTime,0),this.bugTimeTween&&this.bugTimeTween.kill(),this.bugTimeY=1,this.bugTimeTween=TweenLite.to(this,.5,{bugTimeY:0,ease:"Cubic.easeOut",onComplete:function(){e.bugTimeTween=TweenLite.to(e,.5,{bugTimeY:-1,delay:1,ease:"Cubic.easeIn",onComplete:function(){e.bugTimeY=1}})}})},t.prototype.tweenPvpGameComplete=function(){this.levelCompleteTween&&this.levelCompleteTween.kill(),this.levelCompleteInc=1,this.levelCompleteTween=TweenLite.to(this,.5,{levelCompleteInc:0,ease:"Cubic.easeOut",onComplete:function(){}}),this.aWinGems=[],userScore>enemyScore?this.winGemTarg=userScore+25:this.winGemTarg=enemyScore,setTimeout(function(){playSound("gemTweenOut")},800),this.winGemCount=this.winGemTarg+30},t.prototype.tweenCustomGameComplete=function(){this.levelCompleteTween&&this.levelCompleteTween.kill(),this.levelCompleteInc=1,this.levelCompleteTween=TweenLite.to(this,.5,{levelCompleteInc:0,ease:"Cubic.easeOut",onComplete:function(){}}),this.aWinGems=[],userSets>enemySets?this.winGemTarg=50+10*saveDataHandler.getSeason()+saveDataHandler.getRound():this.winGemTarg=25,setTimeout(function(){playSound("gemTweenOut")},800),this.winGemCount=this.winGemTarg+30},t.prototype.tweenTargetGameScore=function(){this.starsTween&&this.starsTween.kill(),this.starsY=1,this.starsTween=TweenLite.to(this,.5,{starsY:0,ease:"Bounce.easeOut"})},t.prototype.tweenCustomGameScore=function(e){var t;this.starsTween&&this.starsTween.kill(),this["scoreSideY"+e]=1,this.starsTween=TweenLite.to(this,.5,((t={})["scoreSideY"+e]=0,t.ease="Bounce.easeOut",t))},t.prototype.tweenLevelComplete=function(){if(this.levelCompleteTween&&this.levelCompleteTween.kill(),this.levelCompleteInc=1,this.levelCompleteTween=TweenLite.to(this,.5,{levelCompleteInc:0,ease:"Cubic.easeOut",onComplete:function(){}}),this.aWinGems=[],(curLevel+1)%levelsPerWorld==0){this.winGemTarg=aPointScores[1];for(var e=Math.floor((curLevel+1)/levelsPerWorld),t=0;t<aBatData.length;t++)if(aBatData[t].unlockWorld==e){batUnlockedId=t;break}}else this.winGemTarg=aPointScores[0];setTimeout(function(){playSound("gemTweenOut")},800),this.winGemCount=this.winGemTarg+30},t.prototype.tweenWorldComplete=function(){this.levelCompleteTween&&this.levelCompleteTween.kill(),this.levelCompleteInc=1,this.levelCompleteTween=TweenLite.to(this,.5,{levelCompleteInc:0,ease:"Cubic.easeOut",onComplete:function(){}}),this.batScale=3,TweenLite.to(this,1.5,{batScale:1.5,ease:"Back.easeIn",onComplete:function(){}})},t.prototype.tweenGem=function(){TweenLite.to(this,.5,{levelCompleteInc:0,ease:"Cubic.easeOut",onComplete:function(){}})},t.prototype.startTut=function(){var e=this;this.userBatX=-50,this.userBatY=85,this.enemyBatX=0,this.enemyBatY=-130,this.ballX=0,this.ballY=19,TweenLite.to(this,.55,{delay:.35,userBatX:50,userBatY:-60,ease:"Back.easeOut",onComplete:function(){e.movePlayerBat(0)}}),TweenLite.to(this,.5,{delay:.8,enemyBatX:50,ease:"Back.easeOut",onComplete:function(){}}),this.ballHeight=30,TweenLite.to(this,.55,{delay:.5,ballX:30,ballY:-100,ease:"Linear.easeNone",onComplete:function(){}}),TweenLite.to(this,.6,{delay:.6,ballHeight:-30,ease:"Quad.easeIn",onComplete:function(){}})},t.prototype.movePlayerBat=function(e){var t=this;switch(e){case 0:TweenLite.to(this,.5,{userBatX:130,userBatY:85,ease:"Quad.easeInOut",onComplete:function(){t.movePlayerBat(1)}}),TweenLite.to(this,.65,{delay:.25,ballX:75,ballY:50,ease:"Quad.easeIn",onComplete:function(){TweenLite.to(t,.65,{ballX:-20,ballY:-100,ease:"Quad.easeOut",onComplete:function(){}})}}),TweenLite.to(this,.65,{delay:.25,ballHeight:40,ease:"Quad.easeIn",onComplete:function(){TweenLite.to(t,.65,{ballHeight:-30,ease:"Quad.easeIn",onComplete:function(){}})}});break;case 1:TweenLite.to(this,.5,{delay:.3,userBatX:-30,userBatY:-60,ease:"Back.easeOut",onComplete:function(){t.movePlayerBat(2)}}),TweenLite.to(this,.5,{delay:.8,enemyBatX:-30,ease:"Back.easeOut",onComplete:function(){}});break;case 2:TweenLite.to(this,.5,{userBatX:-130,userBatY:85,ease:"Quad.easeInOut",onComplete:function(){t.movePlayerBat(3)}}),TweenLite.to(this,.65,{delay:.25,ballX:-75,ballY:50,ease:"Quad.easeIn",onComplete:function(){TweenLite.to(t,.65,{ballX:20,ballY:-100,ease:"Quad.easeOut",onComplete:function(){}})}}),TweenLite.to(this,.65,{delay:.25,ballHeight:40,ease:"Quad.easeIn",onComplete:function(){TweenLite.to(t,.65,{ballHeight:-30,ease:"Quad.easeIn",onComplete:function(){}})}});break;case 3:TweenLite.to(this,.5,{delay:.3,userBatX:30,userBatY:-60,ease:"Back.easeOut",onComplete:function(){t.movePlayerBat(0)}}),TweenLite.to(this,.5,{delay:.8,enemyBatX:30,ease:"Back.easeOut",onComplete:function(){}})}},t.prototype.switchBut=function(e,t,a,s,i){void 0===s&&(s=null),void 0===i&&(i=null);for(var r=null,o=0;o<this.aButs.length;o++)this.aButs[o].id==e&&(this.aButs[o].id=t,this.aButs[o].idOver=a,r=this.aButs[o],s&&(this.aButs[o].aPos=s),i&&(this.aButs[o].align=i));return r},t.prototype.removeBut=function(e){for(var t=0;t<this.aButs.length;t++)this.aButs[t].id==e&&(this.aButs.splice(t,1),t-=1)},t.prototype.render=function(t){var a=this;switch(void 0===t&&(t=!0),t||this.addButs(),gameState){case"splash":break;case"network":ctx.fillStyle="rgba(0, 0, 0, 0.5)",ctx.fillRect(0,0,canvas.width,canvas.height);var s=0,i="#000000",r="#FFFFFF";1==this.linkTextId&&(addText(0,50,canvas.width-200,"center",canvas.width/2,canvas.height/2-30,"waiting","#FFFFFF"),addText(1,50,canvas.width-200,"center",canvas.width/2,canvas.height/2+20,"join","#FFFF00"),Math.sin(this.incY)>0&&(s=1),r="#000000",i="#FFFFFF");var o=getSpriteData(assetLib.getData("uiElements"),"shareHeader"+s);ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width/2-o.bWidth/2,canvas.height/2-250,o.bWidth,o.bHeight);var n=netLib.shareURL;""==n&&(n=assetLib.textData.langText.creating[curLang]);var l=Math.min(getDirectWidth(1,40,n),canvas.width-200)+40;if(ctx.fillStyle=r,ctx.fillRect(canvas.width/2-l/2,canvas.height/2+70-12,l,60),ctx.strokeStyle=i,ctx.lineWidth=2,ctx.strokeRect(canvas.width/2-l/2,canvas.height/2+70-12,l,60),addDirectText(1,40,canvas.width-200,"center",canvas.width/2,canvas.height/2+100,n,i),0==this.linkTextId)addText(0,50,canvas.width-200,"center",canvas.width/2,canvas.height/2+40,"invite","#FFFFFF"),this.shareButOn&&addText(0,26,140,"center",canvas.width/2,canvas.height/2+320+this.butsY,"copyLink","#FFFFFF");else if(1==this.linkTextId){addText(0,50,canvas.width-200,"left",canvas.width/2-100,canvas.height/2+250,"linkSuccess","#00F981");var o=getSpriteData(assetLib.getData("uiElements"),"shareTick");ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width/2-100-60,canvas.height/2+250-40,o.bWidth,o.bHeight)}else 2==this.linkTextId&&addText(0,50,canvas.width-200,"center",canvas.width/2,canvas.height/2+70,"linkError","#FF5501");break;case"credits":ctx.fillStyle="rgba(0, 0, 0, 0.5)",ctx.fillRect(0,0,canvas.width,canvas.height),addText(0,75,canvas.width-350,"center",canvas.width/2,80+this.butsY,"settings","#FFFFFF"),addText(0,23,canvas.width-100,"center",canvas.width/2,canvas.height-170+this.butsY,"createdBy","#ffffff");var m=assetLib.getData("info");ctx.drawImage(m.img,0,0,m.img.width,m.img.height,canvas.width/2-m.img.width/2,canvas.height-120-m.img.height/2+this.butsY,m.img.width,m.img.height),addText(0,23,canvas.width-110,"right",canvas.width-95,canvas.height-15+this.butsY,"reset","#ffffff");var h=.3*canvas.height;addText(0,50,canvas.width-100,"center",canvas.width/2,h+this.butsY,"careerSetting0","#FFFFFF"),addDirectText(0,50,canvas.width-100,"center",.5*canvas.width,h+this.butsY+81,this.twoDigit(saveDataHandler.getCareerGames()),"#FFFC01"),addText(0,50,canvas.width-100,"center",canvas.width/2,h+this.butsY+170,"careerSetting1","#FFFFFF"),addDirectText(0,50,canvas.width-100,"center",.5*canvas.width,h+this.butsY+81+170,this.twoDigit(saveDataHandler.getCareerSets()),"#FFFC01"),addDirectText(0,23,canvas.width/2,"center",canvas.width/2,canvas.height-15+this.butsY,"v2.0.1","#ffffff");break;case"resetConfirm":ctx.fillStyle="rgba(0, 0, 0, 0.65)",ctx.fillRect(0,0,canvas.width,canvas.height),addText(0,60,canvas.width-100,"center",canvas.width/2,canvas.height/2-100+this.butsY,"resetConfirm0","#FFFFFF"),addText(0,40,canvas.width-100,"center",canvas.width/2,canvas.height/2-40+this.butsY,"resetConfirm1","#FCEA02");break;case"game":if(gameplayState>=3){var s=0;0==gameVariation?3==gameplayState||4==gameplayState?s=0:(5==gameplayState||6==gameplayState)&&(s=1):(1==gameVariation||2==gameVariation||3==gameVariation||4==gameVariation)&&(s=2);var d=assetLib.getData("fadeBg"+s);ctx.save(),ctx.globalAlpha=1-this.levelCompleteInc,ctx.translate(canvas.width/2,canvas.height/2),canvas.width>canvas.height?ctx.scale(canvas.width/canvas.height,1):ctx.scale(1,canvas.height/canvas.width),ctx.scale(1.62,1.62),ctx.rotate(.05*this.incY),ctx.drawImage(d.img,0,0,d.img.width,d.img.height,-d.img.width/2,-d.img.height/2,d.img.width,d.img.height),ctx.restore()}if(3==gameplayState||4==gameplayState){var u,c,g,p,$,v,h=Math.max(onScreenY-200,60)+120,I=this.twoDigit(curLevel+1);addDirectText(0,75,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+3+5*Math.sin(this.incY),getText("level",0)+" "+I+" "+getText("complete",0),"#2E24B4"),addDirectText(0,75,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+5*Math.sin(this.incY),getText("level",0)+" "+I+" "+getText("complete",0),"#FFFFFF");for(var b=0;b<5;b++){c=curLevel%levelsPerWorld>=b&&b==levelsPerWorld-1?curLevel%levelsPerWorld==b&&Math.sin(this.incY)>0?3:2:b==levelsPerWorld-1?2:curLevel%levelsPerWorld>=b?curLevel%levelsPerWorld==b&&Math.sin(this.incY)>0?0:1:0;var o=getSpriteData(assetLib.getData("uiElements"),"progressCup"+c),_=canvas.width/2+110*b-(levelsPerWorld/2-.5)*110;if(ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,_-o.bWidth/2,h+120-o.bHeight+200*this.levelCompleteInc,o.bWidth,o.bHeight),b<levelsPerWorld-1){var o=getSpriteData(assetLib.getData("uiElements"),"progressLine0");ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,_-o.bWidth/2+55,h+120-o.bHeight-20+200*this.levelCompleteInc,o.bWidth,o.bHeight)}I=this.twoDigit(Math.floor(curLevel/levelsPerWorld)*levelsPerWorld+1+b),addDirectText(0,40,110,"center",_,h+160+200*this.levelCompleteInc,I,"#FFFFFF")}(curLevel+1)%levelsPerWorld==0?(g=this.twoDigit(aPointScores[1]),p=aPointScores[1]):(g=this.twoDigit(aPointScores[0]),p=aPointScores[0]),rewardGemTotal=2*p,addDirectText(0,150,canvas.width/2,"left",canvas.width/2-10,h+260+200*this.levelCompleteInc+45,g,"#FFFFFF");var o=getSpriteData(assetLib.getData("uiElements"),"bigGem");if(ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width/2-85-o.bWidth/2*(1+.05*Math.sin(this.incY)),h-o.bHeight/2*(1-.05*Math.sin(this.incY))+250+200*this.levelCompleteInc,o.bWidth*(1+.05*Math.sin(this.incY)),o.bHeight*(1-.05*Math.sin(this.incY))),this.winGemCount-=35*delta,this.winGemCount<this.winGemTarg&&this.winGemCount>0){this.winGemTarg-=1;var B={x:canvas.width/2-85,y:h+250+200*this.levelCompleteInc,inc:1};this.aWinGems.push(B),$=.5*this.winGemCount,v=125+200*Math.random(),TweenLite.to(B,.25,{x:B.x+v*Math.cos($),y:B.y+v*Math.sin($),ease:"Quad.easeOut",onCompleteParams:[B],onComplete:function(e){D=a.twoDigit(gems),TweenLite.to(e,.5,{x:canvas.width-getDirectWidth(0,75,D)-95+27,y:canvas.height-80+25,inc:0,ease:"Quad.easeIn",onComplete:function(){gems++,playSound("gem"+Math.floor(5*Math.random()),.3)}})}})}for(var b=0;b<this.aWinGems.length;b++)if(this.aWinGems[b].inc>0){var o=getSpriteData(assetLib.getData("uiElements"),"bigGem");u=.5+.5*this.aWinGems[b].inc,ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,this.aWinGems[b].x-o.bWidth/2,this.aWinGems[b].y-o.bHeight/2,o.bWidth*u,o.bHeight*u)}else{for(var f=360*Math.random()*radian,w=0;w<5;w++){var S=new e.Particle(this.aWinGems[b].x,this.aWinGems[b].y,1*Math.random()+1,300,f+72*w*radian,20,1,50);aEffects.push(S)}this.aWinGems.splice(b,1),b-=1,this.aWinGems.length<=0&&initLevelCompleteButs()}if(Math.random()>.5){var S=new e.Particle(canvas.width/2,h+250+200*this.levelCompleteInc,1*Math.random()+1,300,360*Math.random()*radian,20,1,200);aEffects.push(S)}4==gameplayState&&(this.incY,anyWorldBatsLeft()&&(curLevel+1)%levelsPerWorld==0?Math.sin(this.incY)>0&&addText(0,50,canvas.width-100,"center",canvas.width/2,.7*canvas.height+200+this.butsY,"batUnlocked","#FFFFFF"):(Math.sin(this.incY)>0&&addText(0,50,canvas.width-100,"center",canvas.width/2,.7*canvas.height+200+this.butsY,"nextLevel","#FFFFFF"),addText(0,26,140,"center",canvas.width-90,canvas.height-210+90+this.butsY,"batCollectionBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-390+90+this.butsY,"challengeBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-210+90+this.butsY,"careerBut","#FFFFFF"),addDirectText(0,26,140,"center",90,canvas.height-210+90+this.butsY+23,"rank "+this.twoDigit(saveDataHandler.getRank()),"#FFFC01"),addText(0,26,140,"center",90,canvas.height-570+90+this.butsY,"bugGameBut","#FFFFFF"),addText(0,26,140,"center",canvas.width-90,canvas.height-390+90+this.butsY,"pvpBut","#FFFFFF")))}else if(5==gameplayState||6==gameplayState){var h=Math.max(onScreenY-200,60)+120,y=Math.floor((curLevel+1)/levelsPerWorld),I=this.twoDigit(y);addDirectText(0,75,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+3+5*Math.sin(this.incY),getText("world",0)+" "+I+" "+getText("complete",0),"#0BFF3C"),addDirectText(0,75,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+5*Math.sin(this.incY),getText("world",0)+" "+I+" "+getText("complete",0),"#FFFFFF");var u=Math.min((canvas.height-500)/400,1);if(this.renderBat(batUnlockedId,canvas.width/2,h+270*u,u*this.batScale),Math.random()>.5){var S=new e.Particle(canvas.width/2,h+270*u,1*Math.random()+1,300,360*Math.random()*radian,20,1,100);aEffects.push(S)}6==gameplayState&&(addText(0,26,140,"center",canvas.width-90,canvas.height-210+90+this.butsY,"batCollectionBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-390+90+this.butsY,"challengeBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-210+90+this.butsY,"careerBut","#FFFFFF"),addDirectText(0,26,140,"center",90,canvas.height-210+90+this.butsY+23,"rank "+this.twoDigit(saveDataHandler.getRank()),"#FFFC01"),addText(0,26,140,"center",90,canvas.height-570+90+this.butsY,"bugGameBut","#FFFFFF"),addText(0,26,140,"center",canvas.width-90,canvas.height-390+90+this.butsY,"pvpBut","#FFFFFF"),addText(0,40,canvas.width,"center",canvas.width/2,h+60+200*this.levelCompleteInc,"batUnlocked","#FFFFFF"),Math.sin(this.incY)>0&&addText(0,50,canvas.width-100,"center",canvas.width/2,.7*canvas.height+200+this.butsY,"nextLevel","#FFFFFF"),Math.sin(this.incY)>0&&addText(0,40,100,"center",canvas.width-90,canvas.height-290,"new","#FFFFFF"))}else if(gameplayState>=7&&gameplayState<9){var h=Math.max(onScreenY-200,60)+30;if(Math.random()>.5){var S=new e.Particle(canvas.width/2,h+100,1*Math.random()+1,300,360*Math.random()*radian,20,1,125);aEffects.push(S)}if(addText(0,75,canvas.width-350,"center",canvas.width/2,h+200*this.levelCompleteInc,"targetsHit","#FFFFFF"),addDirectText(0,200,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+3+5*Math.sin(this.incY)+175,this.twoDigit(curTargetScore),"#F658FF"),addDirectText(0,200,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+5*Math.sin(this.incY)+175,this.twoDigit(curTargetScore),"#FFFFFF"),curTargetScore>localTargetHighscore?addText(0,50,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+340,"newBest","#FFFC01"):(addText(0,30,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+340-25,"best","#FFFC01"),addDirectText(0,75,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+340+38,this.twoDigit(saveDataHandler.getBestTargetScore()),"#FFFC01")),Math.round(curTargetScore/2)>0){addDirectText(0,75,canvas.width/2,"left",canvas.width/2,h+200*this.levelCompleteInc+200+50+5*Math.sin(this.incY),this.twoDigit(Math.round(curTargetScore/2)),"#FFFFFF");var $,v,o=getSpriteData(assetLib.getData("uiElements"),"smallGem");if(ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width/2-o.bWidth,h+200*this.levelCompleteInc+190+5*Math.sin(this.incY),o.bWidth,o.bHeight),this.winGemCount-=35*delta,this.winGemCount<this.winGemTarg&&this.winGemCount>0){this.winGemTarg-=1;var B={x:canvas.width/2-25,y:h+200*this.levelCompleteInc+190+25,inc:1};this.aWinGems.push(B),$=.5*this.winGemCount,v=125+200*Math.random(),TweenLite.to(B,.25,{x:B.x+v*Math.cos($),y:B.y+v*Math.sin($),ease:"Quad.easeOut",onCompleteParams:[B],onComplete:function(e){D=a.twoDigit(gems),TweenLite.to(e,.5,{x:canvas.width-getDirectWidth(0,75,D)-95+27,y:canvas.height-80+25,inc:0,ease:"Quad.easeIn",onComplete:function(){gems++,playSound("gem"+Math.floor(5*Math.random()),.3)}})}})}for(var b=0;b<this.aWinGems.length;b++)if(this.aWinGems[b].inc>0){var o=getSpriteData(assetLib.getData("uiElements"),"bigGem");u=.5+.5*this.aWinGems[b].inc,ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,this.aWinGems[b].x-o.bWidth/2,this.aWinGems[b].y-o.bHeight/2,o.bWidth*u,o.bHeight*u)}else{for(var f=360*Math.random()*radian,w=0;w<5;w++){var S=new e.Particle(this.aWinGems[b].x,this.aWinGems[b].y,1*Math.random()+1,300,f+72*w*radian,20,1,50);aEffects.push(S)}this.aWinGems.splice(b,1),b-=1,this.aWinGems.length<=0&&initTargetGameEndButs()}}8==gameplayState&&(Math.round(curTargetScore/2)>0?(rewardGemTotal=2*Math.round(curTargetScore/2),Math.sin(this.incY)>0&&rewardButHit):addText(0,26,140,"center",canvas.width-90,canvas.height-390+90+this.butsY,"awardsBut","#FFFFFF"),addText(0,26,140,"center",canvas.width-90,canvas.height-210+90+this.butsY,"batCollectionBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-390+90+this.butsY,"arcadeBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-210+90+this.butsY,"careerBut","#FFFFFF"),addDirectText(0,26,140,"center",90,canvas.height-210+90+this.butsY+23,"rank "+this.twoDigit(saveDataHandler.getRank()),"#FFFC01"),addText(0,26,140,"center",90,canvas.height-570+90+this.butsY,"bugGameBut","#FFFFFF"),addText(0,26,140,"center",canvas.width-90,canvas.height-390+90+this.butsY,"pvpBut","#FFFFFF"),Math.sin(this.incY)>0&&addText(0,50,canvas.width-100,"center",canvas.width/2,.7*canvas.height+200+this.butsY,"tryAgain","#FFFFFF"))}else if(gameplayState>=9&&gameplayState<11){var F,$,v,h=Math.max(onScreenY-200,60)+120;if(Math.random()>.5){var S=new e.Particle(canvas.width/2,h+100,1*Math.random()+1,300,360*Math.random()*radian,20,1,125);aEffects.push(S)}userSets>enemySets?addText(0,75,canvas.width-350,"center",canvas.width/2,h+200*this.levelCompleteInc-30,"youWon","#FFFFFF"):addText(0,75,canvas.width-350,"center",canvas.width/2,h+200*this.levelCompleteInc-30,"youLost","#FFFFFF"),addDirectText(0,200,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+3+5*Math.sin(this.incY)+175-30,userSets+"-"+enemySets,"#F658FF"),addDirectText(0,200,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+5*Math.sin(this.incY)+175-30,userSets+"-"+enemySets,"#FFFFFF"),rankChange>0?addDirectText(0,75,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+300,getText("rank",0)+" +"+rankChange,"#FFFC01"):rankChange<0&&addDirectText(0,75,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+300,getText("rank",0)+" "+rankChange,"#A34522"),F=userSets>enemySets?50+10*saveDataHandler.getSeason()+saveDataHandler.getRound():25,addDirectText(0,75,canvas.width/2,"left",canvas.width/2,h+200*this.levelCompleteInc+200+50+5*Math.sin(this.incY)-30,this.twoDigit(F),"#FFFFFF");var o=getSpriteData(assetLib.getData("uiElements"),"smallGem");if(ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width/2-o.bWidth,h+200*this.levelCompleteInc+190+5*Math.sin(this.incY)-30,o.bWidth,o.bHeight),this.winGemCount-=35*delta,this.winGemCount<this.winGemTarg&&this.winGemCount>0){this.winGemTarg-=1;var B={x:canvas.width/2-25,y:h+200*this.levelCompleteInc+190+25,inc:1};this.aWinGems.push(B),$=.5*this.winGemCount,v=125+200*Math.random(),TweenLite.to(B,.25,{x:B.x+v*Math.cos($),y:B.y+v*Math.sin($),ease:"Quad.easeOut",onCompleteParams:[B],onComplete:function(e){D=a.twoDigit(gems),TweenLite.to(e,.5,{x:canvas.width-getDirectWidth(0,75,D)-95+27,y:canvas.height-80+25,inc:0,ease:"Quad.easeIn",onComplete:function(){gems++,playSound("gem"+Math.floor(5*Math.random()),.3)}})}})}for(var b=0;b<this.aWinGems.length;b++)if(this.aWinGems[b].inc>0){var o=getSpriteData(assetLib.getData("uiElements"),"bigGem");u=.5+.5*this.aWinGems[b].inc,ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,this.aWinGems[b].x-o.bWidth/2,this.aWinGems[b].y-o.bHeight/2,o.bWidth*u,o.bHeight*u)}else{for(var f=360*Math.random()*radian,w=0;w<5;w++){var S=new e.Particle(this.aWinGems[b].x,this.aWinGems[b].y,1*Math.random()+1,300,f+72*w*radian,20,1,50);aEffects.push(S)}this.aWinGems.splice(b,1),b-=1,this.aWinGems.length<=0&&initCustomGameEndButs()}10==gameplayState&&(rewardGemTotal=userSets>enemySets?(50+10*saveDataHandler.getSeason()+saveDataHandler.getRound())*2:50,this.incY,addText(0,26,140,"center",canvas.width-90,canvas.height-210+90+this.butsY,"batCollectionBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-390+90+this.butsY,"challengeBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-210+90+this.butsY,"arcadeBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-570+90+this.butsY,"bugGameBut","#FFFFFF"),addText(0,26,140,"center",canvas.width-90,canvas.height-390+90+this.butsY,"pvpBut","#FFFFFF"),Math.sin(this.incY)>0&&addText(0,50,canvas.width-100,"center",canvas.width/2,.7*canvas.height+200+this.butsY,"next","#FFFFFF"))}else if(gameplayState>=11&&gameplayState<13){var h=Math.max(onScreenY-200,60)+30;if(Math.random()>.5){var S=new e.Particle(canvas.width/2,h+100,1*Math.random()+1,300,360*Math.random()*radian,20,1,125);aEffects.push(S)}if(addText(0,75,canvas.width-350,"center",canvas.width/2,h+200*this.levelCompleteInc,"bugsHit","#FFFFFF"),addDirectText(0,200,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+3+5*Math.sin(this.incY)+175,this.twoDigit(bugScore),"#F658FF"),addDirectText(0,200,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+5*Math.sin(this.incY)+175,this.twoDigit(bugScore),"#FFFFFF"),bugScore>localTargetHighscore?addText(0,50,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+340,"newBest","#FFFC01"):(addText(0,30,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+340-25,"best","#FFFC01"),addDirectText(0,75,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+340+38,this.twoDigit(saveDataHandler.getBestBugScore()),"#FFFC01")),Math.ceil(bugScore/4)>0){addDirectText(0,75,canvas.width/2,"left",canvas.width/2,h+200*this.levelCompleteInc+200+50+5*Math.sin(this.incY),this.twoDigit(Math.ceil(bugScore/4)),"#FFFFFF");var $,v,o=getSpriteData(assetLib.getData("uiElements"),"smallGem");if(ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width/2-o.bWidth,h+200*this.levelCompleteInc+190+5*Math.sin(this.incY),o.bWidth,o.bHeight),this.winGemCount-=35*delta,this.winGemCount<this.winGemTarg&&this.winGemCount>0){this.winGemTarg-=1;var B={x:canvas.width/2-25,y:h+200*this.levelCompleteInc+190+25,inc:1};this.aWinGems.push(B),$=.5*this.winGemCount,v=125+200*Math.random(),TweenLite.to(B,.25,{x:B.x+v*Math.cos($),y:B.y+v*Math.sin($),ease:"Quad.easeOut",onCompleteParams:[B],onComplete:function(e){D=a.twoDigit(gems),TweenLite.to(e,.5,{x:canvas.width-getDirectWidth(0,75,D)-95+27,y:canvas.height-80+25,inc:0,ease:"Quad.easeIn",onComplete:function(){gems++,playSound("gem"+Math.floor(5*Math.random()),.3)}})}})}for(var b=0;b<this.aWinGems.length;b++)if(this.aWinGems[b].inc>0){var o=getSpriteData(assetLib.getData("uiElements"),"bigGem");u=.5+.5*this.aWinGems[b].inc,ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,this.aWinGems[b].x-o.bWidth/2,this.aWinGems[b].y-o.bHeight/2,o.bWidth*u,o.bHeight*u)}else{for(var f=360*Math.random()*radian,w=0;w<5;w++){var S=new e.Particle(this.aWinGems[b].x,this.aWinGems[b].y,1*Math.random()+1,300,f+72*w*radian,20,1,50);aEffects.push(S)}this.aWinGems.splice(b,1),b-=1,this.aWinGems.length<=0&&initBugGameEndButs()}}12==gameplayState&&(Math.ceil(bugScore/4)>0?(rewardGemTotal=2*Math.ceil(bugScore/4),Math.sin(this.incY)>0&&rewardButHit):addText(0,26,140,"center",canvas.width-90,canvas.height-390+90+this.butsY,"awardsBut","#FFFFFF"),addText(0,26,140,"center",canvas.width-90,canvas.height-210+90+this.butsY,"batCollectionBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-390+90+this.butsY,"arcadeBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-210+90+this.butsY,"careerBut","#FFFFFF"),addDirectText(0,26,140,"center",90,canvas.height-210+90+this.butsY+23,"rank "+this.twoDigit(saveDataHandler.getRank()),"#FFFC01"),addText(0,26,140,"center",90,canvas.height-570+90+this.butsY,"challengeBut","#FFFFFF"),addText(0,26,140,"center",canvas.width-90,canvas.height-390+90+this.butsY,"pvpBut","#FFFFFF"),Math.sin(this.incY)>0&&addText(0,50,canvas.width-100,"center",canvas.width/2,.7*canvas.height+200+this.butsY,"tryAgain","#FFFFFF"))}else if(gameplayState>=13&&gameplayState<15){var F,$,v,h=Math.max(onScreenY-200,60)+120;if(Math.random()>.5){var S=new e.Particle(canvas.width/2,h+100,1*Math.random()+1,300,360*Math.random()*radian,20,1,125);aEffects.push(S)}userScore>enemyScore?addText(0,75,canvas.width-350,"center",canvas.width/2,h+200*this.levelCompleteInc-30,"youWon","#FFFFFF"):addText(0,75,canvas.width-350,"center",canvas.width/2,h+200*this.levelCompleteInc-30,"youLost","#FFFFFF"),addDirectText(0,200,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+3+5*Math.sin(this.incY)+175-30,userScore+"-"+enemyScore,"#F658FF"),addDirectText(0,200,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+5*Math.sin(this.incY)+175-30,userScore+"-"+enemyScore,"#FFFFFF"),F=userScore>enemyScore?userScore+25:enemyScore,addDirectText(0,75,canvas.width/2,"left",canvas.width/2,h+200*this.levelCompleteInc+200+50+5*Math.sin(this.incY)-30,this.twoDigit(F),"#FFFFFF");var o=getSpriteData(assetLib.getData("uiElements"),"smallGem");if(ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width/2-o.bWidth,h+200*this.levelCompleteInc+190+5*Math.sin(this.incY)-30,o.bWidth,o.bHeight),this.winGemCount-=35*delta,this.winGemCount<this.winGemTarg&&this.winGemCount>0){this.winGemTarg-=1;var B={x:canvas.width/2-25,y:h+200*this.levelCompleteInc+190+25,inc:1};this.aWinGems.push(B),$=.5*this.winGemCount,v=125+200*Math.random(),TweenLite.to(B,.25,{x:B.x+v*Math.cos($),y:B.y+v*Math.sin($),ease:"Quad.easeOut",onCompleteParams:[B],onComplete:function(e){D=a.twoDigit(gems),TweenLite.to(e,.5,{x:canvas.width-getDirectWidth(0,75,D)-95+27,y:canvas.height-80+25,inc:0,ease:"Quad.easeIn",onComplete:function(){gems++,playSound("gem"+Math.floor(5*Math.random()),.3)}})}})}for(var b=0;b<this.aWinGems.length;b++)if(this.aWinGems[b].inc>0){var o=getSpriteData(assetLib.getData("uiElements"),"bigGem");u=.5+.5*this.aWinGems[b].inc,ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,this.aWinGems[b].x-o.bWidth/2,this.aWinGems[b].y-o.bHeight/2,o.bWidth*u,o.bHeight*u)}else{for(var f=360*Math.random()*radian,w=0;w<5;w++){var S=new e.Particle(this.aWinGems[b].x,this.aWinGems[b].y,1*Math.random()+1,300,f+72*w*radian,20,1,50);aEffects.push(S)}this.aWinGems.splice(b,1),b-=1,this.aWinGems.length<=0&&initPvpGameEndButs()}14==gameplayState&&Math.sin(this.incY)>0&&addText(0,50,canvas.width-100,"center",canvas.width/2,.7*canvas.height+200+this.butsY,"playAgain","#FFFFFF")}var D=this.twoDigit(gems);addDirectText(0,75,canvas.width/2,"right",canvas.width-25,canvas.height-20+this.butsY,D,"#FFFFFF");var o=getSpriteData(assetLib.getData("uiElements"),"smallGem");if(ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width-getDirectWidth(0,75,D)-95,canvas.height-80+this.butsY,o.bWidth,o.bHeight),0==gameplayState||0==gameVariation&&1==gameplayState){addDirectText(0,75,canvas.width/2,"left",90,canvas.height-20+this.butsY,this.twoDigit(curLevel+1),"#FFFFFF");var o=getSpriteData(assetLib.getData("uiElements"),"smallCup");ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,24,canvas.height-77+this.butsY,o.bWidth,o.bHeight)}if(0==gameplayState){saveDataHandler.getLevel()>0?canvas.width/canvas.height<.6?(addText(0,26,140,"center",canvas.width/2+160,canvas.height-250+90+this.butsY,"awardsBut","#FFFFFF"),addText(0,26,140,"center",canvas.width/2+320,canvas.height-250+90+this.butsY,"batCollectionBut","#FFFFFF"),addText(0,26,140,"center",canvas.width/2-160,canvas.height-250+90+this.butsY,"challengeBut","#FFFFFF"),addText(0,26,140,"center",canvas.width/2,canvas.height-250+90+this.butsY,"careerBut","#FFFFFF"),addDirectText(0,26,140,"center",canvas.width/2,canvas.height-250+90+this.butsY+23,"rank "+this.twoDigit(saveDataHandler.getRank()),"#FFFC01"),addText(0,26,140,"center",canvas.width/2-320,canvas.height-250+90+this.butsY,"bugGameBut","#FFFFFF"),addText(0,26,140,"center",canvas.width/2+320,canvas.height-250-90+this.butsY,"pvpBut","#FFFFFF")):(addText(0,26,140,"center",canvas.width-90,canvas.height-390+90+this.butsY,"awardsBut","#FFFFFF"),addText(0,26,140,"center",canvas.width-90,canvas.height-210+90+this.butsY,"batCollectionBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-390+90+this.butsY,"challengeBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-210+90+this.butsY,"careerBut","#FFFFFF"),addDirectText(0,26,140,"center",90,canvas.height-210+90+this.butsY+23,"rank "+this.twoDigit(saveDataHandler.getRank()),"#FFFC01"),addText(0,26,140,"center",90,canvas.height-570+90+this.butsY,"bugGameBut","#FFFFFF"),addText(0,26,140,"center",canvas.width-90,canvas.height-570+90+this.butsY,"pvpBut","#FFFFFF")):canvas.width/canvas.height<.6?addText(0,26,140,"center",canvas.width/2+320,canvas.height-250+90+this.butsY,"pvpBut","#FFFFFF"):addText(0,26,140,"center",canvas.width-90,canvas.height-210+90+this.butsY,"pvpBut","#FFFFFF"),ctx.beginPath(),ctx.arc(canvas.width/2,onScreenY+340,12*this.incY%75.7+25,0,2*Math.PI,!1),ctx.lineWidth=Math.max((75.7-12*this.incY%75.7)*.2,1),ctx.strokeStyle="#FFFFFF",ctx.stroke();var o=getSpriteData(assetLib.getData("uiElements"),"startFinger");ctx.save(),ctx.translate(canvas.width/2+180,onScreenY+320),ctx.rotate(.5*Math.abs(Math.sin(.5*this.incY))-100*radian),ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,-o.bWidth/2,-(.75*o.bHeight),o.bWidth,o.bHeight),ctx.restore(),this.disconnectInc>0&&(addText(0,75,canvas.width-350,"center",canvas.width/2,canvas.height*(.2*this.disconnectInc)+3,this.errorText,"#000000"),Math.sin(this.incY)>0?addText(0,75,canvas.width-350,"center",canvas.width/2,canvas.height*(.2*this.disconnectInc),this.errorText,"#FFFFFF"):addText(0,75,canvas.width-350,"center",canvas.width/2,canvas.height*(.2*this.disconnectInc),this.errorText,"#FFFF00"))}else if(gameplayState<5&&0==gameVariation)for(var b=0;b<levelStarTarg;b++){var s=0;curLevelStars>b&&(s=1);var o=getSpriteData(assetLib.getData("uiElements"),"star"+s);ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width/2-o.bWidth/2+70*b-70*(levelStarTarg/2-.5)-100*this.starsX,Math.max(onScreenY-200,60)-o.bWidth/2-100*this.starsY,o.bWidth,o.bHeight)}if(1==gameVariation&&1==gameplayState){addText(0,30,canvas.width/2,"left",24,canvas.height-85+this.butsY,"best","#FFFFFF"),addDirectText(0,75,canvas.width/2,"left",90,canvas.height-20+this.butsY,this.twoDigit(localTargetHighscore),"#FFFFFF");var o=getSpriteData(assetLib.getData("uiElements"),"targetIcon");ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,24,canvas.height-77+this.butsY,o.bWidth,o.bHeight),addDirectText(0,120,canvas.width/2,"center",canvas.width/2,Math.max(onScreenY-170,100)-10*this.starsY,this.twoDigit(curTargetScore),"#FFFFFF")}else if(2==gameVariation&&1==gameplayState){var o=getSpriteData(assetLib.getData("uiElements"),"setsBg");ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width/2-o.bWidth/2,Math.max(onScreenY-170,100)-10*this.starsY-83,o.bWidth,o.bHeight),addDirectText(0,120,canvas.width/2,"right",canvas.width/2-50,Math.max(onScreenY-170,100)-10*this.scoreSideY0,userScore.toString(),"#FFFFFF"),addDirectText(0,50,canvas.width/2,"center",canvas.width/2-21,Math.max(onScreenY-170,100)-10*this.starsY-41,userSets.toString(),"#FFFC01"),addDirectText(0,120,canvas.width/2,"left",canvas.width/2+50,Math.max(onScreenY-170,100)-10*this.scoreSideY1,enemyScore.toString(),"#FFFFFF"),addDirectText(0,50,canvas.width/2,"center",canvas.width/2+21,Math.max(onScreenY-170,100)-10*this.starsY-41,enemySets.toString(),"#FFFC01");var o=getSpriteData(assetLib.getData("flags"),"flag"+aSeasonFlags[saveDataHandler.getRound()].id),u=1;ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,65-o.bWidth/2*u,canvas.height-65-o.bHeight/2*u,o.bWidth*u,o.bHeight*u)}else if(4==gameVariation&&1==gameplayState){ctx.save(),ctx.translate(canvas.width/2+20,Math.max(onScreenY-170,100)-83+45-10*this.scoreSideY0),ctx.scale(.31,.31),ctx.rotate(45*radian);var x,H=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+opBat]].x,A=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+opBat]].y,T=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+opBat]].width,G=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+opBat]].height;ctx.drawImage(this.oGameElementsImgData.img,H,A,T,G,-T/2,-G/2,T,G),ctx.restore(),ctx.save(),ctx.translate(canvas.width/2-20,Math.max(onScreenY-170,100)-83+45-10*this.scoreSideY0),ctx.scale(.31,.31),ctx.rotate(-45*radian);var H=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+curBat]].x,A=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+curBat]].y,T=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+curBat]].width,G=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+curBat]].height;if(ctx.drawImage(this.oGameElementsImgData.img,H,A,T,G,-T/2,-G/2,T,G),ctx.restore(),addDirectText(0,120,canvas.width/2,"right",canvas.width/2-65,Math.max(onScreenY-170,100)-10*this.scoreSideY0,userScore.toString(),"#FFFFFF"),addDirectText(0,120,canvas.width/2,"left",canvas.width/2+65,Math.max(onScreenY-170,100)-10*this.scoreSideY1,enemyScore.toString(),"#FFFFFF"),saveDataHandler.getPvpWins()>0){x=getDirectWidth(0,120,userScore.toString());var o=getSpriteData(assetLib.getData("uiElements"),"crown");ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width/2-75-x-+getDirectWidth(0,55,saveDataHandler.getPvpWins().toString())/2-o.bWidth/2,Math.max(onScreenY-170,100)-83-10*this.scoreSideY0,o.bWidth,o.bHeight),addDirectText(0,55,canvas.width/2,"right",canvas.width/2-75-x,Math.max(onScreenY-170,100)-10-10*this.scoreSideY0,saveDataHandler.getPvpWins().toString(),"#FFFF00")}if(opPvpWins>0){x=getDirectWidth(0,120,enemyScore.toString());var o=getSpriteData(assetLib.getData("uiElements"),"crown");ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width/2+75+x+getDirectWidth(0,55,opPvpWins.toString())/2-o.bWidth/2,Math.max(onScreenY-170,100)-83-10*this.scoreSideY0,o.bWidth,o.bHeight),addDirectText(0,55,canvas.width/2,"left",canvas.width/2+75+x,Math.max(onScreenY-170,100)-10-10*this.scoreSideY0,opPvpWins.toString(),"#FFFF00")}this.pvpStartInc<1&&(addText(0,100,canvas.width-200,"center",canvas.width/2,tableTop.netY+75-500*this.pvpStartInc+3,"gameOn","#000000"),Math.sin(2*this.incY)>0?addText(0,100,canvas.width-200,"center",canvas.width/2,tableTop.netY+75-500*this.pvpStartInc,"gameOn","#FFFF00"):addText(0,100,canvas.width-200,"center",canvas.width/2,tableTop.netY+75-500*this.pvpStartInc,"gameOn","#FFFFFF")),addDirectText(1,30,canvas.width/2,"left",10,canvas.height-20,"Ping: "+getText("latency"+this.getLatencyStatus(netLib.peer.latency.average),1)+" ("+Math.round(netLib.peer.latency.average)+"ms)","#FFFFFF")}else if(3==gameVariation&&1==gameplayState){if(addText(0,30,canvas.width/2,"left",24,canvas.height-85+this.butsY,"best","#FFFFFF"),addDirectText(0,120,canvas.width/2,"right",canvas.width/2+30,Math.max(onScreenY-170,100)-10*this.starsY,this.twoDigit(bugScore),"#FFFFFF"),bugTime<bugTimeTarg&&(bugTime+=delta)>=bugTimeTarg&&initBugGameEnd(),bugTime<bugTimeTarg-5||Math.sin(this.incY)>0){var o=getSpriteData(assetLib.getData("uiElements"),"stopWatch");ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width/2+45,Math.max(onScreenY-170,100)-83,o.bWidth,o.bHeight);var x=canvas.width/2+45+35.5,k=Math.max(onScreenY-170,100)-83+46.5;ctx.fillStyle="#FFFFFF",ctx.beginPath(),ctx.moveTo(x,k),ctx.arc(x,k,25,-.5*Math.PI,2*Math.PI/bugTimeTarg*bugTime-.5*Math.PI),ctx.lineTo(x,k),ctx.fill()}addDirectText(0,75,canvas.width/2,"left",90,canvas.height-20+this.butsY,this.twoDigit(localTargetHighscore),"#FFFFFF");var o=getSpriteData(assetLib.getData("uiElements"),"bugIcon");ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,24,canvas.height-77+this.butsY,o.bWidth,o.bHeight),this.bugTimeY<1&&addDirectText(0,50,canvas.width/2,"left",canvas.width/2+125,Math.max(onScreenY-170,100)-23+100*this.bugTimeY,"+"+bugBonusTime+" SECS","#FFFFFF")}1==netLib.connectState&&(ctx.fillStyle="rgba(0, 0, 0, 0.75)",ctx.fillRect(0,0,canvas.width,canvas.height),addText(0,75,canvas.width-350,"center",canvas.width/2,.5*canvas.height+3,"connecting","#000000"),Math.sin(this.incY)>0?addText(0,75,canvas.width-350,"center",canvas.width/2,.5*canvas.height,"connecting","#FFFFFF"):addText(0,75,canvas.width-350,"center",canvas.width/2,.5*canvas.height,"connecting","#FFFF00"));break;case"batShop":ctx.fillStyle="rgba(0, 0, 0, 0.5)",ctx.fillRect(0,0,canvas.width,canvas.height),addText(0,75,canvas.width-350,"center",canvas.width/2,75,"batCollection","#FFFFFF");var D=this.twoDigit(gems);addDirectText(0,75,canvas.width/2,"right",canvas.width-25,canvas.height-20,D,"#FFFFFF");var o=getSpriteData(assetLib.getData("uiElements"),"smallGem");ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width-getDirectWidth(0,75,D)-95,canvas.height-80,o.bWidth,o.bHeight);break;case"awards":ctx.fillStyle="rgba(0, 0, 0, 0.5)",ctx.fillRect(0,0,canvas.width,canvas.height);for(var b=0;b<16;b++){var s=16;1==saveDataHandler.getAwardState(b)&&(s=b);var o=getSpriteData(assetLib.getData("awards"),"award"+s),_=canvas.width/2-285+b%4*190,h=canvas.height/2+70-400+199*Math.floor(b/4)+this.posY,u=.9;ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,_-o.bWidth/2*u,h-o.bHeight/2*u,o.bWidth*u,o.bHeight*u);for(var C=getMultiLineTextByChars("awardInfo"+b,16,1),w=0;w<C.length;w++)addDirectText(1,25,200,"center",_,h+93+25*w,C[w],"#FFFFFF")}break;case"mapScreen":ctx.fillStyle="rgba(0, 0, 0, 0.5)",ctx.fillRect(0,0,canvas.width,canvas.height);var o=getSpriteData(assetLib.getData("uiElements"),"map"),E=o.bWidth/2,Y=aFlags[aSeasonFlags[saveDataHandler.getRound()].id].x,L=aFlags[aSeasonFlags[saveDataHandler.getRound()].id].y,u=Math.min(1,canvas.width/o.bWidth)*this.mapScale,_=canvas.width/2-Y*u*this.mapPos*E,h=.5*canvas.height-L*u*this.mapPos*E+800/canvas.height*70*this.mapPos;ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,_-o.bWidth/2*u,h-o.bHeight/2*u,o.bWidth*u,o.bHeight*u),ctx.strokeStyle="#FFFFFF",ctx.lineWidth=5*u,ctx.setLineDash([10*u,5*u]),ctx.lineCap="butt";for(var b=1;b<aSeasonFlags.length;b++){var P=_+aFlags[aSeasonFlags[b-1].id].x*E*u,W=h+aFlags[aSeasonFlags[b-1].id].y*E*u,O=_+aFlags[aSeasonFlags[b].id].x*E*u,X=h+aFlags[aSeasonFlags[b].id].y*E*u;b<=saveDataHandler.getRound()&&(ctx.beginPath(),ctx.moveTo(P,W),ctx.quadraticCurveTo(P+(O-P)/2,W+(X-W)/2-100*u,O,X),ctx.stroke())}ctx.setLineDash([]);for(var b=0;b<aSeasonFlagsRender.length;b++){var M,V=1,R=0;aSeasonFlagsRender[b].aSeasonFlagsIndex<saveDataHandler.getRound()?M=2:aSeasonFlagsRender[b].aSeasonFlagsIndex>saveDataHandler.getRound()?M=1:0==this.mapState?M=1:this.mapState>0&&(M=0,V=this.mapPinScale,R=29);var o=getSpriteData(assetLib.getData("uiElements"),"pin"+M);if(ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,_+(aFlags[aSeasonFlags[aSeasonFlagsRender[b].aSeasonFlagsIndex].id].x*E-o.bWidth/2*V)*u,h+(aFlags[aSeasonFlags[aSeasonFlagsRender[b].aSeasonFlagsIndex].id].y*E-o.bHeight*V+R)*u,o.bWidth*u*V,o.bHeight*u*V),0==M){var o=getSpriteData(assetLib.getData("flags"),"flag"+aSeasonFlags[aSeasonFlagsRender[b].aSeasonFlagsIndex].id);ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,_+(aFlags[aSeasonFlags[aSeasonFlagsRender[b].aSeasonFlagsIndex].id].x*E-(o.bWidth/2+43)*V)*u,h+(aFlags[aSeasonFlags[aSeasonFlagsRender[b].aSeasonFlagsIndex].id].y*E-(o.bHeight/2+91)*V)*u,o.bWidth*u*V,o.bHeight*u*V),addText(0,28*u*V,canvas.width-350,"center",_+(aFlags[aSeasonFlags[aSeasonFlagsRender[b].aSeasonFlagsIndex].id].x*E+43*V)*u,h+(aFlags[aSeasonFlags[aSeasonFlagsRender[b].aSeasonFlagsIndex].id].y*E-95*V)*u,"rank","#333333"),addDirectText(0,37*u*V,canvas.width-350,"center",_+(aFlags[aSeasonFlags[aSeasonFlagsRender[b].aSeasonFlagsIndex].id].x*E+43*V)*u,h+(aFlags[aSeasonFlags[aSeasonFlagsRender[b].aSeasonFlagsIndex].id].y*E-65*V)*u,this.twoDigit(aSeasonFlags[aSeasonFlagsRender[b].aSeasonFlagsIndex].rank),"#333333")}}if(2==this.mapState&&(Math.sin(this.incY)>0&&(addDirectText(0,50,canvas.width-100,"center",canvas.width/2,.7*canvas.height+200+this.butsY+3,getText("playRound",0)+" "+(saveDataHandler.getRound()+1),"#333333"),addDirectText(0,50,canvas.width-100,"center",canvas.width/2,.7*canvas.height+200+this.butsY,getText("playRound",0)+" "+(saveDataHandler.getRound()+1),"#FFFFFF")),Math.random()>.5)){var S=new e.Particle(canvas.width/2,.45*canvas.height,1*Math.random()+1,300,360*Math.random()*radian,20,1,200);aEffects.push(S)}addDirectText(0,75,canvas.width-350,"center",canvas.width/2,78,getText("season",0)+" "+(saveDataHandler.getSeason()+1),"#333333"),addDirectText(0,75,canvas.width-350,"center",canvas.width/2,75,getText("season",0)+" "+(saveDataHandler.getSeason()+1),"#FFFFFF"),addText(0,35,canvas.width-350,"center",canvas.width/2,123,"rank","#333333"),addText(0,35,canvas.width-350,"center",canvas.width/2,120,"rank","#FFFC01"),addDirectText(0,50,canvas.width-350,"center",canvas.width/2,166,this.twoDigit(saveDataHandler.getRank()),"#333333"),addDirectText(0,50,canvas.width-350,"center",canvas.width/2,163,this.twoDigit(saveDataHandler.getRank()),"#FFFC01");var D=this.twoDigit(gems);addDirectText(0,75,canvas.width/2,"right",canvas.width-25,canvas.height-20+this.butsY,D,"#FFFFFF");var o=getSpriteData(assetLib.getData("uiElements"),"smallGem");ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width-getDirectWidth(0,75,D)-95,canvas.height-80+this.butsY,o.bWidth,o.bHeight);break;case"pause":ctx.fillStyle="rgba(0, 0, 0, 0.5)",ctx.fillRect(0,0,canvas.width,canvas.height),addText(0,40,canvas.width/2,"center",canvas.width/2,canvas.height/2-110+110+this.butsY,"continue","#FFFFFF"),addText(0,40,canvas.width/2,"center",canvas.width/2,canvas.height/2+110+110+this.butsY,"quit","#FFFFFF")}this.congratsUpdate(),t&&this.addButs()},t.prototype.getLatencyStatus=function(e){return e<=50?0:e<=100?1:e<=180?2:e<=230?3:4},t.prototype.renderPointer=function(){},t.prototype.renderBat=function(e,t,a,s){void 0===s&&(s=1),this.batRotation=5*Math.sin(.05*this.incY),this.batSpin=Math.sin(.5*this.incY),ctx.save(),ctx.translate(t,a),ctx.rotate(this.batRotation),ctx.scale(s*this.batSpin,s);var i=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+e]].x,r=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+e]].y,o=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+e]].width,n=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+e]].height;ctx.drawImage(this.oGameElementsImgData.img,i,r,o,n,-o/2,-n/2,o,n),ctx.restore()},t.prototype.twoDigit=function(e){var t=e.toString();return t.length<2&&(t="0"+t),t},t.prototype.flare=function(e,t,a,s,i){this.flareRot+=delta/2,ctx.save(),ctx.translate(e,t),ctx.scale(a,s),ctx.rotate(this.flareRot);var r=this.oUiElementsImgData.oData.oAtlasData[oImageIds["flare"+i]].x,o=this.oUiElementsImgData.oData.oAtlasData[oImageIds["flare"+i]].y,n=this.oUiElementsImgData.oData.oAtlasData[oImageIds["flare"+i]].width,l=this.oUiElementsImgData.oData.oAtlasData[oImageIds["flare"+i]].height;ctx.drawImage(this.oUiElementsImgData.img,r,o,n,l,-n/2,-l/2,n,l),ctx.rotate(-(2*this.flareRot)),ctx.drawImage(this.oUiElementsImgData.img,r,o,n,l,-n/2,-l/2,n,l),ctx.restore()},t.prototype.addButs=function(){for(var e=!1,t=0;t<this.aButs.length;t++)if(this.aButs[t].isOver){e=!0;break}for(var t=0;t<this.aButs.length;t++){var a,s,i,r,o=0,n=0;0!=this.incY&&this.aButs[t].flash&&(n=this.aButs[t].isOver?3*Math.sin((this.incY+2.5*t)*2):3*Math.sin(this.incY+2.5*t)),this.aButs[t].scale||(this.aButs[t].scale=1),a=this.aButs[t].oImgData.oData.oAtlasData[this.aButs[t].id].x,s=this.aButs[t].oImgData.oData.oAtlasData[this.aButs[t].id].y,i=this.aButs[t].oImgData.oData.oAtlasData[this.aButs[t].id].width,r=this.aButs[t].oImgData.oData.oAtlasData[this.aButs[t].id].height;var l=canvas.width*this.aButs[t].align[0],m=canvas.height*this.aButs[t].align[1];this.aButs[t].noTween||(o=m+this.aButs[t].aPos[1]>.1*canvas.height?this.butsY:-this.butsY),this.aButs[t].aOverData=[l+this.aButs[t].aPos[0]-i/2*this.aButs[t].scale-n/2,m+this.aButs[t].aPos[1]-r/2*this.aButs[t].scale+o+n/2,l+this.aButs[t].aPos[0]+i/2*this.aButs[t].scale-n/2,m+this.aButs[t].aPos[1]+r/2*this.aButs[t].scale+o+n/2],this.aButs[t].isOver&&this.aButs[t].flash&&(ctx.save(),ctx.translate(l+this.aButs[t].aPos[0],m+this.aButs[t].aPos[1]),ctx.scale(.65+n/50,.65+n/50),ctx.globalAlpha=1,ctx.rotate(this.incY/7),ctx.drawImage(this.oTopFlareImgData.img,-this.oTopFlareImgData.img.width/2,-this.oTopFlareImgData.img.height/2),ctx.restore()),ctx.drawImage(this.aButs[t].oImgData.img,a,s,i,r,this.aButs[t].aOverData[0],this.aButs[t].aOverData[1],i*this.aButs[t].scale+n,r*this.aButs[t].scale-n),(this.aButs[t].isOver||this.aButs[t].flash)&&(ctx.save(),this.aButs[t].isOver?ctx.globalAlpha=1:e?ctx.globalAlpha=Math.max(Math.sin(this.incY/2),0)/2:ctx.globalAlpha=Math.max(Math.sin(this.incY/2),0),a=this.aButs[t].oImgData.oData.oAtlasData[this.aButs[t].idOver].x,s=this.aButs[t].oImgData.oData.oAtlasData[this.aButs[t].idOver].y,i=this.aButs[t].oImgData.oData.oAtlasData[this.aButs[t].idOver].width,r=this.aButs[t].oImgData.oData.oAtlasData[this.aButs[t].idOver].height,ctx.drawImage(this.aButs[t].oImgData.img,a,s,i,r,this.aButs[t].aOverData[0],this.aButs[t].aOverData[1],i*this.aButs[t].scale+n,r*this.aButs[t].scale-n),ctx.restore()),this.aButs[t].id==oImageIds.rewardMultiplyBut&&addDirectText(0,50,125,"center",this.aButs[t].aOverData[0]+125,this.aButs[t].aOverData[1]+153,"+"+this.twoDigit(rewardGemTotal),"#FFFFFF")}},t}();e.Panel=t}(Elements||(Elements={})),function(e){var t=function(){function e(){this.x=0,this.y=0,this.rotation=0,this.scale=1,this.inc=0,this.startX=0,this.startY=0,this.startRotation=0,this.startInc=0,this.incY=0,this.celebrateY=0,this.flipInc=0,this.flipX=Math.PI,this.flipY=1,this.tutState=0,this.tutY=0,this.prevTutY=0,this.tutInc=0,this.oGameElementsImgData=assetLib.getData("gameElements"),this.targX=canvas.width/2,this.targY=canvas.height-150,this.batSpreadX=1,this.batSpreadY=1,this.batSpreadMultiplier=.03,this.reset()}return e.prototype.reset=function(){this.celebrateY=0,this.flipInc=0},e.prototype.levelComplete=function(){this.autotween&&this.autotween.kill(),this.startY=this.y,setTimeout(function(){initLevelComplete()},1e3),this.flip()},e.prototype.flip=function(){var e;this.incY=0,e=0==this.flipInc?720:this.flipInc%2==0?360:0,this.flipInc++,this.autotween=TweenLite.to(this,1,{incY:180*radian,rotation:e*radian,x:canvas.width/2,y:onScreenY+355,ease:"none",onComplete:function(){}})},e.prototype.startHit=function(){var e=this;this.x=this.prevX=this.startX=canvas.width/2,this.y=this.prevY=this.startY=onScreenY+355,this.rotation=this.startRotation=0,this.startInc=1,TweenLite.to(this,.1,{startY:onScreenY+200,ease:"Cubic.easeOut",onComplete:function(){e.y=e.prevY=e.startY,TweenLite.to(e,.5,{startInc:0,ease:"Cubic.easeInOut"})}})},e.prototype.successFlip=function(){var e=this;this.flipTween&&this.flipTween.kill(),this.flipX=Math.PI,this.flipTween=TweenLite.to(this,1,{flipX:4*Math.PI,ease:"Quad.easeOut",onComplete:function(){e.flipX=Math.PI}})},e.prototype.update=function(){0==gameplayState?(this.inc+=delta,this.x=canvas.width/2+30*Math.sin(3*this.inc),this.y=onScreenY+355+10*Math.sin(10*this.inc),this.rotation=.1*Math.sin(3*this.inc)):gameplayState>=2?(this.celebrateY=-300*Math.sin(this.incY),this.maxY=onScreenY+200/tableTop.segs*(.28*tableTop.segs)*(1+tableTop.offsetY/3)+50*tableTop.offsetY,this.scale=.44+(this.y-this.maxY)/550):1==gameplayState&&(this.maxY=onScreenY+200/tableTop.segs*(.28*tableTop.segs)*(1+tableTop.offsetY/3)+50*tableTop.offsetY,this.prevX=this.x,this.prevY=this.y,this.x=this.startX*this.startInc+this.targX*(1-this.startInc),this.y=this.startY*this.startInc+Math.max(this.targY,this.maxY)*(1-this.startInc),this.rotation=Math.max(Math.min((this.x-canvas.width/2)/200,90*radian),-90*radian),this.scale=.44+(this.y-this.maxY)/550,1==this.tutState&&(this.tutInc+=delta,this.tutInc>3&&(this.tutState=2,this.tutInc=0)))},e.prototype.getHitData=function(e,t){var a=Math.max(Math.min((this.prevY-this.y)/delta,4500)/4500,0);this.hitY=(1-a)*.4;var s=(this.x-this.prevX)/delta/2e3;return this.hitX=Math.max(Math.min(s+e,1-Math.min(.2*e,0)),-1-Math.max(.2*e,0)),{x:this.hitX,y:this.hitY,speed:(.3+.3/.4*(.4-this.hitY))*.9,spin:0}},e.prototype.render=function(){if(1==gameplayState&&2==this.tutState&&(this.tutInc+=delta,ctx.save(),this.prevTutY=this.tutY,this.tutY=Math.abs(Math.sin(5*this.tutInc)),this.prevTutY<this.tutY)){var e=Math.max(this.y-aBalls[curBallId].y+100,200);ctx.translate(this.x+(canvas.width/2-this.x)*this.tutY*.3,this.y-(20-this.celebrateY)*this.scale-this.tutY*e),ctx.scale(this.scale*(1-.3*this.tutY),this.scale*Math.min(1-(this.y-.5*canvas.height)/(.5*canvas.height)*.3,1)*(1-.3*this.tutY)),ctx.rotate(this.rotation),ctx.globalAlpha=1-this.tutY*this.tutY;var t=0,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds["batBehind"+t]].x,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds["batBehind"+t]].y,i=this.oGameElementsImgData.oData.oAtlasData[oImageIds["batBehind"+t]].width,r=this.oGameElementsImgData.oData.oAtlasData[oImageIds["batBehind"+t]].height;ctx.drawImage(this.oGameElementsImgData.img,a,s,i,r,-i/2*(1-Math.abs(Math.sin(this.flipX))),-r/3,i*(1-Math.abs(Math.sin(this.flipX))),r),ctx.restore()}ctx.save(),ctx.translate(this.x,this.y-(20-this.celebrateY)*this.scale),ctx.scale(this.scale,this.scale*Math.min(1-(this.y-.5*canvas.height)/(.5*canvas.height)*.3,1)),ctx.rotate(this.rotation);var o=curBat,t=0;o>=49&&(t=o);var a=this.oGameElementsImgData.oData.oAtlasData[oImageIds["batBehind"+t]].x,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds["batBehind"+t]].y,i=this.oGameElementsImgData.oData.oAtlasData[oImageIds["batBehind"+t]].width,r=this.oGameElementsImgData.oData.oAtlasData[oImageIds["batBehind"+t]].height;ctx.drawImage(this.oGameElementsImgData.img,a,s,i,r,-i/2*(1-Math.abs(Math.sin(this.flipX))),-r/3,i*(1-Math.abs(Math.sin(this.flipX))),r),ctx.rotate(-this.rotation),ctx.translate(0,Math.min(7*Math.max((this.y-.5*canvas.height)/(.5*canvas.height),0),7)),ctx.rotate(this.rotation);var a=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+o]].x,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+o]].y,i=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+o]].width,r=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+o]].height;ctx.drawImage(this.oGameElementsImgData.img,a,s,i,r,-i/2*(1-Math.abs(Math.sin(this.flipX))),-r/3,i*(1-Math.abs(Math.sin(this.flipX))),r),ctx.restore()},e}();e.UserBat=t}(Elements||(Elements={})),function(e){var t=function(){function e(){this.x=0,this.y=0,this.rotation=0,this.scale=1,this.speedX=3e3,this.maxAcc=500,this.skillLevel=0,this.powerLevel=0,this.spinLevel=0,this.id=0,this.aEases=["Quad.easeInOut","Back.easeOut","Cubic.easeOut","Back.easeInOut"],this.trackBall=!0,this.slideInc=0,this.flailInc=0,this.inc=0,this.incY=0,this.celebrateY=0,this.firstShot=!0,this.scoreDiff=0,this.flipX=1,this.flipY=1,this.swipeOffsetX=0,this.scoreDiffMax=.25,this.oGameElementsImgData=assetLib.getData("gameElements"),this.x=canvas.width/2,this.targX=0,this.targY=0,this.accX=0}return e.prototype.setEnemyLevel=function(){if(0==gameVariation)this.skillLevel=Math.min(Math.max(.2*Math.random()+Math.min(curLevel/30,.8)+this.scoreDiff,0),1),this.powerLevel=Math.min(Math.max(.2*Math.random()+Math.min(curLevel/20,.8)+this.scoreDiff,0),1),this.spinLevel=Math.min(Math.max(.2*Math.random()+Math.min(curLevel/20,.8)+this.scoreDiff,0),1);else if(2==gameVariation){var e=(500-Math.min(aSeasonFlags[saveDataHandler.getRound()].rank,500))/500*.6;this.skillLevel=Math.min(Math.max(.2+.2*Math.random()+e+this.scoreDiff,0),1),this.powerLevel=Math.min(Math.max(.2+.2*Math.random()+e+this.scoreDiff,0),1),this.spinLevel=Math.min(Math.max(.2+.2*Math.random()+e+this.scoreDiff,0),1)}},e.prototype.reset=function(){this.celebrateY=0,this.scoreDiff=0},e.prototype.levelComplete=function(){this.autotween&&this.autotween.kill(),this.incY=0,this.autotween=TweenLite.to(this,2,{rotation:360*radian,incY:180*radian,scale:0,ease:"Quad.easeOut",onComplete:function(){}})},e.prototype.resetToCentre=function(){this.trackBall=!1,this.moveTween&&this.moveTween.kill(),this.targX=this.x-canvas.width/2,this.moveTween=TweenLite.to(this,1,{targX:0,targY:0,ease:"Quad.easeInOut",onComplete:function(){(0==gameVariation||2==gameVariation)&&"enemy"==aBalls[curBallId].lastHit&&aBalls[curBallId].enemyServe()}})},e.prototype.flail=function(){var e=this;this.flailInc=0;var t=1;aBalls[curBallId].x<this.x&&(t=-1),TweenLite.to(this,.5,{flailInc:t,ease:"Quad.easeInOut",onComplete:function(){TweenLite.to(e,.5,{flailInc:0,ease:"Quad.easeInOut"})}})},e.prototype.setBouncePos=function(e,t,a){var s=this;if(this.moveTween&&this.moveTween.kill(),(0==a||1*Math.random()<.25)&&1!=aBalls[curBallId].servingState){this.trackBall=!1;var i=0;1*Math.random()>.75+.25*this.skillLevel&&(i=100*Math.random()-50);var r=t*t*tableDepth*(1+tableTop.offsetY/2)/2,o=r*(tableTop.offsetX+.6*e)*num128*(1+tableTop.offsetY/2)+e*tableBackWidth/2+100*a;this.moveTween=TweenLite.to(this,.6*Math.random()+.5+(1-this.skillLevel)*.75,{delay:.2*Math.random(),targX:o+i,targY:r,ease:this.aEases[Math.floor(Math.random()*this.aEases.length)],onComplete:function(){"enemy"==aBalls[curBallId].lastHit&&(s.moveTween=TweenLite.to(s,.6*Math.random()+.5+(1-s.skillLevel)*.75,{delay:.6*Math.random()*(1+(1-s.skillLevel)*1),targX:200*Math.random()-100,targY:0,ease:"Quad.easeInOut"}))}})}else this.trackBall=!0,this.slideInc=0,this.moveTween=TweenLite.to(this,(.6*Math.random()+.5)*(1+(1-this.skillLevel)*1),{targY:0,ease:"Quad.easeInOut"})},e.prototype.successFlip=function(){var e=this;this.swipeTween&&this.swipeTween.kill(),this.flipX=1,this.swipeTween=TweenLite.to(this,.5,{flipX:-1,ease:"Bounce.easeInOut",onComplete:function(){e.flipX=1}})},e.prototype.hitSwipe=function(){var e,t,a=this;this.swipeTween&&this.swipeTween.kill(),this.swipeOffsetX=0,Math.random()>.5?(e=.8+.2*Math.random(),t=1):(e=1,t=.8+.2*Math.random()),this.swipeTween=TweenLite.to(this,.1,{swipeOffsetX:100*Math.random()-50,flipX:e,flipY:t,ease:"Cubic.easeOut",onComplete:function(){a.swipeTween=TweenLite.to(a,.5,{swipeOffsetX:0,flipX:1,flipY:1,ease:"Back.easeOut",onComplete:function(){}})}})},e.prototype.update=function(){0==gameplayState?(this.inc+=delta,this.y=this.targY+onScreenY+50*tableTop.offsetY-50,this.x=canvas.width/2+50*Math.sin(5*this.inc),this.rotation=.3*Math.sin(5*this.inc),this.scale=.4+(this.y-onScreenY)/300):2==gameplayState?this.celebrateY=-50*Math.sin(this.incY):1==gameplayState&&(this.y=this.targY+onScreenY+50*tableTop.offsetY-50,this.trackBall?(this.slideInc=(aBalls[curBallId].x-this.x)*(15*this.skillLevel+10),this.x+=this.slideInc*delta,"enemy"==aBalls[curBallId].lastHit&&(this.targX=this.x-canvas.width/2,this.moveTween=TweenLite.to(this,(.6*Math.random()+.5)*(1+(1-this.skillLevel)*1),{delay:.6*Math.random()*(1+(1-this.skillLevel)*1),targX:200*Math.random()-100,targY:0,ease:"Quad.easeInOut"}),this.trackBall=!1)):this.x=this.targX+canvas.width/2,this.rotation=(this.x-canvas.width/2)/200,this.scale=.4+(this.y-onScreenY)/300,this.x=Math.min(Math.max(this.x,canvas.width/2-250),canvas.width/2+250))},e.prototype.getHitData=function(e,t){0==aBalls[curBallId].servingState?(this.hitX=2*Math.random()-1,this.hitY=.2*Math.random()+.65):(this.hitX=(1.8*Math.random()-.9)*(1+.25*this.skillLevel),Math.random()>.8+.2*this.skillLevel&&(this.x>canvas.width/2+120||this.x<canvas.width/2-120)&&(this.x>canvas.width/2?this.hitX=1.3:this.hitX=-1.3),this.hitY=.4*Math.random()+.65);var a=0;this.hitY<.95&&(this.hitX>.1?a=-(.5*Math.random()+.5)*this.spinLevel:this.hitX<-.1&&(a=(.5*Math.random()+.5)*this.spinLevel));var s=.3+.3/.4*(this.hitY-.6)*(.25+.9*this.powerLevel);return this.hitSwipe(),{x:this.hitX,y:this.hitY,speed:s,spin:a}},e.prototype.render=function(){ctx.save(),ctx.translate(this.x+(tableTop.offsetX+1*this.flailInc)*tableTop.sideMultiplier,this.y+this.celebrateY),ctx.rotate(this.rotation+1*this.flailInc),ctx.scale(this.scale*this.flipX,this.scale*this.flipY);var e=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+opBat]].x,t=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+opBat]].y,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+opBat]].width,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+opBat]].height;ctx.drawImage(this.oGameElementsImgData.img,e,t,a,s,-a/2+this.swipeOffsetX,-s/3,a,s),ctx.restore()},e}();e.EnemyBat=t}(Elements||(Elements={})),function(e){var t=function(){function t(e){void 0===e&&(e="user"),this.x=0,this.y=0,this.height=0,this.tablePosY=.5,this.tablePosX=0,this.scale=0,this.lastHit="user",this.speed=.45,this.offTable=!1,this.pause=!1,this.spin=0,this.spinInc=0,this.servingState=0,this.canHit=!1,this.serveFlip=!0,this.offSide=!1,this.bounceX=0,this.bounceY=0,this.ballShortState=0,this.ballType=0,this.hitStop=!1,this.trailSegs=15,this.curBallState=0,this.hasHitNetPvP=!1,this.offTablePvp=!1,this.oGameElementsImgData=assetLib.getData("gameElements"),"enemy"==e&&(this.serveFlip=!1),this.resetServe(e)}return t.prototype.resetServe=function(e){var t=this;2!=gameplayState&&(this.servingState=0,this.canHit=!1,this.hasHitNetPvP=!1,this.offTablePvp=!1,this.hitStop=!1,this.lastHit=e,this.hasHitNet=!1,1==gameVariation&&"user"==this.lastHit?tableTop.newTargetPos(0):0==gameVariation||2==gameVariation?enemyBat.resetToCentre():3==gameVariation&&(this.lastHit="user"),tableTop.tweenToPos(0,1,this.speed,this.lastHit,this.spin),enemyBat.setEnemyLevel(),rallyHits=0,this.x=-100,this.bounceNum=0,this.ballShortState=0,this.offTable=!1,this.offSide=!1,"user"==this.lastHit?(this.tablePosX=0,this.tablePosY=.9,this.height=37.5,this.heightInc=0,this.aTrailPoints=[],this.tableVX=0,this.tableVY=0,userBat.tutInc=0,userBat.tutState=1):(this.tablePosX=0,this.tablePosY=.2,0==gameVariation||2==gameVariation||4==gameVariation?this.height=22.5:(1==gameVariation||3==gameVariation)&&(this.height=45),this.heightInc=0,this.aTrailPoints=[],userBat.tutState=0),0==gameplayState?(this.servePosInc=1,this.canHit=!0):(this.servePosInc=0,this.servePrepTween=TweenLite.to(this,.5,{servePosInc:1,ease:"Quad.easeOut",onComplete:function(){t.canHit=!0}})))},t.prototype.enemyServe=function(){0==gameVariation||2==gameVariation||3==gameVariation?this.setBouncePoint(enemyBat.getHitData(this.tablePosX,this.tablePosY)):1==gameVariation&&(playSound("botThrow",.5),this.servingState=2,this.setBouncePoint({x:1*Math.random()-.5,y:.8,speed:.3,spin:0}),tableTop.botTween&&tableTop.botTween.kill(),tableTop.botY=15,tableTop.botTween=TweenLite.to(tableTop,1,{botY:0,ease:"Elastic.easeOut",onComplete:function(){}}))},t.prototype.setBouncePoint=function(t){if(this.spin=.65*t.spin,this.spinInc=0,"enemy"==this.lastHit)this.targBounceX=t.x,this.targBounceY=t.y,this.speed=.5*t.speed,tableTop.tweenToPos(this.targBounceX,this.targBounceY,this.speed,this.lastHit,this.spin),tableTop.changeStopVert(!1),0==this.servingState?(this.servingState=1,this.heightInc=-(1.3*((-2400+6*this.height)*(.8-this.speed)*1.2))):0==gameVariation||2==gameVariation||3==gameVariation||4==gameVariation?this.heightInc=(-2400+6*this.height)*(.8-this.speed)*1.3:1==gameVariation&&(this.heightInc=(-2e3+6*this.height)*(.8-this.speed)*1.3);else{if(this.targBounceX=t.x,this.targBounceY=t.y,this.speed=.5*t.speed,.27==this.speed)for(var a=360*Math.random()*radian,s=0;s<8;s++){var i=new e.Particle(this.x,this.y,1,200*Math.random()+100,a+45*s*radian,1,.5);aEffects.push(i)}0==this.servingState?(this.servingState=1,this.heightInc=-(1.1*((-2400+6*this.height)*(.8-this.speed)*1.2))):this.heightInc=(-2400+6*this.height)*(.8-this.speed)*1.3,tableTop.tweenToPos(0,1,this.speed,this.lastHit,this.spin),(0==gameVariation||2==gameVariation||3==gameVariation)&&enemyBat.setBouncePos(this.targBounceX,this.targBounceY,this.spin)}this.tableVX=(this.targBounceX-this.tablePosX)/((1-this.speed)*1.1),this.tableVY=(this.targBounceY-this.tablePosY)/((1-this.speed)*1.1)},t.prototype.getTargetHitData=function(e,t){return{x:e/3,y:.75,speed:.3+.3/.4*(.75-.6)*.25,spin:0}},t.prototype.userServe=function(e){void 0===e&&(e=!1),this.bounceNum=0,this.lastHit="user",hitFirstShot=!0,userBat.tutState=0,playSound("hit"+Math.floor(6*Math.random())),e?0==gameVariation||2==gameVariation||3==gameVariation?this.setBouncePoint({x:1*Math.random()-.5,y:.25,speed:.3,spin:0}):1==gameVariation&&this.setBouncePoint({x:0,y:.25,speed:.3,spin:0}):this.setBouncePoint(userBat.getHitData(this.tablePosX,this.tablePosY)),4==gameVariation&&netLib.send(!0,"serveBounce",[Math.round(1e3*this.targBounceX)/1e3,Math.round((1-this.targBounceY)*1e3)/1e3,Math.round(2e3*this.speed)/1e3,Math.round(1e3*this.tablePosX)/1e3,Math.round(1e3*this.tablePosY)/1e3,Math.round(1e3*this.height)/1e3])},t.prototype.hitNetPvP=function(){playSound("hitNet"),this.tablePosY=.49,this.hasHitNet=!0,this.hasHitNetPvP=!1,this.tableVY*=-.5,this.tableVX*=.5,this.ballShortState=2,this.heightInc*=.2},t.prototype.update=function(){if(0==gameplayState)this.y=onScreenY+50*tableTop.offsetY+this.tablePosY*this.tablePosY*tableDepth*(1+tableTop.offsetY/2)+(1-this.servePosInc)*100,this.tablePosX=Math.min(Math.max((userBat.x-canvas.width/2)/450,-.95),.95),this.x=canvas.width/2,this.scale=.25+(this.y-onScreenY)/800;else if(gameplayState>=3)this.y=onScreenY+50*tableTop.offsetY+this.tablePosY*this.tablePosY*tableDepth*(1+tableTop.offsetY/2)+(1-this.servePosInc)*100,this.tablePosX=Math.min(Math.max((userBat.x-canvas.width/2)/450,-.95),.95),this.x=canvas.width/2,this.scale=.25+(this.y-onScreenY)/800;else if(1==gameplayState){if(0==this.servingState){if("user"==this.lastHit){this.y=onScreenY+50*tableTop.offsetY+this.tablePosY*this.tablePosY*tableDepth*(1+tableTop.offsetY/2)+(1-this.servePosInc)*100,this.tablePosX=Math.min(Math.max((userBat.x-canvas.width/2)/450,-.95),.95),this.x=canvas.width/2+((this.y-onScreenY)*(tableTop.offsetX+this.tablePosX*ballPosMultiplier)*num128*(1+tableTop.offsetY/2)+this.tablePosX*tableBackWidth/2+tableTop.offsetX*tableTop.sideMultiplier)+-((1-this.servePosInc)*500),this.scale=.25+(this.y-onScreenY)/800;var t=userBat.x-this.x,a=userBat.y-100*userBat.scale+130*userBat.scale*Math.max(userBat.batSpreadX,userBat.batSpreadY)-(this.y-this.height*(3*this.scale)-16),s=Math.sqrt(t*t+a*a);this.canHit&&userBat.getHitData(this.tablePosX,this.tablePosY).y<.4&&s<130*userBat.scale*Math.max(userBat.batSpreadX,userBat.batSpreadY)&&this.userServe()}else this.y=onScreenY+50*tableTop.offsetY+this.tablePosY*this.tablePosY*tableDepth*(1+tableTop.offsetY/2)+(1-this.servePosInc)*100,this.tablePosX=0,4==gameVariation&&(this.tablePosX=Math.min(Math.max((enemyBat.x-canvas.width/2)/200,-.95),.95)),this.x=canvas.width/2+((this.y-onScreenY)*(tableTop.offsetX+this.tablePosX*ballPosMultiplier)*num128*(1+tableTop.offsetY/2)+this.tablePosX*tableBackWidth/2+tableTop.offsetX*tableTop.sideMultiplier)+-((1-this.servePosInc)*500),this.scale=.25+(this.y-onScreenY)/800}else{if(this.offTable||("user"==this.lastHit?this.spinInc=Math.min(Math.max(this.spinInc+Math.pow(2.5*this.spin,3)*delta*(1-this.tablePosY),-3),3):this.spinInc=Math.min(Math.max(this.spinInc+Math.pow(2*this.spin,3)*delta*this.tablePosY,-2),2),this.tablePosX+=(this.tableVX+this.spinInc)*delta,this.tablePosY+=this.tableVY*delta),!this.offTable&&"user"==this.lastHit&&this.tablePosY<0&&4!=gameVariation&&(this.offTable=!0,this.offTableVX=(this.x-this.aTrailPoints[Math.max(this.aTrailPoints.length-5,0)].x)*10,this.offTableVY=(this.y-this.aTrailPoints[Math.max(this.aTrailPoints.length-5,0)].y)*10,this.offTableTween&&this.offTableTween.kill(),this.offTableTween=TweenLite.to(this,2,{offTableVX:0,offTableVY:0,ease:"Quad.easeOut"}),(0==gameVariation||2==gameVariation)&&enemyBat.flail(),(rallyHits>8||Math.random()>.8||0==saveDataHandler.getLevel()&&0==curLevelStars)&&(0==gameVariation||2==gameVariation))){userBat.successFlip(),panel.showCongrats(),playSound("hitTarget",.3),playSound("cheer"+Math.floor(6*Math.random()));for(var i=0;i<25;i++){var r=new e.Confetti(canvas.width/2+400*Math.random()-200,.9*canvas.height);aEffects.push(r)}}if(this.heightInc+=5700*delta,this.height-=this.heightInc*this.speed*delta,4==gameVariation&&this.hasHitNetPvP&&this.hitNetPvP(),1==this.ballShortState&&this.tablePosY<=.5&&"user"==this.lastHit&&(playSound("hitNet"),this.hasHitNet=!0,this.tableVY*=-.5,this.tableVX*=.5,this.ballShortState=2,this.heightInc*=.2,4==gameVariation&&netLib.send(!0,"hitNet")),3==gameVariation&&"user"==this.lastHit&&this.tablePosY<.5&&0==this.curBallState&&this.height<30&&tableTop.checkZombieHit(this.x,this.y),this.tablePosX>-1&&this.tablePosX<1&&this.tablePosY>0&&this.tablePosY<1&&this.height<=0&&!this.offSide){if(this.height=0,this.heightInc*=-.85,0==this.ballShortState?playSound("bounce"+Math.floor(6*Math.random())):this.height=-3,this.bounceNum++,this.bounceX=this.tablePosX,this.bounceY=this.tablePosY,tableTop.bounce(Math.max(Math.min(-this.heightInc/1500,1),.1)),"user"==this.lastHit&&this.tablePosY>.5&&this.servingState>1&&(this.spin=0,this.ballShortState=1),1==gameVariation&&"user"==this.lastHit&&this.tablePosY<.5&&0==this.curBallState){var o=this.x-tableTop.holeX,n=this.y-tableTop.holeY;o*o/((306*tableTop.holeScale+50*this.scale)*(306*tableTop.holeScale+50*this.scale))+n*n/((112*tableTop.holeScale+25*this.scale)*(112*tableTop.holeScale+25*this.scale))<=1?(tableTop.holeHit(),setTimeout(function(){var t=new e.Ball("enemy");aBalls.push(t),t.enemyServe()},1e3)):(tableTop.holeMiss(),userInput.removeHitArea("pause"),setTimeout(function(){playSound("targetGameEnd"),curTargetScore>10&&playSound("cheer"+Math.floor(6*Math.random())),initTargetGameEnd()},1e3)),this.curBallState=1}}else(this.tablePosX<-1||this.tablePosX>1)&&!this.offTable&&this.tablePosY<1&&this.height<=0&&(this.offSide||netLib.send(!0,"offSide"),this.offSide=!0);if(4==gameVariation&&this.tablePosY<0&&this.height<=0&&("user"==this.lastHit||this.hasHitNet?this.offTable=!0:this.offTable=!1),!this.offTablePvp&&"user"==this.lastHit&&this.tablePosY<0&&(this.offTablePvp=!0,this.offTableVX=(this.x-this.aTrailPoints[Math.max(this.aTrailPoints.length-5,0)].x)*10,this.offTableVY=(this.y-this.aTrailPoints[Math.max(this.aTrailPoints.length-5,0)].y)*10,this.offTableTween&&this.offTableTween.kill(),this.offTableTween=TweenLite.to(this,2,{offTableVX:0,offTableVY:0,ease:"Quad.easeOut"})),(this.offTable||this.offSide)&&this.height<=-200){if(1==this.curBallState){this.curBallState=2;return}"user"==this.lastHit?4!=gameVariation&&(0==this.bounceNum||this.hitStop||this.hasHitNet?updateScore("enemy"):1==this.servingState&&1==this.bounceNum?updateScore("enemy"):updateScore("user")):0==this.bounceNum||this.hasHitNet?(updateScore("user"),4==gameVariation&&netLib.send(!0,"ballOff",[0])):(updateScore("enemy"),4==gameVariation&&netLib.send(!0,"ballOff",[1])),"enemy"==this.lastHit||4!=gameVariation?this.nextServeChoice():this.servingState=-1;return}if((4==gameVariation||this.offTable)&&(4!=gameVariation||this.offTablePvp)?(this.x+=this.offTableVX*delta,this.y+=this.offTableVY*delta):(this.y=onScreenY+50*tableTop.offsetY+this.tablePosY*this.tablePosY*tableDepth*(1+tableTop.offsetY/2),this.x=canvas.width/2+(this.y-onScreenY)*(tableTop.offsetX+this.tablePosX*ballPosMultiplier)*num128*(1+tableTop.offsetY/2)+this.tablePosX*tableBackWidth/2+tableTop.offsetX*tableTop.sideMultiplier),this.scale=.25+(this.y-onScreenY)/800,this.aTrailPoints.push({x:this.x,y:this.y,height:this.height,scale:this.scale,power:(this.speed-.12)/.12}),this.aTrailPoints.length>this.trailSegs&&this.aTrailPoints.shift(),this.y>canvas.height){if(1==this.curBallState){this.curBallState=2;return}(0==gameVariation||2==gameVariation||4==gameVariation)&&(this.bounceNum>0||this.ballShortState>0?(updateScore("enemy"),4==gameVariation&&netLib.send(!0,"ballOff",[1])):(updateScore("user"),4==gameVariation&&netLib.send(!0,"ballOff",[0]))),this.nextServeChoice();return}var l=1+Math.min(Math.abs(userBat.prevX-userBat.x),225)*userBat.batSpreadMultiplier,m=1+Math.min(Math.abs(userBat.prevY-userBat.y),225)*userBat.batSpreadMultiplier;userBat.batSpreadX-=(userBat.batSpreadX-l)*.2,userBat.batSpreadY-=(userBat.batSpreadY-m)*.2;var t=userBat.x-this.x,a=userBat.y-100*userBat.scale+130*userBat.scale*Math.max(userBat.batSpreadX,userBat.batSpreadY)-(this.y-this.height*(3*this.scale)-16),s=Math.sqrt(t*t+a*a);"enemy"==this.lastHit&&(2==this.servingState&&1==this.bounceNum||1==this.servingState&&2==this.bounceNum)&&this.tablePosY>.5&&s<130*userBat.scale*Math.max(userBat.batSpreadX,userBat.batSpreadY)&&(playSound("hit"+Math.floor(6*Math.random())),rallyHits++,this.servingState=2,this.bounceNum=0,this.lastHit="user",this.setBouncePoint(userBat.getHitData(this.tablePosX,this.tablePosY)),4==gameVariation&&netLib.send(!0,"hitBounce",[Math.round(1e3*this.targBounceX)/1e3,Math.round((1-this.targBounceY)*1e3)/1e3,Math.round(2e3*this.speed)/1e3,Math.round(1e3*this.tablePosX)/1e3,Math.round(1e3*this.tablePosY)/1e3,Math.round(1e3*this.height)/1e3])),0==gameVariation||2==gameVariation?"user"==this.lastHit&&(2==this.servingState&&1==this.bounceNum||1==this.servingState&&2==this.bounceNum)&&this.tablePosY<.5&&this.tablePosY>0&&enemyBat.x>this.x-70*enemyBat.scale&&enemyBat.x<this.x+70*enemyBat.scale&&enemyBat.y>this.y-this.height*(3*this.scale)-16-82*enemyBat.scale&&enemyBat.y<this.y-this.height*(3*this.scale)-16+82*enemyBat.scale&&(playSound("hit"+Math.floor(6*Math.random())),rallyHits++,this.servingState=2,this.bounceNum=0,this.lastHit="enemy",this.setBouncePoint(enemyBat.getHitData(this.tablePosX,this.tablePosY))):3==gameVariation&&"user"==this.lastHit&&(2==this.servingState||1==this.servingState)&&this.tablePosY<.1&&(playSound("hit"+Math.floor(6*Math.random())),this.servingState=2,this.bounceNum=0,this.lastHit="enemy",this.setBouncePoint({x:Math.max(Math.min(.75*this.tablePosX,.8),-.8),y:.8,speed:.3,spin:0}))}}},t.prototype.nextServeChoice=function(){((oGameData.userScore+oGameData.enemyScore)%2==0||oGameData.userScore>=10&&oGameData.enemyScore>=10)&&(this.serveFlip=!this.serveFlip),this.serveFlip&&1!=gameVariation?this.resetServe("user"):(this.resetServe("enemy"),1==gameVariation&&this.enemyServe())},t.prototype.render=function(){if(!(gameplayState>1)){if(this.tablePosX>-1&&this.tablePosX<1&&this.tablePosY>0&&this.tablePosY<1){ctx.save(),ctx.globalAlpha=Math.max(1-this.height/100,.25);var e=this.oGameElementsImgData.oData.oAtlasData[oImageIds.ballShadow].x,t=this.oGameElementsImgData.oData.oAtlasData[oImageIds.ballShadow].y,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds.ballShadow].width,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds.ballShadow].height;ctx.drawImage(this.oGameElementsImgData.img,e,t,a,s,this.x-a/2*this.scale,this.y-s/2*this.scale,a*this.scale,s*this.scale),ctx.restore()}"enemy"==this.lastHit&&0==this.ballShortState&&this.renderTrail();var e=this.oGameElementsImgData.oData.oAtlasData[oImageIds["ball"+this.ballType]].x,t=this.oGameElementsImgData.oData.oAtlasData[oImageIds["ball"+this.ballType]].y,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds["ball"+this.ballType]].width,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds["ball"+this.ballType]].height;ctx.drawImage(this.oGameElementsImgData.img,e,t,a,s,this.x-a/2*this.scale,this.y-s/2*this.scale-this.height*(3*this.scale)-23,a*this.scale,s*this.scale),"user"==this.lastHit&&0==this.ballShortState&&this.renderTrail()}},t.prototype.renderTrail=function(){if(this.aTrailPoints.length>1&&this.scale>0)for(var e=0;e<this.aTrailPoints.length;e++)ctx.fillStyle="rgba(255, 255, 100,"+e/this.aTrailPoints.length*.3+")",ctx.beginPath(),ctx.arc(this.aTrailPoints[e].x,this.aTrailPoints[e].y-this.aTrailPoints[e].height*(3*this.aTrailPoints[e].scale)-23,20*this.scale,0,2*Math.PI),ctx.fill()},t}();e.Ball=t}(Elements||(Elements={})),function(e){var t=function(){function t(){this.segs=100,this.offsetX=0,this.offsetY=0,this.netY=0,this.segMultiplier=1,this.netHeight=0,this.id=0,this.sideMultiplier=100,this.bounceMarkScale=0,this.targetX=0,this.stopHeight=0,this.stopOffsetX=0,this.canChangeStop=!1,this.holeFixedScale=1,this.holeHitScale=0,this.blockOffsetY=0,this.tableHeight=352,this.edgeMultuplier=1.46,this.botY=0,this.zoomScale=0,this.zoomAlpha=0,this.targId=0,this.aZombies=[],this.zombieScale=90,this.aColours=["#00e9b2","#00ddd9","#00d2f5","#0bc4ff","#7ab2ff","#8babff","#a4a3ff","#c098ff","#e085ff","#ff70fd","#ff6dd4","#ff70b1","#ff7092","#ff6e71","#fc7954","#ff874c","#ff9644","#ffa53c","#ffb434","#ffc42e","#e4d026","#c5da2e","#a3e342","#7bea5c","#42f079","#42f079"],this.aBugColours=["#E6B763","#61F295","#CFE458","#FC8995","#F7E497","#F1394B","#DF7FAB","#80EEF3"],this.oGameElementsImgData=assetLib.getData("gameElements"),this.id=0,this.setTableCol()}return t.prototype.setZombieStart=function(){this.zombieBase={x:0,y:0,offsetX:0,offsetY:.25,energy:1,height:0},this.aZombies=[];for(var e=0;e<Math.min(bugWave+5,15);e++)this.aZombies.push(this.resetZombie(e))},t.prototype.resetZombie=function(e){var t={id:e,x:0,y:0,offsetX:0,offsetY:0,startX:2*Math.random()-1,startY:.3*Math.random()+.1,endX:1.6*Math.random()-.8,endY:.3*Math.random()+.1,energy:1,height:0,speed:.05*Math.random()+.05,scale:1,tweenScale:0,canHit:!0},a=TweenLite.to(t,.5,{tweenScale:1,ease:"Back.easeOut",onComplete:function(){}});return t.tween=a,t},t.prototype.checkZombieHit=function(t,a){for(var s=this,i=0;i<this.aZombies.length;i++){var r=t-this.aZombies[i].x,o=a-this.aZombies[i].y;if(this.aZombies[i].canHit&&r*r/(this.zombieScale*this.aZombies[i].scale*(this.zombieScale*this.aZombies[i].scale))+o*o/(.5*this.zombieScale*this.aZombies[i].scale*(.37*this.zombieScale*this.aZombies[i].scale))<=1){bugScore++;for(var n=30*radian,l=0;l<5;l++){var m=new e.Particle(this.aZombies[i].x,this.aZombies[i].y,.5*Math.random()+.75,200*Math.random()+200,n+30*l*radian+(10*Math.random()-5)*radian,15,1,25,this.aBugColours[this.aZombies[i].id%8]);aEffects.push(m)}panel.tweenTargetGameScore(),this.aZombies[i].canHit=!1,playSound("bugSplat"+Math.floor(5*Math.random()),.5*Math.random()+.3),this.aZombies[i].tween&&this.aZombies[i].tween.kill();var h=this.aZombies[i].id;this.aZombies[i].tween=TweenLite.to(this.aZombies[i],.25,{tweenScale:0,ease:"Cubic.easeOut",onCompleteParams:[this,h],onComplete:function(e,t){++bugWaveKilled>=Math.min(bugWave+5,15)&&(playSound("winSet",.3),playSound("cheer"+Math.floor(6*Math.random())),s.tweenColours(),bugWave++,bugWaveKilled=0,s.setZombieStart(),panel.addBugTime())}})}}},t.prototype.setTableCol=function(){0==gameplayState||0==gameVariation?this.colourId=Math.floor(curLevel)%this.aColours.length:this.colourId=Math.floor(Math.random()*this.aColours.length),this.gradientId=this.colourId},t.prototype.tweenColours=function(){this.fadeTween&&this.fadeTween.kill(),this.gradientId=this.colourId,this.fadeTween=TweenLite.to(this,.75,{gradientId:this.colourId+this.aColours.length,ease:"none"})},t.prototype.startBot=function(){this.botTween&&this.botTween.kill(),this.botY=50,this.botTween=TweenLite.to(this,.5,{botY:0,ease:"Cubic.easeOut",onComplete:function(){}})},t.prototype.zoomTarget=function(){this.targetZoomTween&&this.targetZoomTween.kill(),this.zoomScale=this.holeScale,this.zoomX=this.holeX,this.zoomY=this.holeY,this.zoomAlpha=1,this.targetZoomTween=TweenLite.to(tableTop,.5,{zoomScale:3*this.zoomScale,zoomAlpha:0,ease:"Cubic.easeOut",onComplete:function(){}})},t.prototype.setTarget=function(){this.holeX=0,this.holeY=0,this.holeOffsetX=0,this.holeOffsetY=.3,this.holeTween&&this.holeTween.kill(),this.holeTween=TweenLite.to(this,.25,{holeOffsetX:0,holeOffsetY:.3,holeHitScale:Math.max(this.holeFixedScale*=.97,.35),ease:"Quad.easeInOut",onComplete:function(){}})},t.prototype.changeHolePos=function(){this.targId=0,this.holeTween=TweenLite.to(this,.25,{holeOffsetX:1.2*Math.random()-.6,holeOffsetY:.25*Math.random()+.2,holeHitScale:Math.max(this.holeFixedScale*=.97,.35),ease:"Quad.easeInOut",onComplete:function(){}})},t.prototype.holeHit=function(){var t=this;this.holeTween&&this.holeTween.kill(),playSound("hitTarget",.3),this.tweenColours(),curTargetScore++,saveDataHandler.setBestTargetScore(curTargetScore),panel.tweenTargetGameScore(),this.zoomTarget(),this.targId=1,curTargetScore>=10&&curTargetScore%5==0&&playSound("cheer"+Math.floor(6*Math.random())),this.holeTween=TweenLite.to(this,.25,{holeHitScale:0,ease:"Back.easeIn",onComplete:function(){t.changeHolePos()}});for(var a=30*radian,s=0;s<20;s++){var i=new e.Particle(aBalls[curBallId].x,aBalls[curBallId].y,.5*Math.random()+.75,200*Math.random()+200,a+120/19*s*radian,15,1,25);aEffects.push(i)}},t.prototype.holeMiss=function(){playSound("missTarget",.7),this.holeFixedScale=1,this.holeTween=TweenLite.to(this,.25,{holeHitScale:0,ease:"Back.easeIn",onComplete:function(){}}),tableTop.botTween&&tableTop.botTween.kill(),tableTop.botTween=TweenLite.to(tableTop,1,{botY:50,ease:"Bounce.easeOut",onComplete:function(){}})},t.prototype.changeStopVert=function(e){e?(this.stopTweenVert&&this.stopTweenVert.kill(),this.canChangeStop=!1,this.stopTweenVert=TweenLite.to(this,.2,{stopHeight:Math.floor(1.5*Math.random()),ease:"Quad.easeOut"})):(this.stopTweenVert&&this.stopTweenVert.kill(),this.canChangeStop=!0,this.stopTweenVert=TweenLite.to(this,.2,{stopHeight:1,stopOffsetX:1*Math.random()-.5,ease:"Quad.easeOut"}))},t.prototype.bounce=function(e){this.bounceMarkScale=e},t.prototype.tweenToPos=function(e,t,a,s,i){this.offsetTween&&this.offsetTween.kill();var r=0,o=0;(e>.3||e<-.3)&&(r=-e/1.75-i/2);var n=1;"enemy"==s&&(n=.75,o=(1-(t-.5)*2)*(.3-(a-.3))/.3),this.offsetTween=TweenLite.to(this,n,{offsetX:r,offsetY:o,ease:"Quad.easeOut"})},t.prototype.newTargetPos=function(e){var t;void 0===e&&(e=null),t=null==e?250*Math.random()-125:e,this.targetTween&&this.targetTween.kill(),this.targetTween=TweenLite.to(this,.75,{targetX:t,ease:"Quad.easeInOut"})},t.prototype.render=function(){var e=this.oGameElementsImgData.oData.oAtlasData[oImageIds.net].height;if(onScreenY=canvas.height<1.2*canvas.width?canvas.height/4:.35*canvas.height,this.genScale=1+this.offsetY/3,this.netY=onScreenY-e+this.tableHeight/this.segs*(.282*this.segs)*this.genScale+50*this.offsetY,this.netHeight=e*this.genScale,1==gameVariation){var t=this.oGameElementsImgData.oData.oAtlasData[oImageIds.bot].x,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds.bot].y,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds.bot].width,e=this.oGameElementsImgData.oData.oAtlasData[oImageIds.bot].height,i=onScreenY+50*this.offsetY;ctx.drawImage(this.oGameElementsImgData.img,t,a,s,e,canvas.width/2-s/2*this.genScale+this.offsetX*(0*this.segs)*3*this.edgeMultuplier*this.genScale+this.offsetX*this.edgeMultuplier*this.sideMultiplier,i-100*this.genScale+this.botY*this.genScale,s*this.genScale,e*this.genScale)}if(3==gameVariation){var r=getSpriteData(assetLib.getData("bugs"),"bugBack"),o=canvas.width/2+this.offsetX*(0*this.segs)*3*this.edgeMultuplier*this.genScale+this.offsetX*this.edgeMultuplier*this.sideMultiplier,n=onScreenY+50*this.offsetY;ctx.drawImage(r.img,r.bX,r.bY,r.bWidth,r.bHeight,o-r.bWidth/2*this.genScale,n-.4*r.bHeight*this.genScale,r.bWidth*this.genScale,r.bHeight*this.genScale),addDirectText(0,50*this.genScale,canvas.width/2,"center",o,n-20*this.genScale,"WAVE "+panel.twoDigit(bugWave+1),"#FF7000")}var t=this.oGameElementsImgData.oData.oAtlasData[oImageIds.tableClip].x,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds.tableClip].y,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds.tableClip].width,e=this.oGameElementsImgData.oData.oAtlasData[oImageIds.tableClip].height;ctx.drawImage(this.oGameElementsImgData.img,t,a,s,e,canvas.width/2-s/2*(1+this.offsetY/3)+this.offsetX*(.282*this.segs)*3*this.edgeMultuplier*(1+this.offsetY/3)+this.offsetX*this.edgeMultuplier*this.sideMultiplier*this.segMultiplier,this.netY+this.netHeight-3*(1+this.offsetY/3),s*(1+this.offsetY/3),e*(1+this.offsetY/3));var l=176*this.genScale,m=(543*.282+352)/2*this.genScale,h=447.5*this.genScale,i=onScreenY+50*this.offsetY,d=this.netY+this.netHeight,u=onScreenY+352*(1+this.offsetY/2)+50*this.offsetY,c=this.offsetX*this.sideMultiplier*this.edgeMultuplier,g=(this.offsetX*(.282*100)*3*this.genScale+this.offsetX*this.sideMultiplier)*this.edgeMultuplier,p=(300*this.offsetX*this.genScale+this.offsetX*this.sideMultiplier)*this.edgeMultuplier;ctx.fillStyle="#333333",ctx.beginPath(),ctx.moveTo(canvas.width/2-l+c,i),ctx.lineTo(canvas.width/2+l+c,i),ctx.lineTo(canvas.width/2+h+p,u),ctx.lineTo(canvas.width/2-h+p,u),ctx.lineTo(canvas.width/2-l+c,i),ctx.closePath(),ctx.fill(),ctx.fillStyle="#FFFFFF",ctx.beginPath(),ctx.moveTo(canvas.width/2-l+c+2*this.genScale,i+2*this.genScale),ctx.lineTo(canvas.width/2+l+c-2*this.genScale,i+2*this.genScale),ctx.lineTo(canvas.width/2+h+p-6*this.genScale,u),ctx.lineTo(canvas.width/2-h+p+6*this.genScale,u),ctx.lineTo(canvas.width/2-l+c+2*this.genScale,i+2*this.genScale),ctx.closePath(),ctx.fill();var $=ctx.createLinearGradient(canvas.width/2,i+4*this.genScale,canvas.width/2,u-13*this.genScale);if($.addColorStop(0,this.aColours[Math.floor(this.gradientId)%this.aColours.length]),$.addColorStop(.5,this.aColours[Math.floor(this.gradientId+1)%this.aColours.length]),$.addColorStop(1,this.aColours[Math.floor(this.gradientId+2)%this.aColours.length]),ctx.fillStyle=$,ctx.beginPath(),ctx.moveTo(canvas.width/2-l+c+10*this.genScale,i+4*this.genScale),ctx.lineTo(canvas.width/2-2*this.genScale+c,i+4*this.genScale),ctx.lineTo(canvas.width/2-8*this.genScale+p,u-13*this.genScale),ctx.lineTo(canvas.width/2-h+p+40*this.genScale,u-13*this.genScale),ctx.lineTo(canvas.width/2-l+c+10*this.genScale,i+4*this.genScale),ctx.closePath(),ctx.fill(),ctx.beginPath(),ctx.moveTo(canvas.width/2+2*this.genScale+c,i+4*this.genScale),ctx.lineTo(canvas.width/2+l+c-10*this.genScale,i+4*this.genScale),ctx.lineTo(canvas.width/2+h+p-40*this.genScale,u-13*this.genScale),ctx.lineTo(canvas.width/2+8*this.genScale+p,u-13*this.genScale),ctx.lineTo(canvas.width/2+2*this.genScale+c,i+4*this.genScale),ctx.closePath(),ctx.fill(),1==gameVariation){ctx.save(),ctx.beginPath(),ctx.moveTo(canvas.width/2-l+c+2*this.genScale,i+2*this.genScale),ctx.lineTo(canvas.width/2+l+c-2*this.genScale,i+2*this.genScale),ctx.lineTo(canvas.width/2+m+g-6*this.genScale,d),ctx.lineTo(canvas.width/2-m+g+6*this.genScale,d),ctx.lineTo(canvas.width/2-l+c+2*this.genScale,i+2*this.genScale),ctx.closePath(),ctx.clip();var t=this.oGameElementsImgData.oData.oAtlasData[oImageIds["target"+this.targId]].x,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds["target"+this.targId]].y,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds["target"+this.targId]].width,e=this.oGameElementsImgData.oData.oAtlasData[oImageIds["target"+this.targId]].height;this.holeY=onScreenY+50*this.offsetY+this.holeOffsetY*this.holeOffsetY*tableDepth*(1+this.offsetY/2),this.holeX=canvas.width/2+(this.holeY-onScreenY)*(this.offsetX+this.holeOffsetX*ballPosMultiplier)*.85*(1+this.offsetY/2)+this.holeOffsetX*tableBackWidth/2+this.offsetX*this.sideMultiplier,this.holeScale=this.genScale*(.3+.5*this.holeOffsetY)*this.holeHitScale,ctx.drawImage(this.oGameElementsImgData.img,t,a,s,e,this.holeX-s/2*this.holeScale,this.holeY-e/2*this.holeScale,s*this.holeScale,e*this.holeScale),ctx.restore()}if(3==gameVariation){this.aZombies=sortBy(this.aZombies,"y");for(var v=0;v<this.aZombies.length;v++){var r=getSpriteData(assetLib.getData("bugs"),"bug"+this.aZombies[v].id%8);this.aZombies[v].offsetX=this.aZombies[v].startX+(this.aZombies[v].endX-this.aZombies[v].startX)*(Math.sin(panel.incY*this.aZombies[v].speed+this.aZombies[v].id)+1)*.5,this.aZombies[v].offsetY=this.aZombies[v].startY+(this.aZombies[v].endY-this.aZombies[v].startY)*(Math.sin(panel.incY*this.aZombies[v].speed+this.aZombies[v].id)+1)*.5,this.aZombies[v].y=onScreenY+50*this.offsetY+this.aZombies[v].offsetY*this.aZombies[v].offsetY*tableDepth*(1+this.offsetY/2),this.aZombies[v].x=canvas.width/2+(this.aZombies[v].y-onScreenY)*(this.offsetX+this.aZombies[v].offsetX*ballPosMultiplier)*.85*(1+this.offsetY/2)+this.aZombies[v].offsetX*tableBackWidth/2+this.offsetX*this.sideMultiplier,this.aZombies[v].scale=this.genScale*(.3+.5*this.aZombies[v].offsetY);var I=1+.1*Math.sin(panel.incY+this.aZombies[v].id);ctx.drawImage(r.img,r.bX,r.bY,r.bWidth,r.bHeight,this.aZombies[v].x-r.bWidth/2*this.aZombies[v].scale*this.aZombies[v].tweenScale,this.aZombies[v].y-.8*r.bHeight*this.aZombies[v].scale*I*this.aZombies[v].tweenScale,r.bWidth*this.aZombies[v].scale*this.aZombies[v].tweenScale,r.bHeight*this.aZombies[v].scale*this.aZombies[v].tweenScale*I)}}ctx.save(),ctx.beginPath(),ctx.moveTo(canvas.width/2-l+c+2*this.genScale,i+2*this.genScale),ctx.lineTo(canvas.width/2+l+c-2*this.genScale,i+2*this.genScale),ctx.lineTo(canvas.width/2+h+p-6*this.genScale,u),ctx.lineTo(canvas.width/2-h+p+6*this.genScale,u),ctx.lineTo(canvas.width/2-l+c+2*this.genScale,i+2*this.genScale),ctx.closePath(),ctx.clip();var t=this.oGameElementsImgData.oData.oAtlasData[oImageIds.netReflect].x,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds.netReflect].y,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds.netReflect].width,e=this.oGameElementsImgData.oData.oAtlasData[oImageIds.netReflect].height;ctx.drawImage(this.oGameElementsImgData.img,t,a,s,e,canvas.width/2-s/2*this.genScale+this.offsetX*(.282*this.segs)*3*this.edgeMultuplier*this.genScale+this.offsetX*this.edgeMultuplier*this.sideMultiplier*this.segMultiplier,this.netY+(e-4)*this.genScale,s*this.genScale,e*this.genScale);var t=this.oGameElementsImgData.oData.oAtlasData[oImageIds.batShadow].x,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds.batShadow].y,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds.batShadow].width,e=this.oGameElementsImgData.oData.oAtlasData[oImageIds.batShadow].height;if(ctx.drawImage(this.oGameElementsImgData.img,t,a,s,e,userBat.x-s/2*userBat.scale,userBat.y-(e/2-200)*userBat.scale,s*userBat.scale,e*userBat.scale),0==gameVariation||2==gameVariation||4==gameVariation){var t=this.oGameElementsImgData.oData.oAtlasData[oImageIds.batShadow].x,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds.batShadow].y,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds.batShadow].width,e=this.oGameElementsImgData.oData.oAtlasData[oImageIds.batShadow].height;ctx.drawImage(this.oGameElementsImgData.img,t,a,s,e,enemyBat.x-s/2*enemyBat.scale+(this.offsetX+1*enemyBat.flailInc)*this.sideMultiplier+enemyBat.swipeOffsetX*enemyBat.scale,enemyBat.y-(e/2-200)*enemyBat.scale,s*enemyBat.scale,e*enemyBat.scale)}ctx.restore();var t=this.oGameElementsImgData.oData.oAtlasData[oImageIds.tableEdge].x,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds.tableEdge].y,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds.tableEdge].width,e=this.oGameElementsImgData.oData.oAtlasData[oImageIds.tableEdge].height;if(ctx.drawImage(this.oGameElementsImgData.img,t,a,s,e,canvas.width/2-s/2*(1+this.offsetY/3)+300*this.offsetX*this.edgeMultuplier*(1+this.offsetY/3)+this.offsetX*this.edgeMultuplier*this.sideMultiplier,onScreenY+this.tableHeight*(1+this.offsetY/2)+50*this.offsetY,s*(1+this.offsetY/3),e*(1+this.offsetY/3)),this.zoomAlpha>0){var r=getSpriteData(assetLib.getData("gameElements"),"targetZoom");ctx.save(),ctx.globalAlpha=this.zoomAlpha,ctx.drawImage(r.img,r.bX,r.bY,r.bWidth,r.bHeight,this.zoomX-r.bWidth/2*this.zoomScale,this.zoomY-r.bHeight/2*this.zoomScale,r.bWidth*this.zoomScale,r.bHeight*this.zoomScale),ctx.restore()}if(this.bounceMarkScale>0&&aBalls.length>0){this.bounceMarkScale-=3*delta;var t=this.oGameElementsImgData.oData.oAtlasData[oImageIds.bounceMark].x,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds.bounceMark].y,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds.bounceMark].width,e=this.oGameElementsImgData.oData.oAtlasData[oImageIds.bounceMark].height,b=onScreenY+50*this.offsetY+aBalls[curBallId].bounceY*aBalls[curBallId].bounceY*tableDepth*(1+this.offsetY/2),_=canvas.width/2+(b-onScreenY)*(this.offsetX+aBalls[curBallId].bounceX*ballPosMultiplier)*num128*(1+this.offsetY/2)+aBalls[curBallId].bounceX*tableBackWidth/2+this.offsetX*this.sideMultiplier,B=.6+(b-onScreenY)/600;ctx.drawImage(this.oGameElementsImgData.img,t,a,s,e,_-s/2*(B*this.bounceMarkScale),b-e/2*(B*this.bounceMarkScale),s*(B*this.bounceMarkScale),e*(B*this.bounceMarkScale))}},t.prototype.renderNet=function(){var e=this.oGameElementsImgData.oData.oAtlasData[oImageIds.net].x,t=this.oGameElementsImgData.oData.oAtlasData[oImageIds.net].y,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds.net].width,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds.net].height;ctx.drawImage(this.oGameElementsImgData.img,e,t,a,s,canvas.width/2-a/2*this.genScale+this.offsetX*(.282*this.segs)*3*this.edgeMultuplier*this.genScale+this.offsetX*this.edgeMultuplier*this.sideMultiplier*this.segMultiplier,this.netY,a*this.genScale,this.netHeight)},t}();e.TableTop=t}(Elements||(Elements={})),function(e){var t=function(){function e(){this.oTextData={},this.inc=0,this.createTextObjects()}return e.prototype.createTextObjects=function(){for(var e in assetLib.textData.langText.text[curLang])this.oTextData[e]={},this.oTextData[e].aLineData=this.getCharData(assetLib.textData.langText.text[curLang][e]["@text"],assetLib.textData.langText.text[curLang][e]["@fontId"]),this.oTextData[e].aLineWidths=this.getLineWidths(this.oTextData[e].aLineData),this.oTextData[e].blockWidth=this.getBlockWidth(this.oTextData[e].aLineData),this.oTextData[e].blockHeight=this.getBlockHeight(this.oTextData[e].aLineData,assetLib.textData.langText.text[curLang][e]["@fontId"]),this.oTextData[e].lineHeight=parseInt(assetLib.textData["fontData"+assetLib.textData.langText.text[curLang][e]["@fontId"]].text.common["@lineHeight"]),this.oTextData[e].oFontImgData=assetLib.getData("font"+assetLib.textData.langText.text[curLang][e]["@fontId"])},e.prototype.getLineWidths=function(e){for(var t,a=[],s=0;s<e.length;s++){t=0;for(var i=0;i<e[s].length;i++)t+=parseInt(e[s][i]["@xadvance"]),0==i?t-=parseInt(e[s][i]["@xoffset"]):i==e[s].length-1&&(t+=parseInt(e[s][i]["@xoffset"]));a.push(t)}return a},e.prototype.getBlockWidth=function(e){for(var t,a=0,s=0;s<e.length;s++){t=0;for(var i=0;i<e[s].length;i++)t+=parseInt(e[s][i]["@xadvance"]),0==i?t-=parseInt(e[s][i]["@xoffset"]):i==e[s].length-1&&(t+=parseInt(e[s][i]["@xoffset"]));t>a&&(a=t)}return a},e.prototype.getBlockHeight=function(e,t){return e.length*parseInt(assetLib.textData["fontData"+t].text.common["@lineHeight"])},e.prototype.getCharData=function(e,t){for(var a=[],s=0;s<e.length;s++){a[s]=[];for(var i=0;i<e[s].length;i++)for(var r=0;r<assetLib.textData["fontData"+t].text.chars.char.length;r++)e[s][i].charCodeAt(0)==assetLib.textData["fontData"+t].text.chars.char[r]["@id"]&&a[s].push(assetLib.textData["fontData"+t].text.chars.char[r])}return a},e.prototype.renderText=function(e){var t,a=this.oTextData[e.text].aLineData,s=this.oTextData[e.text].oFontImgData,i=0,r=0,o=0,n=1,l=0;e.lineOffsetY&&(o=e.lineOffsetY),e.scale&&(n=e.scale);var m=1*n;e.maxWidth&&this.oTextData[e.text].blockWidth*n>e.maxWidth&&(m=e.maxWidth/this.oTextData[e.text].blockWidth),e.anim&&(this.inc+=7*delta);for(var h=0;h<a.length;h++){t=0,"centre"==e.alignX&&(i=this.oTextData[e.text].aLineWidths[h]/2),"centre"==e.alignY&&(r=this.oTextData[e.text].blockHeight/2+o*(a.length-1)/2);for(var d=0;d<a[h].length;d++){var u=a[h][d]["@x"],c=a[h][d]["@y"],g=a[h][d]["@width"],p=a[h][d]["@height"];e.anim&&(l=Math.sin(this.inc+d/2)*(p/15*m)),ctx.drawImage(s.img,u,c,g,p,e.x+(t+parseInt(a[h][d]["@xoffset"])-i)*m,e.y+(parseInt(a[h][d]["@yoffset"])+h*this.oTextData[e.text].lineHeight+h*o-r)*m+l,g*m,p*m),t+=parseInt(a[h][d]["@xadvance"])}}},e}();e.TextDisplay=t}(Utils||(Utils={})),function(e){var t=function(){function e(e,t){void 0===t&&(t=!1),this.aAllCountryCodes={0:"ES",1:"AU",2:"AT",3:"AG",4:"AR",5:"AM",6:"BO",7:"BQ",8:"BA",9:"TL",10:"VN",11:"GA",12:"PT",13:"AZ",14:"",15:"AW",16:"BS",17:"BD",18:"BW",19:"BR",20:"BN",21:"HW",22:"GY",23:"GM",24:"",25:"AL",26:"DZ",27:"BB",28:"BH",29:"BY",30:"BF",31:"BI",32:"VU",33:"GH",34:"GP",35:"GN",36:"AI",37:"AO",38:"AD",39:"BE",40:"BJ",41:"BG",42:"GB",43:"HU",44:"VE",45:"GN",46:"GW",47:"DE",48:"ZW",49:"IL",50:"IN",51:"KZ",52:"CM",53:"CA",54:"CO",55:"KM",56:"CD",57:"CW",58:"LA",59:"LV",60:"ID",61:"JO",62:"IQ",63:"QA",64:"KE",65:"CY",66:"CG",67:"KP",68:"KR",69:"LS",70:"LR",71:"LB",72:"IR",73:"IE",74:"IS",75:"",76:"KG",77:"KI",78:"",79:"CR",80:"CI",81:"LY",82:"LT",83:"LI",84:"IT",85:"",86:"",87:"CN",88:"",89:"",90:"CU",91:"",92:"CK",93:"",94:"",95:"",96:"",97:"",98:"",99:"",100:"",101:"",102:"",103:"",104:"",105:"NL",106:"",107:"NZ",108:"",109:"",110:"",111:"",112:"",113:"",114:"",115:"",116:"",117:"",118:"",119:"TR",120:"RU",121:"",122:"",123:"",124:"",125:"",126:"",127:"",128:"",129:"UZ",130:"",131:"UY",132:"",133:"WS",134:"",135:"",136:"",137:"",138:"",139:"",140:"",141:"",142:"PH",143:"FI",144:"",145:"",146:"",147:"",148:"",149:"US",150:"",151:"",152:"",153:"FR",154:"",155:"",156:"",157:"",158:"",159:"CZ",160:"CL",161:"CH",162:"MG",163:"",164:"",165:"",166:"",167:"",168:"HK",169:"",170:"GL",171:"SE",172:"",173:"EE",174:"",175:"MY",176:"",177:"",178:"NO",179:"",180:"GR",181:"",182:"DK",183:"ET",184:"",185:"ZA",186:"",187:"",188:"",189:"AE",190:"PK",191:"",192:"",193:"",194:"",195:"",196:"JM",197:"JP",198:"PE",199:"",200:"PL",201:"",202:"",203:"PG"},this.aIds=[];for(var a=0;a<e.length;a++)this.aIds.push(this.getIdFromISO(e[a]));t&&(this.aIds=this.randomise(this.aIds))}return e.prototype.getIdFromISO=function(e){var t=0;for(var a in this.aAllCountryCodes){if(this.aAllCountryCodes[a]==e)break;t++}return t},e.prototype.getBData=function(e){return{bX:e%12*124+30.5,bY:85.5*Math.floor(e/12)+14,bWidth:85.5,bHeight:59}},e.prototype.randomise=function(e){for(var t=e.length-1;t>0;t--){var a=Math.floor(Math.random()*(t+1)),s=e[t];e[t]=e[a],e[a]=s}return e},e}();e.CountryFlags=t}(Utils||(Utils={})),function(e){var t=function(e){function t(){var t=e.call(this,assetLib.getData("firework"),30,30,"explode")||this;return t.vy=0,t.setAnimType("once","explode"),t.animEndedFunc=function(){this.removeMe=!0},t.scaleX=.5,t.scaleY=.5,t}return __extends(t,e),t.prototype.blowUp=function(){TweenLite.to(this,.5,{scaleX:this.endScale,scaleY:this.endScale,ease:"Quad.easeOut"})},t.prototype.update=function(t,a){this.vy+=150*delta,this.y+=this.vy*delta,e.prototype.updateAnimation.call(this,delta)},t.prototype.render=function(){e.prototype.renderSimple.call(this,ctx)},t}(Utils.AnimSprite);e.Firework=t}(Elements||(Elements={})),function(e){var t=function(){function e(e){this.canStore=!1,this.batCount=57,this.addedIndex=56,this.saveDataId=e;var t,a="test",s=!1;try{t=window.localStorage,s=!0}catch(i){console.log("local storage denied"),s=!1,this.canStore=!1}if(s)try{t.setItem(a,"1"),t.removeItem(a),this.canStore=!0}catch(r){this.canStore=!1}this.clearData(),this.setInitialData(),0==this.getSeason()&&0==this.getRound()&&this.setRank(500),0==this.getCareerGames()&&this.setCareerGames(11),0==this.getCareerSets()&&this.setCareerSets(3)}return e.prototype.clearData=function(){this.aLevelStore=[],this.aLevelStore.push(0),this.aLevelStore.push(0),this.aLevelStore.push(0),this.aLevelStore.push(2),this.aLevelStore.push(0),this.aLevelStore.push(2),this.aLevelStore.push(0),this.aLevelStore.push(0),this.aLevelStore.push(0),this.aLevelStore.push(500),this.aLevelStore.push(11),this.aLevelStore.push(3),this.aLevelStore.push(0),this.aLevelStore.push(0);for(var e=0;e<42;e++)this.aLevelStore.push(0);for(var e=0;e<this.batCount;e++)0==e?this.aLevelStore.push(2):e<3?this.aLevelStore.push(1):this.aLevelStore.push(0);for(var e=0;e<16;e++)this.aLevelStore.push(0)},e.prototype.resetData=function(){this.clearData(),this.saveData()},e.prototype.setInitialData=function(){if(this.canStore&&"undefined"!=typeof Storage){if(null!=localStorage.getItem(this.saveDataId)&&""!=localStorage.getItem(this.saveDataId))for(var e in this.aLevelStore=localStorage.getItem(this.saveDataId).split(","),this.aLevelStore)this.aLevelStore[e]=parseInt(this.aLevelStore[e]);else this.saveData()}},e.prototype.setAudioState=function(e){this.aLevelStore[12]=e,this.saveData()},e.prototype.getAudioState=function(){return this.aLevelStore[12]},e.prototype.addPvpWins=function(){this.aLevelStore[13]++,this.saveData()},e.prototype.getPvpWins=function(){return this.aLevelStore[13]},e.prototype.setCareerGames=function(e){this.aLevelStore[10]=e,this.saveData()},e.prototype.getCareerGames=function(){return this.aLevelStore[10]},e.prototype.setCareerSets=function(e){this.aLevelStore[11]=e,this.saveData()},e.prototype.getCareerSets=function(){return this.aLevelStore[11]},e.prototype.setSensitveLevel=function(e){this.aLevelStore[5]=e,this.saveData()},e.prototype.getSensitveLevel=function(){return this.aLevelStore[5]},e.prototype.getAwardState=function(e){return this.aLevelStore[this.addedIndex+this.batCount+e]},e.prototype.setAward=function(e){this.aLevelStore[this.addedIndex+this.batCount+e]=1,this.saveData()},e.prototype.getSeason=function(){return this.aLevelStore[7]},e.prototype.setSeason=function(e){this.aLevelStore[7]=e,this.saveData()},e.prototype.getRound=function(){return this.aLevelStore[8]},e.prototype.setRound=function(e){this.aLevelStore[8]=e,this.saveData()},e.prototype.getRank=function(){return this.aLevelStore[9]},e.prototype.setRank=function(e){this.aLevelStore[9]=e,this.saveData()},e.prototype.getDifficultyLevel=function(){return this.aLevelStore[3]},e.prototype.setDifficultyLevel=function(e){this.aLevelStore[3]=e,this.saveData()},e.prototype.getBestBugScore=function(){return this.aLevelStore[6]},e.prototype.setBestBugScore=function(e){e>this.aLevelStore[6]&&(this.aLevelStore[6]=e,this.saveData())},e.prototype.getBestTargetScore=function(){return this.aLevelStore[2]},e.prototype.setBestTargetScore=function(e){e>this.aLevelStore[2]&&(this.aLevelStore[2]=e,this.saveData())},e.prototype.addGems=function(e){this.aLevelStore[0]+=e,this.saveData()},e.prototype.getGems=function(){return this.aLevelStore[0]},e.prototype.addClassicWins=function(){this.aLevelStore[4]++,this.saveData()},e.prototype.getClassicWins=function(){return this.aLevelStore[4]},e.prototype.setLevel=function(e){this.aLevelStore[1]=e,this.saveData()},e.prototype.getLevel=function(){return this.aLevelStore[1]},e.prototype.unlockBat=function(e){this.aLevelStore[e+this.addedIndex]=1,this.saveData()},e.prototype.getBatUnlockState=function(e){return this.aLevelStore[e+this.addedIndex]},e.prototype.getTotalBatsUnlocked=function(){for(var e=0,t=0;t<this.batCount;t++)this.aLevelStore[t+this.addedIndex]>0&&e++;return e},e.prototype.selectBat=function(e){for(var t=0;t<this.batCount;t++)if(2==this.aLevelStore[t+this.addedIndex]){this.aLevelStore[t+this.addedIndex]=1;break}this.aLevelStore[e+this.addedIndex]=2,this.saveData()},e.prototype.getCurBat=function(){for(var e=0,t=0;t<this.batCount;t++)if(2==this.aLevelStore[t+this.addedIndex]){e=t;break}return e},e.prototype.saveData=function(){if(this.canStore&&"undefined"!=typeof Storage){for(var e="",t=0;t<this.aLevelStore.length;t++)e+=this.aLevelStore[t],t<this.aLevelStore.length-1&&(e+=",");localStorage.setItem(this.saveDataId,e)}},e}();e.SaveDataHandler=t}(Utils||(Utils={})),function(e){var t=function(){function e(e,t,a,s,i,r,o,n,l){var m=this;void 0===r&&(r=10),void 0===o&&(o=1),void 0===n&&(n=0),void 0===l&&(l=null),this.effectType=1,this.inc=0,this.col="#FFFFFF",this.removeMe=!1,this.scale=-a/2,this.fixedScale=a,this.angle=i,this.x=e-n*Math.cos(i),this.y=t-n*Math.sin(i),this.lineLength=1.5*r,null!=l&&(this.col=l);var h=o+Math.random()*o;TweenLite.to(this,h,{scale:a,x:this.x-s*Math.cos(i),y:this.y-s*Math.sin(i),ease:"Cubic.easeOut",onComplete:function(){m.removeMe=!0}})}return e.prototype.update=function(){},e.prototype.render=function(){ctx.strokeStyle=this.col,ctx.lineWidth=(this.fixedScale-Math.abs(this.scale))*10,ctx.lineCap="round",ctx.beginPath(),ctx.moveTo(this.x,this.y),ctx.lineTo(this.x-this.lineLength*(this.fixedScale-Math.abs(this.scale))*Math.cos(this.angle),this.y-this.lineLength*(this.fixedScale-Math.abs(this.scale))*Math.sin(this.angle)),ctx.stroke()},e}();e.Particle=t}(Elements||(Elements={})),function(e){var t=function(){function e(e,t,a,s){var i=this;void 0===a&&(a=0),void 0===s&&(s=1),this.x=0,this.y=0,this.fallY=0,this.incY=0,this.removeMe=!1,this.incYRate=-1e3*Math.random(),this.aColours=["#FF3AE7","#00DAFF","#00FF25","#FFEE00","#FF9A00"],this.scale=(20*Math.random()+20)*s,this.angle=360*Math.random()*radian,this.rot=360*Math.random()*radian,this.colId=Math.floor(Math.random()*this.aColours.length),this.dist=200*Math.random()+200,this.x=e+75*Math.cos(this.angle),this.y=t+75*Math.sin(this.angle),this.rotRate=20*Math.random()-10,TweenLite.to(this,3+3*Math.random(),{scale:0,x:this.x+this.dist*Math.cos(this.angle),y:this.y+this.dist*Math.sin(this.angle),ease:"Cubic.easeOut",onComplete:function(){i.removeMe=!0}})}return e.prototype.update=function(){this.rot+=delta*this.rotRate,this.incYRate+=500*delta,this.incY+=delta*this.incYRate},e.prototype.render=function(){ctx.strokeStyle=this.aColours[this.colId],ctx.lineWidth=this.scale,ctx.lineCap="butt",ctx.beginPath(),ctx.moveTo(this.x,this.y+this.incY),ctx.lineTo(this.x-2*this.scale*Math.cos(2*this.rot)*Math.sin(this.rot),this.y-2*this.scale*Math.sin(this.rot)*Math.sin(2*this.rot)+this.incY),ctx.stroke()},e}();e.Confetti=t}(Elements||(Elements={})),function(e){var t=function(){function t(){if(this.gapX=180,this.gapY=255,this.posX=-25,this.posY=0,this.cropY=100,this.cornerLength=5,this.touchState=0,this.startTouchY=0,this.targY=0,this.inc=0,this.startMoveY=0,this.glowId=null,this.sideTouched=0,this.barPerc=0,this.blocksX=0,null!=newBatId){var e=Math.max(Math.floor((canvas.width+this.posX-50)/this.gapX),4);this.targY=-(newBatId/e)*this.gapY+canvas.height/2-this.gapY/2}}return t.prototype.glowBut=function(e,t){if(this.glowId=null,t>100&&t<canvas.height-100)for(var a=0;a<aBatData.length;a++)e>aBatData[a].x-this.gapX/2&&e<aBatData[a].x+this.gapX/2&&t>aBatData[a].y-this.gapY/2&&t<aBatData[a].y+this.gapY/2&&(this.glowId=a)},t.prototype.checkClick=function(e,t){for(var a=!1,s=0;s<aBatData.length;s++)e>aBatData[s].x-this.gapX/2&&e<aBatData[s].x+this.gapX/2&&t>aBatData[s].y-this.gapY/2&&t<aBatData[s].y+this.gapY/2&&(1==aBatData[s].unlockId?showRewardAd("batUnlock",s):0==aBatData[s].unlockId?(playSound("selectBat",.3),saveDataHandler.selectBat(s),curBat=saveDataHandler.getCurBat(),updateBatShopData()):2==aBatData[s].unlockId&&gems>=aBatData[s].gemCost?(playSound("buyBat",.5),saveDataHandler.selectBat(s),curBat=saveDataHandler.getCurBat(),saveDataHandler.addGems(-aBatData[s].gemCost),gems=saveDataHandler.getGems(),updateBatShopData(),awardPanel.checkForAward(curLevel),a=!0):playSound("lockedBat",.3));a&&this.batUnlocked()},t.prototype.batUnlocked=function(){for(var t=0;t<200;t++){var a=new e.Confetti(Math.random()*canvas.width,Math.random()*canvas.height);aEffects.push(a)}},t.prototype.renderRect=function(e,t,a,s,i,r){void 0===r&&(r=!1),ctx.strokeStyle="#000000",ctx.fillStyle=i,ctx.lineWidth=5,ctx.beginPath(),ctx.moveTo(e+this.cornerLength,t),ctx.lineTo(e+(a-this.cornerLength),t),ctx.bezierCurveTo(e+a,t,e+a,t,e+a,t+this.cornerLength),ctx.lineTo(e+a,t+(s-this.cornerLength)),ctx.bezierCurveTo(e+a,t+s,e+a,t+s,e+(a-this.cornerLength),t+s),ctx.lineTo(e+this.cornerLength,t+s),ctx.bezierCurveTo(e,t+s,e,t+s,e,t+(s-this.cornerLength)),ctx.lineTo(e,t+this.cornerLength),ctx.bezierCurveTo(e,t,e,t,e+this.cornerLength,t),ctx.closePath(),ctx.fill(),r&&ctx.stroke()},t.prototype.update=function(){this.inc+=delta},t.prototype.render=function(){this.blocksX=Math.max(Math.floor((canvas.width+this.posX-50)/this.gapX),4);var e,t,a=Math.ceil(aBatData.length/this.blocksX)*this.gapY-(canvas.height-200)+30;this.targY=Math.max(Math.min(this.targY,0),-a),this.posY=100+this.gapY/2+this.targY+15,this.barPerc=(canvas.height-200)/(Math.ceil(aBatData.length/this.blocksX)*this.gapY),this.renderRect(canvas.width-40,100,20,canvas.height-200,"rgba(0, 0, 0, .5)"),this.renderRect(canvas.width-40,100-this.targY/a*(canvas.height-200-(canvas.height-200)*this.barPerc),20,(canvas.height-200)*this.barPerc,"#FFFFFF"),ctx.save(),ctx.beginPath(),ctx.moveTo(0,this.cropY),ctx.lineTo(canvas.width,this.cropY),ctx.lineTo(canvas.width,canvas.height-this.cropY),ctx.lineTo(0,canvas.height-this.cropY),ctx.moveTo(0,this.cropY),ctx.closePath(),ctx.clip();for(var s=0;s<aBatData.length;s++){if(aBatData[s].x=canvas.width/2+s%this.blocksX*this.gapX-this.gapX*(this.blocksX/2-.5)+this.posX,aBatData[s].y=this.posY+Math.floor(s/this.blocksX)*this.gapY,ctx.translate(aBatData[s].x,aBatData[s].y),aBatData[s].y>this.cropY-125&&aBatData[s].y<canvas.height-this.cropY+125){if(0==aBatData[s].unlockId?e=1:1==aBatData[s].unlockId?e=3:2==aBatData[s].unlockId?e=gems>=aBatData[s].gemCost?0:2:3==aBatData[s].unlockId&&(e=2),t=getSpriteData(assetLib.getData("uiElements"),"batShopUnderlay"+e),ctx.drawImage(t.img,t.bX,t.bY,t.bWidth,t.bHeight,-t.bWidth/2,-t.bHeight/2,t.bWidth,t.bHeight),null!=this.glowId&&this.glowId==s&&2!=e&&curBat!=s&&(t=getSpriteData(assetLib.getData("uiElements"),"batShopGlow"),ctx.drawImage(t.img,t.bX,t.bY,t.bWidth,t.bHeight,-t.bWidth/2,-t.bHeight/2,t.bWidth,t.bHeight)),ctx.scale(.75,.75),ctx.rotate(20*radian),s<49&&(t=getSpriteData(assetLib.getData("uiElements"),"batDropShadow"),ctx.drawImage(t.img,t.bX,t.bY,t.bWidth,t.bHeight,-t.bWidth/2+3-5,-t.bHeight/2+10,t.bWidth,t.bHeight)),t=getSpriteData(assetLib.getData("gameElements"),"bat"+s),ctx.drawImage(t.img,t.bX,t.bY,t.bWidth,t.bHeight,-t.bWidth/2-10,-t.bHeight/2,t.bWidth,t.bHeight),ctx.rotate(-20*radian),ctx.scale(1/.75,1/.75),t=0==aBatData[s].unlockId?getSpriteData(assetLib.getData("uiElements"),"batShopOverlay1"):0==e||3==e?getSpriteData(assetLib.getData("uiElements"),"batShopOverlay2"):getSpriteData(assetLib.getData("uiElements"),"batShopOverlay0"),ctx.drawImage(t.img,t.bX,t.bY,t.bWidth,t.bHeight,-t.bWidth/2,-t.bHeight/2,t.bWidth,t.bHeight),curBat==s)t=getSpriteData(assetLib.getData("uiElements"),"tick"),ctx.drawImage(t.img,t.bX,t.bY,t.bWidth,t.bHeight,-t.bWidth/2+40,-t.bHeight/2+82,t.bWidth,t.bHeight);else if(1==e&&newBatId==s&&Math.sin(10*this.inc)>0)addText(0,50,165,"center",0,97,"new","#FFFFFF");else if(0!=aBatData[s].unlockId){if((2==aBatData[s].unlockId&&gems<aBatData[s].gemCost||3==aBatData[s].unlockId)&&(t=getSpriteData(assetLib.getData("uiElements"),"batLock"),ctx.drawImage(t.img,t.bX,t.bY,t.bWidth,t.bHeight,-t.bWidth/2,-t.bHeight/2+20,t.bWidth,t.bHeight)),3==e)addText(0,30,165,"center",0,73,"unlock","#FFFFFF"),t=getSpriteData(assetLib.getData("uiElements"),"rewardIcon"),ctx.drawImage(t.img,t.bX,t.bY,t.bWidth,t.bHeight,-t.bWidth/2,-t.bHeight/2+97,t.bWidth,t.bHeight);else if(0==e){addText(0,30,165,"center",0,73,"buy","#FFFFFF"),addDirectText(0,40,110,"left",-24,111,aBatData[s].gemCost,"#FFFFFF"),t=getSpriteData(assetLib.getData("uiElements"),"smallGem");var i=.6;ctx.drawImage(t.img,t.bX,t.bY,t.bWidth,t.bHeight,-t.bWidth/2*i-46,-t.bHeight/2*i+97,t.bWidth*i,t.bHeight*i)}else if(2==aBatData[s].unlockId){addDirectText(0,40,110,"left",-24,96,aBatData[s].gemCost,"#FFFFFF"),t=getSpriteData(assetLib.getData("uiElements"),"smallGem");var i=.6;ctx.drawImage(t.img,t.bX,t.bY,t.bWidth,t.bHeight,-t.bWidth/2*i-46,-t.bHeight/2*i+97-15,t.bWidth*i,t.bHeight*i)}else 2==e&&(addText(0,30,165,"center",0,77,"completeBatShop","#FFFFFF"),addDirectText(0,30,165,"center",0,109,getText("world",0)+" "+aBatData[s].unlockWorld,"#FFFFFF"))}}ctx.translate(-aBatData[s].x,-aBatData[s].y)}ctx.restore(),t=getSpriteData(assetLib.getData("uiElements"),"batShopBorder0"),ctx.drawImage(t.img,t.bX,t.bY,t.bWidth,t.bHeight,0,this.cropY-t.bHeight/2,canvas.width,t.bHeight),t=getSpriteData(assetLib.getData("uiElements"),"batShopBorder1"),ctx.drawImage(t.img,t.bX,t.bY,t.bWidth,t.bHeight,0,canvas.height-this.cropY-t.bHeight/2,canvas.width,t.bHeight)},t}();e.BatShop=t}(Elements||(Elements={})),function(e){var t=function(){function e(){this.y=1,this.id=0,this.inc=0}return e.prototype.checkForAward=function(e){var t=Math.floor(e/levelsPerWorld);1==t&&0==saveDataHandler.getAwardState(0)?(saveDataHandler.setAward(0),awardPanel.showAward(0)):3==t&&0==saveDataHandler.getAwardState(1)?(saveDataHandler.setAward(1),awardPanel.showAward(1)):6==t&&0==saveDataHandler.getAwardState(2)?(saveDataHandler.setAward(2),awardPanel.showAward(2)):10==t&&0==saveDataHandler.getAwardState(3)&&(saveDataHandler.setAward(3),awardPanel.showAward(3)),1==saveDataHandler.getClassicWins()&&0==saveDataHandler.getAwardState(4)?(saveDataHandler.setAward(4),awardPanel.showAward(4)):3==saveDataHandler.getClassicWins()&&0==saveDataHandler.getAwardState(5)?(saveDataHandler.setAward(5),awardPanel.showAward(5)):6==saveDataHandler.getClassicWins()&&0==saveDataHandler.getAwardState(6)&&(saveDataHandler.setAward(6),awardPanel.showAward(6)),saveDataHandler.getTotalBatsUnlocked()>=10&&0==saveDataHandler.getAwardState(7)?(saveDataHandler.setAward(7),awardPanel.showAward(7)):saveDataHandler.getTotalBatsUnlocked()>=25&&0==saveDataHandler.getAwardState(8)?(saveDataHandler.setAward(8),awardPanel.showAward(8)):saveDataHandler.getTotalBatsUnlocked()>=50&&0==saveDataHandler.getAwardState(9)&&(saveDataHandler.setAward(9),awardPanel.showAward(9)),bugScore>=65&&0==saveDataHandler.getAwardState(10)&&(saveDataHandler.setAward(10),awardPanel.showAward(10)),bugScore>=90&&0==saveDataHandler.getAwardState(11)&&(saveDataHandler.setAward(11),awardPanel.showAward(11)),bugScore>=125&&0==saveDataHandler.getAwardState(12)&&(saveDataHandler.setAward(12),awardPanel.showAward(12)),curTargetScore>=25&&0==saveDataHandler.getAwardState(13)&&(saveDataHandler.setAward(13),awardPanel.showAward(13)),curTargetScore>=50&&0==saveDataHandler.getAwardState(14)&&(saveDataHandler.setAward(14),awardPanel.showAward(14)),curTargetScore>=80&&0==saveDataHandler.getAwardState(15)&&(saveDataHandler.setAward(15),awardPanel.showAward(15))},e.prototype.showAward=function(e){var t=this;this.awardTween&&this.awardTween.kill(),playSound("newAward"),this.y=1,this.id=e,this.awardTween=TweenLite.to(this,.5,{y:0,ease:"Cubic.easeOut",onComplete:function(){t.awardTween=TweenLite.to(t,.5,{y:1,delay:2,ease:"Cubic.easeIn",onComplete:function(){}})}})},e.prototype.render=function(){if(this.y<1){this.inc+=delta;var e=getSpriteData(assetLib.getData("awards"),"awardBg"),t=canvas.width-100-e.bWidth/2,a=-200*this.y;ctx.drawImage(e.img,e.bX,e.bY,e.bWidth,e.bHeight,t-e.bWidth/2,a,e.bWidth,e.bHeight),Math.sin(10*this.inc)>0&&addText(0,35,e.bWidth-20,"center",t,a+45,"newAward","#FFFFFF");var e=getSpriteData(assetLib.getData("awards"),"award"+this.id);ctx.drawImage(e.img,e.bX,e.bY,e.bWidth,e.bHeight,t-e.bWidth/2*1,a-e.bHeight/2*1+125,1*e.bWidth,1*e.bHeight);for(var s=getMultiLineTextByChars("awardInfo"+this.id,16,1),i=0;i<s.length;i++)addDirectText(1,25,200,"center",t,a+125+105+25*i,s[i],"#FFFFFF")}},e}();e.AwardPanel=t}(Elements||(Elements={})),function(e){var t=function(){function e(){this.x=0,this.y=0,this.rotation=0,this.scale=1,this.nX=0,this.nY=0,this.nRot=0,this.oGameElementsImgData=assetLib.getData("gameElements")}return e.prototype.setEnemyLevel=function(){},e.prototype.update=function(){this.y=onScreenY+50*tableTop.offsetY-this.nY,this.rotation=this.nRot,this.scale=Math.max(.4+(this.y-onScreenY)/300,.2),this.x=canvas.width/2+200*tableTop.genScale*this.nX*Math.max(1+(this.scale-.285)*8,1)},e.prototype.render=function(){ctx.save(),ctx.translate(this.x+tableTop.offsetX*tableTop.sideMultiplier,this.y),ctx.rotate(this.rotation),ctx.scale(this.scale,this.scale);var e=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+opBat]].x,t=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+opBat]].y,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+opBat]].width,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+opBat]].height;ctx.drawImage(this.oGameElementsImgData.img,e,t,a,s,-a/2,-s/3,a,s),ctx.restore()},e}();e.NetworkBat=t}(Elements||(Elements={})),function(e){var t=function(){function e(e){this.lobbyCode="",this.shareURL="",this.playerNum=-1,this.networkReady=!1,this.connectState=0,this.actionOnCoonect="",this.gameId=e}return e.prototype.createNetwork=function(){var e=this;this.network=new netlib.Network(this.gameId),this.network.on("message",function(e,t,a){networkMessage(a)}),this.network.on("disconnected",function(t){clearTimeout(e.joinTimer),e.connectState=0,e.lobbyCode="",networkMessage("disconnected")}),this.network.on("connected",function(t){console.log("new peer connected: "+t.id),e.peer=t,e.connectState=2,clearTimeout(e.joinTimer),1==e.playerNum&&e.send(!0,"peerConnect")}),this.network.on("lobby",function(t){if(0==e.playerNum){console.log("lobby created: "+t),e.lobbyCode=t;var a={id:e.lobbyCode};window.PokiSDK.shareableURL(a).then(function(t){e.shareURL=t}),addUrlBut()}}),this.network.on("ready",function(){console.log("Network ready"),e.networkReady=!0,"createLobby"==e.actionOnCoonect?e.createLobby():"joinLobby"==e.actionOnCoonect&&e.joinLobby()}),this.network.on("signalingerror",function(t){console.log("signalingerror:",t),clearTimeout(e.joinTimer),e.connectState=0,e.lobbyCode="","lobby-not-found"==t.code||"lobby-is-full"==t.code?networkMessage(t.code):networkMessage("generalError")}),this.network.on("error",function(t){clearTimeout(e.joinTimer),e.connectState=0,e.lobbyCode="",console.log("error:",t)}),this.network.on("rtcerror",function(t){clearTimeout(e.joinTimer),e.connectState=0,e.lobbyCode="",console.log("rtcerror:",t)})},e.prototype.disconnect=function(){console.log("disconnecting"),this.network.close(),this.lobbyCode="",this.playerNum=-1},e.prototype.connect=function(e){void 0===e&&(e=""),this.network&&this.disconnect(),this.actionOnCoonect=e,console.log("creating new network"),this.createNetwork()},e.prototype.createLobby=function(){console.log("createLobby"),this.playerNum=0,this.network.create({codeFormat:"short",public:!0,maxPlayers:2})},e.prototype.joinLobby=function(){var e=this;this.playerNum=1,this.joinTimer=setTimeout(function(){e.connectState=0,e.lobbyCode="",networkMessage("connectError")},1e4),console.log("joining lobby",this.lobbyCode),this.network.join(this.lobbyCode)},e.prototype.send=function(e,t,a){if(void 0===a&&(a=[]),this.peer){for(var s=t,i=0;i<a.length;i++)s+=",",s+=a[i];e?this.network.send("reliable",this.peer.id,s):this.network.send("unreliable",this.peer.id,s)}},e.prototype.shareLobbyCode=function(e){var t=!1;if(void 0!=navigator.clipboard&&navigator.clipboard.writeText(netLib.shareURL).then(function(){t=!0},function(e){console.warn("Clipboard copy error: ",e),t=!1}),!t){t=!0;var a=document.createElement("textArea");a.readOnly=!1,a.contenteditable=!0,a.value=netLib.shareURL,document.body.appendChild(a),a.select(),a.setSelectionRange(0,99999);try{document.execCommand("copy")}catch(s){t=!1,console.warn("Clipboard copy error: "+s)}document.body.removeChild(a)}t?(console.log("Clipboard success: "+netLib.shareURL),e(1)):e(0)},e}();e.NetLib=t}(Elements||(Elements={}));var requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.requestAnimationFrame||function(e){window.setTimeout(e,1e3/60,new Date().getTime())},canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d"),maxWidth=800,minWidth=800,maxHeight=800,minHeight=800,canvasScale=1,div=document.getElementById("canvas-wrapper"),audioType=0,muted=!1,splashTimer=0,isMobile=!1,gameState="loading",aLangs=["EN"],curLang="",isBugBrowser=!1,isIE10=!1,radian=Math.PI/180,ios9FirstTouch=!1,isRotated=!1,saveDataHandler=new Utils.SaveDataHandler("ppgv8"),hasFocus=!0,assetIdInc=0;navigator.userAgent.match(/MSIE\s([\d]+)/)&&(isIE10=!0);var deviceAgent=navigator.userAgent.toLowerCase();(deviceAgent.match(/(iphone|ipod|ipad)/)||deviceAgent.match(/(android)/)||deviceAgent.match(/(iemobile)/)||deviceAgent.match(/iphone/i)||deviceAgent.match(/ipad/i)||deviceAgent.match(/ipod/i)||deviceAgent.match(/blackberry/i)||deviceAgent.match(/bada/i)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)&&(isMobile=!0,deviceAgent.match(/(android)/)&&!/Chrome/.test(navigator.userAgent)&&(isBugBrowser=!0));var userInput=new Utils.UserInput(canvas,isBugBrowser);function visibleResume(){hasFocus||(userInput&&userInput.checkKeyFocus(),"suspended"==Howler.ctx.state&&Howler.ctx.resume(),muted||"pause"==gameState||"splash"==gameState||"loading"==gameState||(Howler.mute(!1),playMusic())),hasFocus=!0}function visiblePause(){hasFocus=!1,Howler.mute(!0),music.pause()}function playMusic(){music.playing()||music.play()}function isStock(){var e=window.navigator.userAgent.match(/Android.*AppleWebKit\/([\d.]+)/);return e&&537>parseFloat(e[1])}resizeCanvas(),window.onresize=function(){setTimeout(function(){resizeCanvas()},1)},window.onpageshow=function(){hasFocus||(userInput&&userInput.checkKeyFocus(),muted||"pause"==gameState||"splash"==gameState||"loading"==gameState||(Howler.mute(!1),playMusic())),hasFocus=!0},window.onpagehide=function(){hasFocus=!1,Howler.mute(!0),music.pause()},window.addEventListener("load",function(){setTimeout(function(){resizeCanvas()},0),window.addEventListener("orientationchange",function(){setTimeout(function(){resizeCanvas()},500),setTimeout(function(){resizeCanvas()},2e3)},!1)});var ua=navigator.userAgent,isSharpStock=/SHL24|SH-01F/i.test(ua)&&isStock(),isXperiaAStock=/SO-04E/i.test(ua)&&isStock(),isFujitsuStock=/F-01F/i.test(ua)&&isStock();isIE10||isSharpStock||isXperiaAStock||isFujitsuStock||void 0===window.AudioContext&&void 0===window.webkitAudioContext&&-1!=navigator.userAgent.indexOf("Android")?audioType=0:(audioType=1,sound=new Howl({src:["audio/sound.mp3"],sprite:{silence:[0,502.87981859410434],arcadeWin:[1500,1564.4444444444448],botThrow:[4e3,234.01360544217732],bounce0:[5500,215.69160997732428],bounce1:[7e3,207.16553287981833],bounce2:[8500,252.51700680272114],bounce3:[1e4,282.63038548752917],bounce4:[11500,212.7891156462578],bounce5:[13e3,232.1995464852602],buyBat:[14500,679.9092970521539],classicGameLose:[16e3,380.22675736961276],classicGameWin:[17500,915.3061224489783],classicMatchLose:[19e3,1253.877551020409],classicMatchWin:[21500,1404.807256235827],click:[24e3,48.934240362811465],gameStart0:[25500,1651.519274376419],gameStart1:[28e3,1216.1451247165544],gem0:[30500,90.3854875283443],gem1:[32e3,93.24263038548963],gem2:[33500,349.97732426303685],gem3:[35e3,208.9795918367372],gem4:[36500,263.21995464852677],gemReward:[38e3,692.5170068027242],gemTweenOut:[39500,1856.530612244896],hit0:[42e3,213.33333333333115],hit1:[43500,213.33333333333115],hit2:[45e3,252.74376417233668],hit3:[46500,211.15646258503062],hit4:[48e3,230.38548752834487],hit5:[49500,261.04308390022624],hitTarget:[51e3,385.9410430839034],lockedBat:[52500,376.5532879818565],loseSet:[54e3,564.5804988662135],loseStar:[55500,320.2721088435396],missTarget:[57e3,377.1428571428572],selectBat:[58500,341.2244897959198],targetGameEnd:[6e4,1141.4058956916122],unlockBat:[62500,280.1587301587318],winSet:[64e3,835.8956916099771],winStar:[65500,674.3764172335602],worldComplete:[67e3,743.015873015878],cheer0:[68500,3428.072562358281],cheer1:[73e3,6597.369614512473],cheer2:[80500,4757.188208616782],cheer3:[86e3,4461.541950113371],cheer4:[91500,3059.2290249433063],cheer5:[96e3,4442.13151927437],hitNet:[101500,1245.170068027207],bugSplat0:[104e3,114.08163265306825],bugSplat1:[105500,155.64625850339553],bugSplat2:[107e3,94.73922902493825],bugSplat3:[108500,168.4807256235814],bugSplat4:[11e4,184.35374149659367]}}),music=new Howl({src:["audio/music.mp3"],volume:0,loop:!0}));var totalScore=0,levelScore=0,levelNum=0,aTutorials=[],oLogoData={},oImageIds={},swipeState=0,aFlags=[{id:0,x:-.51,y:-.136},{id:1,x:-.651,y:-.262},{id:2,x:-.34,y:.216},{id:3,x:.013,y:-.244},{id:4,x:.75,y:-.133},{id:5,x:-.063,y:-.194},{id:6,x:.789,y:.354},{id:7,x:.668,y:-.104},{id:8,x:-.093,y:-.116},{id:9,x:.389,y:.067},{id:10,x:.05,y:-.37},{id:11,x:-.005,y:-.193},{id:12,x:.069,y:-.244},{id:13,x:.028,y:-.121},{id:14,x:-.017,y:-.287},{id:15,x:-.098,y:-.275},{id:16,x:-.041,y:-.241},{id:17,x:-.632,y:.015},{id:18,x:-.014,y:-.35},{id:19,x:.923,y:.466},{id:20,x:.542,y:.145},{id:21,x:-.428,y:.424},{id:22,x:.579,y:.057},{id:23,x:.252,y:-.015},{id:24,x:.076,y:.367},{id:25,x:.508,y:.057},{id:26,x:.476,y:-.106},{id:27,x:.159,y:.167},{id:28,x:.167,y:-.024},{id:29,x:.139,y:-.126},{id:30,x:-.037,y:.101}],spareEnemyCountry="CH",oGameData={cupId:0,gameId:0,userId:null,enemyId:null,userScore:0,enemyScore:0},firstRun=!0,aMapMarkerPos=[[-203,-115],[-150,-31],[-136,98],[20,57],[-36,-109],[50,-72],[101,-16],[170,82],[192,-51],[143,-121]],justWonCup=!1,controlState=0,rallyHits=0,curLevel=0,curBat=0,opBat=0,aTournamentOrder=[],endChatId=0,tournamentSize=6,charLineUp=0,prevCanvasWidth=0,prevCanvasHeight=0,prevScreen="loading",hasAnyBats=!1,hasAnyPerks=!1,userCustomBat=null,userPerk=null,userCustomBatHighlight=null,userPerkHighlight=null,hasEndGameLink=!1,externalUrl="",gameVariation=0,challengeLevel=0,gameplayState=0,gems=0,levelStarTarg=0,curLevelStars=0,onScreenY=0,aPointScores=[10,25],aBatData=[],levelsPerWorld=5,newBatId=null,batUnlockedId=0,butDown=!0,testVar=">",curBallId=0,tableDepth=352.5,tableBackWidth=349.5,ballPosMultiplier=.6,curTargetScore=0,firstRun=!0,localTargetHighscore=0,userScore=0,enemyScore=0,userSets=0,enemySets=0,classicGameLevel=0,num128=1.28,testPrev=0,testCur=0,rewardButHit=!1,maxMusicVol=.5,minMusicVol=.2,batShopButDown=!1,bugScore=0,bugTime=0,bugTimeTarg=60,bugWaveKilled=0,bugWave=0,bugBonusTime=5,rewardGemTotal=0,rankChange=0,firstCareerGame=!0,netLib=new Elements.NetLib("6caab5cb-54d2-4c8f-aefe-0b0847f7cec6"),networkInc=0,opPvpWins=0,pvpGameTime=0;function resetBatShopData(){aBatData=[{unlockId:0,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:0,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:0,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:3,x:0,y:0,gemCost:0,unlockWorld:1},{unlockId:1,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:1,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:3,x:0,y:0,gemCost:0,unlockWorld:2},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:1,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:3,x:0,y:0,gemCost:0,unlockWorld:3},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:1,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:3,x:0,y:0,gemCost:0,unlockWorld:4},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:1,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:3,x:0,y:0,gemCost:0,unlockWorld:5},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:3,x:0,y:0,gemCost:0,unlockWorld:6},{unlockId:1,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:3,x:0,y:0,gemCost:0,unlockWorld:7},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:1,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:3,x:0,y:0,gemCost:0,unlockWorld:8},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:3,x:0,y:0,gemCost:0,unlockWorld:9},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:3,x:0,y:0,gemCost:0,unlockWorld:10},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:9},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0}];for(var e=50,t=50,a=0,s=0;s<aBatData.length;s++)2==aBatData[s].unlockId&&(aBatData[s].gemCost=10*Math.round(e/10),++a%3==0&&(t*=1.25,e+=t))}function loadLang(e){void 0===e&&(e="en"),(curLang=e)&&null!=curLang&&void 0!=curLang||(curLang="en");var t=window.PokiSDK.getURLParam("id");null!=t&&(netLib.lobbyCode=t),loadPreAssets()}function initSplash(){window.PokiSDK.gameLoadingFinished(),"ar"==curLang&&(document.body.style.direction="rtl"),firstRun=!0,gameState="splash",1!=audioType||muted||0!=saveDataHandler.getAudioState()||(playMusic(),hasFocus||music.pause()),resetFromSaveData(),awardPanel=new Elements.AwardPanel,updateBatShopData(),opBat=getEnemyBat(),""==netLib.lobbyCode?initStartScreen():initPvpPrep(),resizeCanvas()}function initPvpPrep(){gameVariation=4,gameState="game",netLib.connectState=1,gameplayState=0,curLevel=saveDataHandler.getLevel(),1==audioType&&music.fade(music.volume(),maxMusicVol,500),background=new Elements.Background;var e=[];aEffects=[],addMuteBut(e),(panel=new Elements.Panel(gameState,e)).startTween(),resetGameElements(),aEffects=[],1!=saveDataHandler.getAudioState()||muted||butEventHandler("mute",null),previousTime=new Date().getTime(),updateGameEvent(),netLib.connect("joinLobby")}function networkMessage(e){if(void 0===e&&(e=""),e&&void 0!=e&&""!=e){var t=e.split(",");switch(t[0]){case"latency":removeAllButs(),gameVariation=0,initStartScreen(),panel.showDisconnect("latency");break;case"rematch":startPvpGame();break;case"acceptPlayer":netLib.send(!0,"opData",[curBat,saveDataHandler.getPvpWins()]),initGame(),background.setRandom(),panel.showPvpStartMessage();break;case"lobby-not-found":removeAllButs(),gameVariation=0,initStartScreen(),panel.showDisconnect("noLobby");break;case"lobby-is-full":removeAllButs(),gameVariation=0,initStartScreen(),panel.showDisconnect("alreadyConnected");break;case"generalError":removeAllButs(),gameVariation=0,initStartScreen(),panel.showDisconnect("disconnected");break;case"connectError":initStartScreen(),panel.showDisconnect("unableToConnect");break;case"disconnected":"game"==gameState&&4==gameVariation&&(removeAllButs(),gameVariation=0,initStartScreen(),panel.showDisconnect("disconnected"));break;case"peerConnect":netLib.send(!0,"acceptPlayer"),startPvpGame();break;case"opData":opBat=parseInt(t[1]),opPvpWins=parseInt(t[2]),opBat==curBat&&(opBat=0==curBat?1:0);break;case"batPos":enemyBat.nX=parseFloat(t[1]),enemyBat.nY=parseFloat(t[2]),enemyBat.nRot=parseFloat(t[3]);break;case"serveBounce":playSound("hit"+Math.floor(6*Math.random())),rallyHits++,aBalls[0].height=parseFloat(t[6]),aBalls[0].tablePosX=parseFloat(t[4]),aBalls[0].tablePosY=1-parseFloat(t[5]),aBalls[0].setBouncePoint({x:parseFloat(t[1]),y:parseFloat(t[2]),speed:parseFloat(t[3]),spin:0});break;case"offSide":aBalls[0].offSide=!0;break;case"hitBounce":playSound("hit"+Math.floor(6*Math.random())),rallyHits++,aBalls[0].offTablePvp=!1,aBalls[0].offTable=!1,aBalls[0].offTableTween&&aBalls[0].offTableTween.kill(),aBalls[0].servingState=2,aBalls[0].bounceNum=0,aBalls[0].lastHit="enemy",aBalls[0].height=parseFloat(t[6]),aBalls[0].tablePosX=parseFloat(t[4]),aBalls[0].tablePosY=1-parseFloat(t[5]),aBalls[0].setBouncePoint({x:parseFloat(t[1]),y:parseFloat(t[2])+.1,speed:parseFloat(t[3]),spin:0});break;case"ballOff":1==parseInt(t[1])?updateScore("user"):updateScore("enemy"),aBalls[0].nextServeChoice();break;case"hitNet":aBalls[0].hasHitNetPvP=!0}}}function removeAllButs(){removeStartButs(),userInput.removeHitArea("backFromCredits"),userInput.removeHitArea("resetData"),userInput.removeHitArea("minusGames"),userInput.removeHitArea("plusGames"),userInput.removeHitArea("minusSets"),userInput.removeHitArea("plusSets"),userInput.removeHitArea("mute"),userInput.removeHitArea("yesFromResetConfirm"),userInput.removeHitArea("noFromResetConfirm"),userInput.removeHitArea("batShopTouch"),userInput.removeHitArea("backFromBatShop"),userInput.removeHitArea("playFromMapScreen"),userInput.removeHitArea("backFromMapScreen"),userInput.removeHitArea("playFromCustomGameEnd"),userInput.removeHitArea("rewardFromCustomGameEnd"),userInput.removeHitArea("batShopFromCustomGameEnd"),userInput.removeHitArea("challengeFromCustomGameEnd"),userInput.removeHitArea("arcadeFromCustomGameEnd"),userInput.removeHitArea("backFromCustomGameEnd"),userInput.removeHitArea("bugGameFromCustomGameEnd"),userInput.removeHitArea("pvpFromCustomGameEnd"),userInput.removeHitArea("playFromLevelComplete"),userInput.removeHitArea("batShopFromLevelComplete"),userInput.removeHitArea("rewardFromLevelComplete"),userInput.removeHitArea("careerFromLevelComplete"),userInput.removeHitArea("challengeFromLevelComplete"),userInput.removeHitArea("backFromLevelComplete"),userInput.removeHitArea("bugGameFromLevelComplete"),userInput.removeHitArea("pvpFromLevelComplete"),userInput.removeHitArea("playFromWorldComplete"),userInput.removeHitArea("batShopFromWorldComplete"),userInput.removeHitArea("careerFromWorldComplete"),userInput.removeHitArea("challengeFromWorldComplete"),userInput.removeHitArea("backFromWorldComplete"),userInput.removeHitArea("bugGameFromWorldComplete"),userInput.removeHitArea("pvpFromWorldComplete"),userInput.removeHitArea("playFromTargetGameEnd"),userInput.removeHitArea("batShopFromTargetGameEnd"),userInput.removeHitArea("careerFromTargetGameEnd"),userInput.removeHitArea("arcadeFromTargetGameEnd"),userInput.removeHitArea("awardsFromTargetGameEnd"),userInput.removeHitArea("rewardFromTargetGameEnd"),userInput.removeHitArea("backFromTargetGameEnd"),userInput.removeHitArea("bugGameFromTargetGameEnd"),userInput.removeHitArea("pvpFromTargetGameEnd"),userInput.removeHitArea("playFromBugGameEnd"),userInput.removeHitArea("batShopFromBugGameEnd"),userInput.removeHitArea("careerFromBugGameEnd"),userInput.removeHitArea("arcadeFromBugGameEnd"),userInput.removeHitArea("awardsFromBugGameEnd"),userInput.removeHitArea("rewardFromBugGameEnd"),userInput.removeHitArea("backFromBugGameEnd"),userInput.removeHitArea("challengeFromBugGameEnd"),userInput.removeHitArea("pvpFromBugGameEnd"),userInput.removeHitArea("pause"),userInput.removeHitArea("gameTouch"),userInput.removeKey("keyPauseOn"),userInput.removeHitArea("playFromPvpGameEnd"),userInput.removeHitArea("backFromPvpGameEnd"),userInput.removeHitArea("quitFromPause"),userInput.removeHitArea("continueFromPause"),userInput.removeHitArea("backFromNetwork"),userInput.removeHitArea("urlFromNetwork"),userInput.removeHitArea("urlAreaFromNetwork")}function startPvpGame(){removeAllButs(),gameVariation=4,gameplayState=1,userScore=enemyScore=0,resetGameElements(),netLib.send(!0,"opData",[curBat,saveDataHandler.getPvpWins()]),resumeGame(),background.setRandom(),panel.showPvpStartMessage()}function resetFromSaveData(){curBat=saveDataHandler.getCurBat(),curLevel=saveDataHandler.getLevel(),gems=saveDataHandler.getGems(),userInput.sensitiveLevel=saveDataHandler.getSensitveLevel(),classicGameLevel=saveDataHandler.getDifficultyLevel()}function addMuteBut(e){if(1==audioType){var t=oImageIds.muteBut0,a=oImageIds.muteBut0Over;muted&&(t=oImageIds.muteBut1,a=oImageIds.muteBut1Over);var s={oImgData:assetLib.getData("uiButs"),aPos:[-50,50],align:[1,0],id:t,idOver:a,noTween:!0};userInput.addHitArea("mute",butEventHandler,null,"image",s);for(var i=0;i<e.length;i++)if(e[i].id==oImageIds.muteBut0||e[i].id==oImageIds.muteBut1)return;e.push(s)}}function initCreditsScreen(){gameState="credits";var e={oImgData:assetLib.getData("uiButs"),aPos:[50,-50],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver},t={oImgData:assetLib.getData("uiButs"),aPos:[-50,-50],align:[1,1],id:oImageIds.resetBut,idOver:oImageIds.resetButOver};userInput.addHitArea("backFromCredits",butEventHandler,null,"image",e),userInput.addHitArea("resetData",butEventHandler,null,"image",t);var a=[e,t];addMuteBut(a),panel=new Elements.Panel(gameState,a),updateSettingsButs(),panel.startTween(),previousTime=new Date().getTime(),resizeCanvas(),updateCreditsScreenEvent()}function initResetConfirmScreen(){gameState="resetConfirm";var e={oImgData:assetLib.getData("uiButs"),aPos:[-100,90],align:[.5,.5],id:oImageIds.tickBut,idOver:oImageIds.tickButOver},t={oImgData:assetLib.getData("uiButs"),aPos:[100,90],align:[.5,.5],id:oImageIds.quitBut,idOver:oImageIds.quitButOver};userInput.addHitArea("yesFromResetConfirm",butEventHandler,null,"image",e),userInput.addHitArea("noFromResetConfirm",butEventHandler,null,"image",t);var a=[e,t];addMuteBut(a),(panel=new Elements.Panel(gameState,a)).startTween(),previousTime=new Date().getTime(),updateResetConfirmEvent()}function updateSettingsButs(){userInput.removeHitArea("minusGames"),userInput.removeHitArea("plusGames"),panel.removeBut(oImageIds.minusBut),panel.removeBut(oImageIds.plusBut),userInput.removeHitArea("minusSets"),userInput.removeHitArea("plusSets");var e={oImgData:assetLib.getData("uiButs"),aPos:[-100,54],align:[.5,.3],id:oImageIds.minusBut,idOver:oImageIds.minusButOver},t={oImgData:assetLib.getData("uiButs"),aPos:[100,54],align:[.5,.3],id:oImageIds.plusBut,idOver:oImageIds.plusButOver};userInput.addHitArea("minusGames",butEventHandler,null,"image",e),userInput.addHitArea("plusGames",butEventHandler,null,"image",t),panel.aButs.push(e,t);var a={oImgData:assetLib.getData("uiButs"),aPos:[-100,224],align:[.5,.3],id:oImageIds.minusBut,idOver:oImageIds.minusButOver},s={oImgData:assetLib.getData("uiButs"),aPos:[100,224],align:[.5,.3],id:oImageIds.plusBut,idOver:oImageIds.plusButOver};userInput.addHitArea("minusSets",butEventHandler,null,"image",a),userInput.addHitArea("plusSets",butEventHandler,null,"image",s),panel.aButs.push(a,s)}function initStartScreen(e){void 0===e&&(e=!0),"game"==gameState?e=!1:gameState="game",gameVariation=0,gameplayState=0,curLevel=saveDataHandler.getLevel(),1==audioType&&music.fade(music.volume(),maxMusicVol,500),background=new Elements.Background;var t=[];aEffects=[],addMuteBut(t),(panel=new Elements.Panel(gameState,t)).startTween(),updateStartScreenButs(),resetGameElements(),aEffects=[],1!=saveDataHandler.getAudioState()||muted||butEventHandler("mute",null),e&&(previousTime=new Date().getTime(),updateGameEvent())}function removeStartButs(){userInput.removeHitArea("startTouch"),userInput.removeHitArea("infoFromStart"),userInput.removeHitArea("awardsFromStart"),userInput.removeHitArea("batShopFromStart"),userInput.removeHitArea("customMatchFromStart"),userInput.removeHitArea("challengeFromStart"),userInput.removeHitArea("bugGameFromStart"),userInput.removeHitArea("careerFromStart"),userInput.removeHitArea("pvpFromStart"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.infoBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),panel.removeBut(oImageIds.pvpGameBut)}function updateStartScreenButs(){removeStartButs(),batShopButDown=!1;var e,t,a,s,i,r,o={oImgData:assetLib.getData("uiButs"),aPos:[-140,50],align:[1,0],id:oImageIds.infoBut,idOver:oImageIds.infoButOver};userInput.addHitArea("infoFromStart",butEventHandler,null,"image",o),panel.aButs.push(o),canvas.width/canvas.height<.6?(saveDataHandler.getLevel()>0?(e={oImgData:assetLib.getData("uiButs"),aPos:[160,-250],align:[.5,1],id:oImageIds.awardsBut,idOver:oImageIds.awardsButOver},t={oImgData:assetLib.getData("uiButs"),aPos:[320,-250],align:[.5,1],id:oImageIds.batShopBut,idOver:oImageIds.batShopButOver},a={oImgData:assetLib.getData("uiButs"),aPos:[-160,-250],align:[.5,1],id:oImageIds.challengeBut,idOver:oImageIds.challengeButOver},i={oImgData:assetLib.getData("uiButs"),aPos:[0,-250],align:[.5,1],id:oImageIds.careerBut,idOver:oImageIds.careerButOver},s={oImgData:assetLib.getData("uiButs"),aPos:[-320,-250],align:[.5,1],id:oImageIds.bugGameBut,idOver:oImageIds.bugGameButOver},r={oImgData:assetLib.getData("uiButs"),aPos:[320,-430],align:[.5,1],id:oImageIds.pvpGameBut,idOver:oImageIds.pvpGameButOver,flash:!0}):r={oImgData:assetLib.getData("uiButs"),aPos:[320,-250],align:[.5,1],id:oImageIds.pvpGameBut,idOver:oImageIds.pvpGameButOver,flash:!0},userInput.addHitArea("startTouch",butEventHandler,null,"rect",{aRect:[250,300,canvas.width-250,canvas.height-350]},!0)):(saveDataHandler.getLevel()>0?(e={oImgData:assetLib.getData("uiButs"),aPos:[-90,-390],align:[1,1],id:oImageIds.awardsBut,idOver:oImageIds.awardsButOver},t={oImgData:assetLib.getData("uiButs"),aPos:[-90,-210],align:[1,1],id:oImageIds.batShopBut,idOver:oImageIds.batShopButOver},a={oImgData:assetLib.getData("uiButs"),aPos:[90,-390],align:[0,1],id:oImageIds.challengeBut,idOver:oImageIds.challengeButOver},i={oImgData:assetLib.getData("uiButs"),aPos:[90,-210],align:[0,1],id:oImageIds.careerBut,idOver:oImageIds.careerButOver},s={oImgData:assetLib.getData("uiButs"),aPos:[90,-570],align:[0,1],id:oImageIds.bugGameBut,idOver:oImageIds.bugGameButOver},r={oImgData:assetLib.getData("uiButs"),aPos:[-90,-570],align:[1,1],id:oImageIds.pvpGameBut,idOver:oImageIds.pvpGameButOver,flash:!0}):r={oImgData:assetLib.getData("uiButs"),aPos:[-90,-210],align:[1,1],id:oImageIds.pvpGameBut,idOver:oImageIds.pvpGameButOver,flash:!0},userInput.addHitArea("startTouch",butEventHandler,null,"rect",{aRect:[250,300,canvas.width-250,canvas.height-100]},!0)),saveDataHandler.getLevel()>0?(userInput.addHitArea("awardsFromStart",butEventHandler,null,"image",e),userInput.addHitArea("batShopFromStart",butEventHandler,{multiTouch:!0},"image",t),userInput.addHitArea("challengeFromStart",butEventHandler,null,"image",a),userInput.addHitArea("careerFromStart",butEventHandler,null,"image",i),userInput.addHitArea("bugGameFromStart",butEventHandler,null,"image",s),userInput.addHitArea("pvpFromStart",butEventHandler,null,"image",r),panel.aButs.push(t,a,e,s,i,r)):(userInput.addHitArea("pvpFromStart",butEventHandler,null,"image",r),panel.aButs.push(r))}function resetGameElements(){if(tableTop=new Elements.TableTop,userBat=new Elements.UserBat,4==gameVariation?(enemyBat=new Elements.NetworkBat,pvpGameTime=0):enemyBat=new Elements.EnemyBat,4==gameVariation&&1==netLib.playerNum){aBalls=[];var e=new Elements.Ball("enemy");aBalls.push(e)}else{aBalls=[];var e=new Elements.Ball;aBalls.push(e)}background.setRandom(),tableTop.setTableCol()}function updateBatShopData(){resetBatShopData();for(var e=0;e<aBatData.length;e++)saveDataHandler.getBatUnlockState(e)>0&&(aBatData[e].unlockId=0)}function initBatShop(){gameState="batShop",updateBatShopData(),butDown=!1;var e=[];aEffects=[],addMuteBut(e),batShop=new Elements.BatShop,panel=new Elements.Panel(gameState,e),initBatShopButs(),panel.startTween(),aEffects=[],previousTime=new Date().getTime(),updateBatShopEvent()}function initMapScreen(){gameState="mapScreen";var e=[];aEffects=[],addMuteBut(e),aSeasonFlags=getSeasonFlags(saveDataHandler.getSeason()),saveDataHandler.getSeason(),saveDataHandler.getRound(),opBat=getEnemyBat(),aSeasonFlagsRender=[];for(var t=0;t<aSeasonFlags.length;t++)aSeasonFlagsRender.push({aSeasonFlagsIndex:t,y:aFlags[aSeasonFlags[t].id].y});aSeasonFlagsRender=sortBy(aSeasonFlagsRender,"y"),(panel=new Elements.Panel(gameState,e)).startTween(),panel.mapIntro(),aEffects=[],previousTime=new Date().getTime(),updateMapScreenEvent()}function addMapButs(){var e={oImgData:assetLib.getData("uiButs"),aPos:[0,50],align:[.5,.7],id:oImageIds.playBut,idOver:oImageIds.playButOver,flash:!0};userInput.addHitArea("playFromMapScreen",butEventHandler,null,"image",e),panel.aButs.push(e);var t={oImgData:assetLib.getData("uiButs"),aPos:[50,-50],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver};userInput.addHitArea("backFromMapScreen",butEventHandler,null,"image",t),panel.aButs.push(t)}function initBatShopButs(){var e={oImgData:assetLib.getData("uiButs"),aPos:[50,-50],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver};userInput.addHitArea("backFromBatShop",butEventHandler,null,"image",e),panel.aButs.push(e),userInput.addHitArea("batShopTouch",butEventHandler,{isDraggable:!0,multiTouch:!0},"rect",{aRect:[0,0,canvas.width,canvas.height]},!0)}function getEnemyBat(){if(0==curLevel||firstRun)return firstRun=!1,1;for(var e=Math.floor(Math.random()*aBatData.length);0!=aBatData[e].unlockWorld||e==curBat;)e=Math.floor(Math.random()*aBatData.length);return e}function showAd(e){window.PokiSDK.commercialBreak(function(){muted||(Howler.mute(!0),music.pause()),userInput.pointerLockOff()}).then(function(){console.log("Commercial break finished, proceeding to game"),userInput.pointerLockOn(),muted||(Howler.mute(!1),playMusic()),e()})}function showRewardAd(e,t){void 0===t&&(t=null),window.PokiSDK.rewardedBreak(function(){muted||(Howler.mute(!0),music.pause()),userInput.pointerLockOff()}).then(function(a){userInput.pointerLockOn(),muted||(Howler.mute(!1),playMusic()),rewardAdSuccess(e,a,t),console.log("Rewarded break finished, proceeding to game")})}function rewardAdSuccess(e,t,a){switch(void 0===a&&(a=null),e){case"customGameEnd":t&&addRewardGems(rewardGemTotal),initCustomGameEndButs();break;case"levelComplete":t&&addRewardGems(rewardGemTotal),initLevelCompleteButs();break;case"targetGameEnd":t&&addRewardGems(rewardGemTotal),initTargetGameEndButs();break;case"bugGameEnd":t&&addRewardGems(rewardGemTotal),initBugGameEndButs();break;case"batUnlock":userInput.removeHitArea("backFromBatShop"),userInput.removeHitArea("batShopTouch"),panel.removeBut(oImageIds.backBut),t&&(playSound("unlockBat",.5),saveDataHandler.unlockBat(a),saveDataHandler.selectBat(a),curBat=saveDataHandler.getCurBat(),updateBatShopData(),awardPanel.checkForAward(curLevel),batShop.batUnlocked()),initBatShopButs()}}function initPvpGame(){gameState="network";var e={oImgData:assetLib.getData("uiButs"),aPos:[50,-50],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver};userInput.addHitArea("backFromNetwork",butEventHandler,null,"image",e);var t=Array(e);addMuteBut(t),(panel=new Elements.Panel(gameState,t)).startTween(),netLib.connect("createLobby"),previousTime=new Date().getTime(),resizeCanvas(),updateNetworkScreenEvent()}function addUrlBut(){panel.linkTextId=0,panel.shareButOn=!0,userInput.addHitArea("urlAreaFromNetwork",butEventHandler,null,"rect",{aRect:[200,200,canvas.width-200,canvas.height-200]},!0);var e={oImgData:assetLib.getData("uiButs"),aPos:[0,230],align:[.5,.5],id:oImageIds.shareBut,idOver:oImageIds.shareButOver,flash:!0};userInput.addHitArea("urlFromNetwork",butEventHandler,null,"image",e),panel.aButs.push(e)}function initGame(){window.PokiSDK.gameplayStart(),1==audioType&&setTimeout(function(){music.fade(music.volume(),minMusicVol,500)},500),levelStarTarg=2+Math.min(Math.floor((curLevel=saveDataHandler.getLevel())/levelsPerWorld),3),curLevelStars=0,1==gameVariation?localTargetHighscore=saveDataHandler.getBestTargetScore():3==gameVariation&&(localTargetHighscore=saveDataHandler.getBestBugScore()),rewardButHit=!1,isMobile&&userInput.addHitArea("gameTouch",butEventHandler,{isDraggable:!0,multiTouch:!0},"rect",{aRect:[0,100,canvas.width,canvas.height]},!0);var e={oImgData:assetLib.getData("uiButs"),aPos:[-140,50],align:[1,0],id:oImageIds.pauseBut,idOver:oImageIds.pauseButOver};if(userInput.addHitArea("pause",butEventHandler,null,"image",e),panel.aButs.push(e),panel.startGameTween(),gameplayState=1,resetGameElements(),1==gameVariation){playSound("gameStart1",.6),curTargetScore=0,tableTop.setTarget(),userBat.x=userBat.prevX=userBat.startX=canvas.width/2,userBat.y=userBat.prevY=userBat.startY=onScreenY+355,userBat.rotation=userBat.startRotation=0,aBalls=[];var t=new Elements.Ball("enemy");aBalls.push(t),setTimeout(function(){aBalls[0].enemyServe()},1e3),tableTop.startBot()}else if(3==gameVariation)bugScore=0,bugTime=0,bugWaveKilled=0,bugWave=0,playSound("gameStart1",.6),curTargetScore=0,tableTop.setZombieStart();else if(4==gameVariation){if(playSound("gameStart0"),1==netLib.playerNum){aBalls=[];var t=new Elements.Ball("enemy");aBalls.push(t)}}else playSound("gameStart0");4!=gameVariation&&setTimeout(function(){userInput.addKey("keyPauseOn",butEventHandler,null,80),userInput.addKey("keyPauseOn",butEventHandler,null,27),userInput.addKey("keyPauseOn",butEventHandler,null,32)},500),userScore=enemyScore=userSets=enemySets=0}function initPause(){gameState="pause",window.PokiSDK.gameplayStop();var e={oImgData:assetLib.getData("uiButs"),aPos:[0,-110],align:[.5,.5],id:oImageIds.continueBut,idOver:oImageIds.continueButOver},t={oImgData:assetLib.getData("uiButs"),aPos:[0,110],align:[.5,.5],id:oImageIds.quitBut,idOver:oImageIds.quitButOver};userInput.addHitArea("continueFromPause",butEventHandler,null,"image",e),userInput.addHitArea("quitFromPause",butEventHandler,{isDraggable:!0,multiTouch:!0},"image",t),setTimeout(function(){userInput.addKey("keyPauseOff",butEventHandler,null,80),userInput.addKey("keyPauseOff",butEventHandler,null,27),userInput.addKey("keyPauseOff",butEventHandler,null,32)},500),(panel=new Elements.Panel(gameState,[e,t])).startTween(),previousTime=new Date().getTime(),updatePauseEvent()}function resumeGame(){window.PokiSDK.gameplayStart(),background=new Elements.Background,isMobile&&userInput.addHitArea("gameTouch",butEventHandler,{isDraggable:!0,multiTouch:!0},"rect",{aRect:[0,100,canvas.width,canvas.height]},!0);var e={oImgData:assetLib.getData("uiButs"),aPos:[-140,50],align:[1,0],id:oImageIds.pauseBut,idOver:oImageIds.pauseButOver};userInput.addHitArea("pause",butEventHandler,null,"image",e);var t=Array(e);setTimeout(function(){userInput.addKey("keyPauseOn",butEventHandler,null,80),userInput.addKey("keyPauseOn",butEventHandler,null,27),userInput.addKey("keyPauseOn",butEventHandler,null,32)},500),addMuteBut(t),(panel=new Elements.Panel(gameState,t)).startTween(),"game"!=gameState&&(gameState="game",previousTime=new Date().getTime(),updateGameEvent())}function initTargetGameEnd(){if(window.PokiSDK.gameplayStop(),1==audioType&&music.fade(music.volume(),maxMusicVol,500),userInput.removeHitArea("gameTouch"),userInput.removeHitArea("pause"),panel.removeBut(oImageIds.pauseBut),userInput.removeKey("keyPauseOn"),gameplayState=7,saveDataHandler.setBestTargetScore(curTargetScore),Math.round(curTargetScore/2)>0?saveDataHandler.addGems(Math.round(curTargetScore/2)):setTimeout(function(){initTargetGameEndButs()},1e3),awardPanel.checkForAward(curLevel),curTargetScore>localTargetHighscore)for(var e=0;e<200;e++){var t=new Elements.Confetti(Math.random()*canvas.width,Math.random()*canvas.height);aEffects.push(t)}panel.tweenTargetGameComplete()}function initTargetGameEndButs(){panel.startTween(),gameplayState=8,batShopButDown=!1;var e={oImgData:assetLib.getData("uiButs"),aPos:[0,50],align:[.5,.7],id:oImageIds.playBut,idOver:oImageIds.playButOver,flash:!0};if(userInput.addHitArea("playFromTargetGameEnd",butEventHandler,null,"image",e),panel.aButs.push(e),Math.round(curTargetScore/2)>0){if(!rewardButHit){t=canvas.height<1.2*canvas.width?.325:.35;var t,a={oImgData:assetLib.getData("uiButs"),aPos:[285,0],align:[.5,t],id:oImageIds.rewardMultiplyBut,idOver:oImageIds.rewardMultiplyButOver,flash:!0};userInput.addHitArea("rewardFromTargetGameEnd",butEventHandler,null,"image",a),panel.aButs.push(a)}}else{var s={oImgData:assetLib.getData("uiButs"),aPos:[-90,-390],align:[1,1],id:oImageIds.awardsBut,idOver:oImageIds.awardsButOver};userInput.addHitArea("awardsFromTargetGameEnd",butEventHandler,null,"image",s),panel.aButs.push(s)}var i={oImgData:assetLib.getData("uiButs"),aPos:[-90,-210],align:[1,1],id:oImageIds.batShopBut,idOver:oImageIds.batShopButOver};userInput.addHitArea("batShopFromTargetGameEnd",butEventHandler,{multiTouch:!0},"image",i),panel.aButs.push(i);var r={oImgData:assetLib.getData("uiButs"),aPos:[90,-390],align:[0,1],id:oImageIds.arcadeBut,idOver:oImageIds.arcadeButOver};userInput.addHitArea("arcadeFromTargetGameEnd",butEventHandler,null,"image",r),panel.aButs.push(r);var o={oImgData:assetLib.getData("uiButs"),aPos:[90,-210],align:[0,1],id:oImageIds.careerBut,idOver:oImageIds.careerButOver};userInput.addHitArea("careerFromTargetGameEnd",butEventHandler,null,"image",o),panel.aButs.push(o);var n={oImgData:assetLib.getData("uiButs"),aPos:[90,-570],align:[0,1],id:oImageIds.bugGameBut,idOver:oImageIds.bugGameButOver};userInput.addHitArea("bugGameFromTargetGameEnd",butEventHandler,null,"image",n),panel.aButs.push(n);var l={oImgData:assetLib.getData("uiButs"),aPos:[-90,-390],align:[1,1],id:oImageIds.pvpGameBut,idOver:oImageIds.pvpGameButOver,flash:!0};userInput.addHitArea("pvpFromTargetGameEnd",butEventHandler,null,"image",l),panel.aButs.push(l);var m={oImgData:assetLib.getData("uiButs"),aPos:[50,-50],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver};userInput.addHitArea("backFromTargetGameEnd",butEventHandler,null,"image",m),panel.aButs.push(m)}function initBugGameEnd(){if(window.PokiSDK.gameplayStop(),1==audioType&&music.fade(music.volume(),maxMusicVol,500),playSound("targetGameEnd"),curTargetScore>50&&playSound("cheer"+Math.floor(6*Math.random())),userInput.removeHitArea("gameTouch"),userInput.removeHitArea("pause"),panel.removeBut(oImageIds.pauseBut),userInput.removeKey("keyPauseOn"),gameplayState=11,saveDataHandler.setBestBugScore(bugScore),Math.ceil(bugScore/4)>0?saveDataHandler.addGems(Math.ceil(bugScore/4)):setTimeout(function(){initBugGameEndButs()},1e3),awardPanel.checkForAward(curLevel),bugScore>localTargetHighscore)for(var e=0;e<200;e++){var t=new Elements.Confetti(Math.random()*canvas.width,Math.random()*canvas.height);aEffects.push(t)}panel.tweenBugGameComplete()}function initBugGameEndButs(){panel.startTween(),gameplayState=12,batShopButDown=!1;var e={oImgData:assetLib.getData("uiButs"),aPos:[0,50],align:[.5,.7],id:oImageIds.playBut,idOver:oImageIds.playButOver,flash:!0};if(userInput.addHitArea("playFromBugGameEnd",butEventHandler,null,"image",e),panel.aButs.push(e),Math.ceil(bugScore/4)>0&&!rewardButHit){t=canvas.height<1.2*canvas.width?.325:.35;var t,a={oImgData:assetLib.getData("uiButs"),aPos:[285,0],align:[.5,t],id:oImageIds.rewardMultiplyBut,idOver:oImageIds.rewardMultiplyButOver,flash:!0};userInput.addHitArea("rewardFromBugGameEnd",butEventHandler,null,"image",a),panel.aButs.push(a)}var s={oImgData:assetLib.getData("uiButs"),aPos:[-90,-210],align:[1,1],id:oImageIds.batShopBut,idOver:oImageIds.batShopButOver};userInput.addHitArea("batShopFromBugGameEnd",butEventHandler,{multiTouch:!0},"image",s),panel.aButs.push(s);var i={oImgData:assetLib.getData("uiButs"),aPos:[90,-390],align:[0,1],id:oImageIds.arcadeBut,idOver:oImageIds.arcadeButOver};userInput.addHitArea("arcadeFromBugGameEnd",butEventHandler,null,"image",i),panel.aButs.push(i);var r={oImgData:assetLib.getData("uiButs"),aPos:[90,-210],align:[0,1],id:oImageIds.careerBut,idOver:oImageIds.careerButOver};userInput.addHitArea("careerFromBugGameEnd",butEventHandler,null,"image",r),panel.aButs.push(r);var o={oImgData:assetLib.getData("uiButs"),aPos:[90,-570],align:[0,1],id:oImageIds.challengeBut,idOver:oImageIds.challengeButOver};userInput.addHitArea("challengeFromBugGameEnd",butEventHandler,null,"image",o),panel.aButs.push(o);var n={oImgData:assetLib.getData("uiButs"),aPos:[-90,-390],align:[1,1],id:oImageIds.pvpGameBut,idOver:oImageIds.pvpGameButOver,flash:!0};userInput.addHitArea("pvpFromBugGameEnd",butEventHandler,null,"image",n),panel.aButs.push(n);var l={oImgData:assetLib.getData("uiButs"),aPos:[50,-50],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver};userInput.addHitArea("backFromBugGameEnd",butEventHandler,null,"image",l),panel.aButs.push(l)}function initGameWon(){gameplayState=2;for(var e=0;e<200;e++){var t=new Elements.Confetti(Math.random()*canvas.width,Math.random()*canvas.height);aEffects.push(t)}userInput.removeHitArea("gameTouch"),userInput.removeHitArea("pause"),userInput.removeKey("keyPauseOn"),panel.removeBut(oImageIds.pauseBut),userBat.levelComplete(),enemyBat.levelComplete()}function prepForCareerMatch(){gameplayState=1,gameVariation=2,gameState="game",background=new Elements.Background;var e=[];aEffects=[],addMuteBut(e),(panel=new Elements.Panel(gameState,e)).startTween(),previousTime=new Date().getTime(),updateGameEvent(),initGame()}function initPvpGameComplete(){window.PokiSDK.gameplayStop(),1==audioType&&music.fade(music.volume(),maxMusicVol,500),userScore>enemyScore&&saveDataHandler.addPvpWins(),userInput.removeHitArea("gameTouch"),userInput.removeHitArea("pause"),panel.removeBut(oImageIds.pauseBut),userInput.removeKey("keyPauseOn"),gameplayState=13,firstCareerGame=!1;for(var e=0;e<200;e++){var t=new Elements.Confetti(Math.random()*canvas.width,Math.random()*canvas.height);aEffects.push(t)}panel.tweenPvpGameComplete()}function initPvpGameEndButs(){panel.startTween(),gameplayState=14,batShopButDown=!1;var e={oImgData:assetLib.getData("uiButs"),aPos:[0,50],align:[.5,.7],id:oImageIds.playBut,idOver:oImageIds.playButOver,flash:!0};userInput.addHitArea("playFromPvpGameEnd",butEventHandler,null,"image",e),panel.aButs.push(e);var t={oImgData:assetLib.getData("uiButs"),aPos:[50,-50],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver};userInput.addHitArea("backFromPvpGameEnd",butEventHandler,null,"image",t),panel.aButs.push(t)}function initCustomGameComplete(){window.PokiSDK.gameplayStop(),1==audioType&&music.fade(music.volume(),maxMusicVol,500),userInput.removeHitArea("gameTouch"),userInput.removeHitArea("pause"),panel.removeBut(oImageIds.pauseBut),userInput.removeKey("keyPauseOn"),gameplayState=9,firstCareerGame=!1;var e=saveDataHandler.getRank()-aSeasonFlags[saveDataHandler.getRound()].rank;saveDataHandler.setRound(saveDataHandler.getRound()+1),saveDataHandler.getRound()>=6&&(saveDataHandler.setSeason(saveDataHandler.getSeason()+1),saveDataHandler.setRound(0)),userSets>enemySets?(saveDataHandler.addGems(50+10*saveDataHandler.getSeason()+saveDataHandler.getRound()),saveDataHandler.addClassicWins(),rankChange=Math.ceil(Math.min(Math.max(e/2,5),25))):(saveDataHandler.addGems(25),rankChange=Math.round(Math.min(Math.max(-e/2,-25),-5))),saveDataHandler.setRank(Math.max(saveDataHandler.getRank()-rankChange,1)),awardPanel.checkForAward(curLevel);for(var t=0;t<200;t++){var a=new Elements.Confetti(Math.random()*canvas.width,Math.random()*canvas.height);aEffects.push(a)}panel.tweenCustomGameComplete()}function initCustomGameEndButs(){panel.startTween(),gameplayState=10,batShopButDown=!1;var e={oImgData:assetLib.getData("uiButs"),aPos:[0,50],align:[.5,.7],id:oImageIds.playBut,idOver:oImageIds.playButOver,flash:!0};if(userInput.addHitArea("playFromCustomGameEnd",butEventHandler,null,"image",e),panel.aButs.push(e),!rewardButHit){var t={oImgData:assetLib.getData("uiButs"),aPos:[285,0],align:[.5,.4],id:oImageIds.rewardMultiplyBut,idOver:oImageIds.rewardMultiplyButOver,flash:!0};userInput.addHitArea("rewardFromCustomGameEnd",butEventHandler,null,"image",t),panel.aButs.push(t)}var a={oImgData:assetLib.getData("uiButs"),aPos:[-90,-210],align:[1,1],id:oImageIds.batShopBut,idOver:oImageIds.batShopButOver};userInput.addHitArea("batShopFromCustomGameEnd",butEventHandler,{multiTouch:!0},"image",a),panel.aButs.push(a);var s={oImgData:assetLib.getData("uiButs"),aPos:[90,-390],align:[0,1],id:oImageIds.challengeBut,idOver:oImageIds.challengeButOver};userInput.addHitArea("challengeFromCustomGameEnd",butEventHandler,null,"image",s),panel.aButs.push(s);var i={oImgData:assetLib.getData("uiButs"),aPos:[90,-210],align:[0,1],id:oImageIds.arcadeBut,idOver:oImageIds.arcadeButOver};userInput.addHitArea("arcadeFromCustomGameEnd",butEventHandler,null,"image",i),panel.aButs.push(i);var r={oImgData:assetLib.getData("uiButs"),aPos:[90,-570],align:[0,1],id:oImageIds.bugGameBut,idOver:oImageIds.bugGameButOver};userInput.addHitArea("bugGameFromCustomGameEnd",butEventHandler,null,"image",r),panel.aButs.push(r);var o={oImgData:assetLib.getData("uiButs"),aPos:[50,-50],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver};userInput.addHitArea("backFromCustomGameEnd",butEventHandler,null,"image",o),panel.aButs.push(o);var n={oImgData:assetLib.getData("uiButs"),aPos:[-90,-390],align:[1,1],id:oImageIds.pvpGameBut,idOver:oImageIds.pvpGameButOver,flash:!0};userInput.addHitArea("pvpFromCustomGameEnd",butEventHandler,null,"image",n),panel.aButs.push(n)}function initLevelComplete(){window.PokiSDK.gameplayStop(),navigator.sendBeacon("https://leveldata.poki.io/planes","4ee6d38c-41e3-4c87-a9f8-85f0b2a0df48"),1==audioType&&music.fade(music.volume(),maxMusicVol,500),gameplayState=3,firstCareerGame=!1,panel.tweenLevelComplete(),saveDataHandler.setLevel(curLevel+1),saveDataHandler.addGems(panel.winGemTarg),awardPanel.checkForAward(curLevel+1),anyWorldBatsLeft()&&(curLevel+1)%levelsPerWorld==0&&(newBatId=batUnlockedId,saveDataHandler.unlockBat(batUnlockedId))}function anyWorldBatsLeft(){var e=!1;return curLevel<10*levelsPerWorld&&(e=!0),e}function initWorldComplete(){gameplayState=5,playSound("classicMatchWin",.5),playSound("cheer"+Math.floor(6*Math.random())),panel.tweenWorldComplete(),awardPanel.checkForAward(curLevel+1),setTimeout(function(){playSound("worldComplete",.5),initWorldCompleteButs();for(var e=0;e<200;e++){var t=new Elements.Confetti(Math.random()*canvas.width,Math.random()*canvas.height);aEffects.push(t)}},1500)}function initLevelCompleteButs(){gameplayState=4,panel.startTween(),batShopButDown=!1;var e={oImgData:assetLib.getData("uiButs"),aPos:[0,50],align:[.5,.7],id:oImageIds.playBut,idOver:oImageIds.playButOver,flash:!0};if(userInput.addHitArea("playFromLevelComplete",butEventHandler,null,"image",e),panel.aButs.push(e),!rewardButHit){canvas.height<1.2*canvas.width?(t=.25,a=218):(t=.35,a=158);var t,a,s={oImgData:assetLib.getData("uiButs"),aPos:[285,a],align:[.5,t],id:oImageIds.rewardMultiplyBut,idOver:oImageIds.rewardMultiplyButOver,flash:!0};userInput.addHitArea("rewardFromLevelComplete",butEventHandler,null,"image",s),panel.aButs.push(s)}var i={oImgData:assetLib.getData("uiButs"),aPos:[50,-50],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver};if(userInput.addHitArea("backFromLevelComplete",butEventHandler,null,"image",i),panel.aButs.push(i),anyWorldBatsLeft()&&(curLevel+1)%levelsPerWorld==0);else{var r={oImgData:assetLib.getData("uiButs"),aPos:[-90,-210],align:[1,1],id:oImageIds.batShopBut,idOver:oImageIds.batShopButOver};userInput.addHitArea("batShopFromLevelComplete",butEventHandler,{multiTouch:!0},"image",r),panel.aButs.push(r);var o={oImgData:assetLib.getData("uiButs"),aPos:[90,-390],align:[0,1],id:oImageIds.challengeBut,idOver:oImageIds.challengeButOver};userInput.addHitArea("challengeFromLevelComplete",butEventHandler,null,"image",o),panel.aButs.push(o);var n={oImgData:assetLib.getData("uiButs"),aPos:[90,-210],align:[0,1],id:oImageIds.careerBut,idOver:oImageIds.careerButOver};userInput.addHitArea("careerFromLevelComplete",butEventHandler,null,"image",n),panel.aButs.push(n);var l={oImgData:assetLib.getData("uiButs"),aPos:[90,-570],align:[0,1],id:oImageIds.bugGameBut,idOver:oImageIds.bugGameButOver};userInput.addHitArea("bugGameFromLevelComplete",butEventHandler,null,"image",l),panel.aButs.push(l);var m={oImgData:assetLib.getData("uiButs"),aPos:[-90,-390],align:[1,1],id:oImageIds.pvpGameBut,idOver:oImageIds.pvpGameButOver,flash:!0};userInput.addHitArea("pvpFromLevelComplete",butEventHandler,null,"image",m),panel.aButs.push(m)}}function initWorldCompleteButs(){panel.startTween(),gameplayState=6,batShopButDown=!1;var e={oImgData:assetLib.getData("uiButs"),aPos:[-90,-210],align:[1,1],id:oImageIds.batShopBut,idOver:oImageIds.batShopButOver};userInput.addHitArea("batShopFromWorldComplete",butEventHandler,{multiTouch:!0},"image",e),panel.aButs.push(e);var t={oImgData:assetLib.getData("uiButs"),aPos:[0,50],align:[.5,.7],id:oImageIds.playBut,idOver:oImageIds.playButOver,flash:!0};userInput.addHitArea("playFromWorldComplete",butEventHandler,null,"image",t),panel.aButs.push(t);var a={oImgData:assetLib.getData("uiButs"),aPos:[90,-390],align:[0,1],id:oImageIds.challengeBut,idOver:oImageIds.challengeButOver};userInput.addHitArea("challengeFromWorldComplete",butEventHandler,null,"image",a),panel.aButs.push(a);var s={oImgData:assetLib.getData("uiButs"),aPos:[90,-210],align:[0,1],id:oImageIds.careerBut,idOver:oImageIds.careerButOver};userInput.addHitArea("careerFromWorldComplete",butEventHandler,null,"image",s),panel.aButs.push(s);var i={oImgData:assetLib.getData("uiButs"),aPos:[90,-570],align:[0,1],id:oImageIds.bugGameBut,idOver:oImageIds.bugGameButOver};userInput.addHitArea("bugGameFromWorldComplete",butEventHandler,null,"image",i),panel.aButs.push(i);var r={oImgData:assetLib.getData("uiButs"),aPos:[-90,-390],align:[1,1],id:oImageIds.pvpGameBut,idOver:oImageIds.pvpGameButOver,flash:!0};userInput.addHitArea("pvpFromWorldComplete",butEventHandler,null,"image",r),panel.aButs.push(r);var o={oImgData:assetLib.getData("uiButs"),aPos:[50,-50],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver};userInput.addHitArea("backFromWorldComplete",butEventHandler,null,"image",o),panel.aButs.push(o)}function initNextLevel(){tableTop=new Elements.TableTop,userBat=new Elements.UserBat,enemyBat=new Elements.EnemyBat,aBalls=[];var e=new Elements.Ball;aBalls.push(e),opBat=getEnemyBat(),initGame()}function initAwards(){gameState="awards";var e=[],t={oImgData:assetLib.getData("uiButs"),aPos:[50,-50],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver};userInput.addHitArea("backFromBatShop",butEventHandler,null,"image",t),e.push(t),aEffects=[],addMuteBut(e),(panel=new Elements.Panel(gameState,e)).startTween(),aEffects=[],previousTime=new Date().getTime(),updateAwardsEvent()}function addRewardGems(e){saveDataHandler.addGems(e),gems=saveDataHandler.getGems(),playSound("gemReward");for(var t=360*Math.random()*radian,a=0;a<100;a++){var s=new Elements.Particle(canvas.width-getDirectWidth(0,75,"00")-95+27,canvas.height-80+25,1*Math.random()+1,400*Math.random()+50,t+3.6*a*radian,20,1,50);aEffects.push(s)}rewardButHit=!0}function butEventHandler(e,t){if(!isRotated)switch(e){case"infoFromStart":playSound("click"),removeStartButs(),initCreditsScreen();break;case"resetData":playSound("click"),userInput.removeHitArea("backFromCredits"),userInput.removeHitArea("resetData"),userInput.removeHitArea("minusGames"),userInput.removeHitArea("plusGames"),userInput.removeHitArea("minusSets"),userInput.removeHitArea("plusSets"),userInput.removeHitArea("mute"),initResetConfirmScreen();break;case"yesFromResetConfirm":playSound("loseStar",.5),saveDataHandler.resetData(),updateBatShopData(),resetFromSaveData(),userInput.removeHitArea("yesFromResetConfirm"),userInput.removeHitArea("noFromResetConfirm"),userInput.removeHitArea("mute"),initStartScreen();break;case"noFromResetConfirm":playSound("click"),userInput.removeHitArea("yesFromResetConfirm"),userInput.removeHitArea("noFromResetConfirm"),userInput.removeHitArea("mute"),initCreditsScreen();break;case"backFromCredits":playSound("click"),userInput.removeHitArea("backFromCredits"),userInput.removeHitArea("resetData"),userInput.removeHitArea("minusGames"),userInput.removeHitArea("plusGames"),userInput.removeHitArea("minusSets"),userInput.removeHitArea("plusSets"),userInput.removeHitArea("mute"),initStartScreen();break;case"plusGames":playSound("click"),saveDataHandler.setCareerGames(Math.min(saveDataHandler.getCareerGames()+1,21));break;case"minusGames":playSound("click"),saveDataHandler.setCareerGames(Math.max(saveDataHandler.getCareerGames()-1,8));break;case"plusSets":playSound("click"),saveDataHandler.setCareerSets(Math.min(saveDataHandler.getCareerSets()+1,5));break;case"minusSets":playSound("click"),saveDataHandler.setCareerSets(Math.max(saveDataHandler.getCareerSets()-1,2));break;case"startTouch":playSound("click"),removeStartButs(),gameVariation=0,showAd(initGame),enemyBat.trackBall=!0;break;case"batShopFromStart":t.isDown&&(batShopButDown=!0),t.isUp&&batShopButDown&&(batShopButDown=!1,playSound("click"),removeStartButs(),prevGameplayState=gameplayState,initBatShop());break;case"careerFromStart":playSound("click"),removeStartButs(),initMapScreen();break;case"bugGameFromStart":playSound("click"),removeStartButs(),gameVariation=3,initGame();break;case"pvpFromStart":playSound("click"),removeStartButs(),gameVariation=4,initPvpGame();break;case"urlFromNetwork":case"urlAreaFromNetwork":playSound("click"),netLib.shareLobbyCode(function(e){return panel.clipboardCallback(e)}),userInput.removeHitArea("urlFromNetwork"),panel.removeBut(oImageIds.shareBut);break;case"backFromNetwork":userInput.removeHitArea("backFromNetwork"),userInput.removeHitArea("urlFromNetwork"),userInput.removeHitArea("urlAreaFromNetwork"),initStartScreen();break;case"customMatchFromStart":playSound("click"),removeStartButs(),gameVariation=2,initGame();break;case"challengeFromStart":playSound("click"),removeStartButs(),gameVariation=1,initGame();break;case"awardsFromStart":playSound("click"),removeStartButs(),prevGameplayState=gameplayState,initAwards();break;case"backFromBatShop":playSound("click"),newBatId=null,userInput.removeHitArea("batShopTouch"),userInput.removeHitArea("backFromBatShop"),panel.removeBut(oImageIds.backBut),0==prevGameplayState?initStartScreen():4==prevGameplayState?(gameState="game",panel.aWinGems=[],(curLevel+1)%levelsPerWorld==0?panel.winGemTarg=aPointScores[1]:panel.winGemTarg=aPointScores[0],panel.winGemCount=0,initLevelCompleteButs(),previousTime=new Date().getTime(),updateGameEvent()):6==prevGameplayState?(gameState="game",initWorldCompleteButs(),previousTime=new Date().getTime(),updateGameEvent()):8==prevGameplayState?(gameState="game",panel.aWinGems=[],panel.winGemTarg=Math.round(curTargetScore/2),panel.winGemCount=0,initTargetGameEndButs(),previousTime=new Date().getTime(),updateGameEvent()):10==prevGameplayState?(gameState="game",panel.aWinGems=[],userSets>enemySets?panel.winGemTarg=50+10*saveDataHandler.getSeason()+saveDataHandler.getRound():panel.winGemTarg=25,panel.winGemCount=0,initCustomGameEndButs(),previousTime=new Date().getTime(),updateGameEvent()):12==prevGameplayState&&(gameState="game",panel.aWinGems=[],panel.winGemTarg=Math.ceil(bugScore/4),panel.winGemCount=0,initBugGameEndButs(),previousTime=new Date().getTime(),updateGameEvent());break;case"batShopTouch":t.y>100&&t.y<canvas.height-100&&(t.isDown&&!t.isBeingDragged?(batShop.startMoveY=batShop.targY,batShop.checkMoveY=0,t.x<canvas.width/2+(batShop.blocksX-1)*batShop.gapX-batShop.gapX*(batShop.blocksX/2-1)+batShop.posX?(batShop.sideTouched=0,batShop.startTouchY=t.y-batShop.targY):(batShop.sideTouched=1,batShop.startTouchY=t.y+batShop.targY/(1/batShop.barPerc)),butDown=!0):t.isBeingDragged?0==batShop.sideTouched?(batShop.targY=t.y-batShop.startTouchY,batShop.checkMoveY+=Math.abs(batShop.startMoveY-batShop.targY)):1==batShop.sideTouched&&(batShop.targY=-(t.y-batShop.startTouchY)*(1/batShop.barPerc),batShop.checkMoveY+=Math.abs(batShop.startMoveY-batShop.targY)):butDown&&(butDown=!1,(!isMobile&&batShop.checkMoveY<3||isMobile&&batShop.checkMoveY<10)&&batShop.checkClick(t.x,t.y)));break;case"gameTouch":t.isDown&&!t.isBeingDragged?(swipeState=1,startTouchY=t.y-userBat.targY):1==swipeState&&t.isBeingDragged?(userBat.targX=t.x,0==controlState?userBat.targY=t.y:userBat.targY=t.y-startTouchY):1==swipeState&&(swipeState=0);break;case"playFromMapScreen":playSound("click"),userInput.removeHitArea("playFromMapScreen"),userInput.removeHitArea("backFromMapScreen"),firstCareerGame?prepForCareerMatch():showAd(prepForCareerMatch);break;case"backFromMapScreen":playSound("click"),userInput.removeHitArea("playFromMapScreen"),userInput.removeHitArea("backFromMapScreen"),initStartScreen();break;case"playFromPvpGameEnd":playSound("click"),userInput.removeHitArea("playFromPvpGameEnd"),userInput.removeHitArea("backFromPvpGameEnd"),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.backBut),userInput.removeHitArea("pvpFromCustomGameEnd"),panel.removeBut(oImageIds.pvpGameBut),startPvpGame(),netLib.send(!0,"rematch");break;case"backFromPvpGameEnd":playSound("click"),userInput.removeHitArea("playFromPvpGameEnd"),userInput.removeHitArea("backFromPvpGameEnd"),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.backBut),userInput.removeHitArea("pvpFromCustomGameEnd"),panel.removeBut(oImageIds.pvpGameBut),netLib.disconnect(),initStartScreen();break;case"playFromCustomGameEnd":playSound("click"),userInput.removeHitArea("playFromCustomGameEnd"),userInput.removeHitArea("rewardFromCustomGameEnd"),userInput.removeHitArea("batShopFromCustomGameEnd"),userInput.removeHitArea("challengeFromCustomGameEnd"),userInput.removeHitArea("arcadeFromCustomGameEnd"),userInput.removeHitArea("backFromCustomGameEnd"),userInput.removeHitArea("bugGameFromCustomGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.arcadeBut),userInput.removeHitArea("pvpFromCustomGameEnd"),panel.removeBut(oImageIds.pvpGameBut),initMapScreen();break;case"awardsFromCustomGameEnd":playSound("click"),userInput.removeHitArea("playFromCustomGameEnd"),userInput.removeHitArea("rewardFromCustomGameEnd"),userInput.removeHitArea("batShopFromCustomGameEnd"),userInput.removeHitArea("challengeFromCustomGameEnd"),userInput.removeHitArea("arcadeFromCustomGameEnd"),userInput.removeHitArea("backFromCustomGameEnd"),userInput.removeHitArea("bugGameFromCustomGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.arcadeBut),userInput.removeHitArea("pvpFromCustomGameEnd"),panel.removeBut(oImageIds.pvpGameBut),prevGameplayState=gameplayState,initAwards();break;case"batShopFromCustomGameEnd":t.isDown&&(batShopButDown=!0),t.isUp&&batShopButDown&&(batShopButDown=!1,playSound("click"),userInput.removeHitArea("playFromCustomGameEnd"),userInput.removeHitArea("rewardFromCustomGameEnd"),userInput.removeHitArea("batShopFromCustomGameEnd"),userInput.removeHitArea("challengeFromCustomGameEnd"),userInput.removeHitArea("arcadeFromCustomGameEnd"),userInput.removeHitArea("backFromCustomGameEnd"),userInput.removeHitArea("bugGameFromCustomGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.arcadeBut),userInput.removeHitArea("pvpFromCustomGameEnd"),panel.removeBut(oImageIds.pvpGameBut),prevGameplayState=gameplayState,initBatShop());break;case"challengeFromCustomGameEnd":playSound("click"),userInput.removeHitArea("playFromCustomGameEnd"),userInput.removeHitArea("rewardFromCustomGameEnd"),userInput.removeHitArea("batShopFromCustomGameEnd"),userInput.removeHitArea("challengeFromCustomGameEnd"),userInput.removeHitArea("arcadeFromCustomGameEnd"),userInput.removeHitArea("backFromCustomGameEnd"),userInput.removeHitArea("bugGameFromCustomGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.arcadeBut),userInput.removeHitArea("pvpFromCustomGameEnd"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=1,showAd(initGame);break;case"arcadeFromCustomGameEnd":playSound("click"),userInput.removeHitArea("playFromCustomGameEnd"),userInput.removeHitArea("rewardFromCustomGameEnd"),userInput.removeHitArea("batShopFromCustomGameEnd"),userInput.removeHitArea("challengeFromCustomGameEnd"),userInput.removeHitArea("arcadeFromCustomGameEnd"),userInput.removeHitArea("backFromCustomGameEnd"),userInput.removeHitArea("bugGameFromCustomGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.arcadeBut),userInput.removeHitArea("pvpFromCustomGameEnd"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=0,showAd(initGame);break;case"bugGameFromCustomGameEnd":playSound("click"),userInput.removeHitArea("playFromCustomGameEnd"),userInput.removeHitArea("rewardFromCustomGameEnd"),userInput.removeHitArea("batShopFromCustomGameEnd"),userInput.removeHitArea("challengeFromCustomGameEnd"),userInput.removeHitArea("arcadeFromCustomGameEnd"),userInput.removeHitArea("backFromCustomGameEnd"),userInput.removeHitArea("bugGameFromCustomGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.arcadeBut),userInput.removeHitArea("pvpFromCustomGameEnd"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=3,showAd(initGame);break;case"backFromCustomGameEnd":playSound("click"),userInput.removeHitArea("playFromCustomGameEnd"),userInput.removeHitArea("rewardFromCustomGameEnd"),userInput.removeHitArea("batShopFromCustomGameEnd"),userInput.removeHitArea("challengeFromCustomGameEnd"),userInput.removeHitArea("arcadeFromCustomGameEnd"),userInput.removeHitArea("backFromCustomGameEnd"),userInput.removeHitArea("bugGameFromCustomGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.arcadeBut),userInput.removeHitArea("pvpFromCustomGameEnd"),panel.removeBut(oImageIds.pvpGameBut),initStartScreen(!1);break;case"pvpFromCustomGameEnd":playSound("click"),userInput.removeHitArea("playFromCustomGameEnd"),userInput.removeHitArea("rewardFromCustomGameEnd"),userInput.removeHitArea("batShopFromCustomGameEnd"),userInput.removeHitArea("challengeFromCustomGameEnd"),userInput.removeHitArea("arcadeFromCustomGameEnd"),userInput.removeHitArea("backFromCustomGameEnd"),userInput.removeHitArea("bugGameFromCustomGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.arcadeBut),userInput.removeHitArea("pvpFromCustomGameEnd"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=4,initPvpGame();break;case"rewardFromCustomGameEnd":userInput.removeHitArea("playFromCustomGameEnd"),userInput.removeHitArea("rewardFromCustomGameEnd"),userInput.removeHitArea("batShopFromCustomGameEnd"),userInput.removeHitArea("challengeFromCustomGameEnd"),userInput.removeHitArea("arcadeFromCustomGameEnd"),userInput.removeHitArea("backFromCustomGameEnd"),userInput.removeHitArea("bugGameFromCustomGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.arcadeBut),userInput.removeHitArea("pvpFromCustomGameEnd"),panel.removeBut(oImageIds.pvpGameBut),showRewardAd("customGameEnd");break;case"playFromLevelComplete":playSound("click"),userInput.removeHitArea("playFromLevelComplete"),userInput.removeHitArea("batShopFromLevelComplete"),userInput.removeHitArea("rewardFromLevelComplete"),userInput.removeHitArea("careerFromLevelComplete"),userInput.removeHitArea("challengeFromLevelComplete"),userInput.removeHitArea("backFromLevelComplete"),userInput.removeHitArea("bugGameFromLevelComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromLevelComplete"),panel.removeBut(oImageIds.pvpGameBut),anyWorldBatsLeft()&&(curLevel+1)%levelsPerWorld==0?initWorldComplete():(curLevel=saveDataHandler.getLevel(),showAd(initNextLevel));break;case"batShopFromLevelComplete":t.isDown&&(batShopButDown=!0),t.isUp&&batShopButDown&&(batShopButDown=!1,playSound("click"),userInput.removeHitArea("playFromLevelComplete"),userInput.removeHitArea("batShopFromLevelComplete"),userInput.removeHitArea("rewardFromLevelComplete"),userInput.removeHitArea("careerFromLevelComplete"),userInput.removeHitArea("challengeFromLevelComplete"),userInput.removeHitArea("backFromLevelComplete"),userInput.removeHitArea("bugGameFromLevelComplete"),userInput.removeHitArea("pvpFromLevelComplete"),userInput.removeHitArea("pvpFromLevelComplete"),prevGameplayState=gameplayState,initBatShop());break;case"rewardFromLevelComplete":userInput.removeHitArea("playFromLevelComplete"),userInput.removeHitArea("batShopFromLevelComplete"),userInput.removeHitArea("rewardFromLevelComplete"),userInput.removeHitArea("careerFromLevelComplete"),userInput.removeHitArea("challengeFromLevelComplete"),userInput.removeHitArea("backFromLevelComplete"),userInput.removeHitArea("bugGameFromLevelComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromLevelComplete"),panel.removeBut(oImageIds.pvpGameBut),showRewardAd("levelComplete");break;case"careerFromLevelComplete":playSound("click"),userInput.removeHitArea("playFromLevelComplete"),userInput.removeHitArea("batShopFromLevelComplete"),userInput.removeHitArea("rewardFromLevelComplete"),userInput.removeHitArea("careerFromLevelComplete"),userInput.removeHitArea("challengeFromLevelComplete"),userInput.removeHitArea("backFromLevelComplete"),userInput.removeHitArea("bugGameFromLevelComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromLevelComplete"),panel.removeBut(oImageIds.pvpGameBut),showAd(initMapScreen);break;case"challengeFromLevelComplete":playSound("click"),userInput.removeHitArea("playFromLevelComplete"),userInput.removeHitArea("batShopFromLevelComplete"),userInput.removeHitArea("rewardFromLevelComplete"),userInput.removeHitArea("careerFromLevelComplete"),userInput.removeHitArea("challengeFromLevelComplete"),userInput.removeHitArea("backFromLevelComplete"),userInput.removeHitArea("bugGameFromLevelComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromLevelComplete"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=1,showAd(initGame);break;case"bugGameFromLevelComplete":playSound("click"),userInput.removeHitArea("playFromLevelComplete"),userInput.removeHitArea("batShopFromLevelComplete"),userInput.removeHitArea("rewardFromLevelComplete"),userInput.removeHitArea("careerFromLevelComplete"),userInput.removeHitArea("challengeFromLevelComplete"),userInput.removeHitArea("backFromLevelComplete"),userInput.removeHitArea("bugGameFromLevelComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromLevelComplete"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=3,showAd(initGame);break;case"backFromLevelComplete":playSound("click"),userInput.removeHitArea("playFromLevelComplete"),userInput.removeHitArea("batShopFromLevelComplete"),userInput.removeHitArea("rewardFromLevelComplete"),userInput.removeHitArea("careerFromLevelComplete"),userInput.removeHitArea("challengeFromLevelComplete"),userInput.removeHitArea("backFromLevelComplete"),userInput.removeHitArea("bugGameFromLevelComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromLevelComplete"),panel.removeBut(oImageIds.pvpGameBut),initStartScreen(!1);break;case"pvpFromLevelComplete":playSound("click"),userInput.removeHitArea("playFromLevelComplete"),userInput.removeHitArea("batShopFromLevelComplete"),userInput.removeHitArea("rewardFromLevelComplete"),userInput.removeHitArea("careerFromLevelComplete"),userInput.removeHitArea("challengeFromLevelComplete"),userInput.removeHitArea("backFromLevelComplete"),userInput.removeHitArea("bugGameFromLevelComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromLevelComplete"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=4,initPvpGame();break;case"playFromWorldComplete":playSound("click"),userInput.removeHitArea("playFromWorldComplete"),userInput.removeHitArea("batShopFromWorldComplete"),userInput.removeHitArea("careerFromWorldComplete"),userInput.removeHitArea("challengeFromWorldComplete"),userInput.removeHitArea("backFromWorldComplete"),userInput.removeHitArea("bugGameFromWorldComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromWorldComplete"),panel.removeBut(oImageIds.pvpGameBut),curLevel++,showAd(initNextLevel);break;case"batShopFromWorldComplete":t.isDown&&(batShopButDown=!0),t.isUp&&batShopButDown&&(batShopButDown=!1,playSound("click"),userInput.removeHitArea("playFromWorldComplete"),userInput.removeHitArea("batShopFromWorldComplete"),userInput.removeHitArea("careerFromWorldComplete"),userInput.removeHitArea("challengeFromWorldComplete"),userInput.removeHitArea("backFromWorldComplete"),userInput.removeHitArea("bugGameFromWorldComplete"),userInput.removeHitArea("pvpFromWorldComplete"),prevGameplayState=gameplayState,initBatShop());break;case"customMatchFromWorldComplete":playSound("click"),userInput.removeHitArea("playFromWorldComplete"),userInput.removeHitArea("batShopFromWorldComplete"),userInput.removeHitArea("careerFromWorldComplete"),userInput.removeHitArea("challengeFromWorldComplete"),userInput.removeHitArea("backFromWorldComplete"),userInput.removeHitArea("bugGameFromWorldComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromWorldComplete"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=2,showAd(initGame);break;case"challengeFromWorldComplete":playSound("click"),userInput.removeHitArea("playFromWorldComplete"),userInput.removeHitArea("batShopFromWorldComplete"),userInput.removeHitArea("careerFromWorldComplete"),userInput.removeHitArea("challengeFromWorldComplete"),userInput.removeHitArea("backFromWorldComplete"),userInput.removeHitArea("bugGameFromWorldComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromWorldComplete"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=1,showAd(initGame);break;case"bugGameFromWorldComplete":playSound("click"),userInput.removeHitArea("playFromWorldComplete"),userInput.removeHitArea("batShopFromWorldComplete"),userInput.removeHitArea("careerFromWorldComplete"),userInput.removeHitArea("challengeFromWorldComplete"),userInput.removeHitArea("backFromWorldComplete"),userInput.removeHitArea("bugGameFromWorldComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromWorldComplete"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=3,showAd(initGame);break;case"careerFromWorldComplete":playSound("click"),userInput.removeHitArea("playFromWorldComplete"),userInput.removeHitArea("batShopFromWorldComplete"),userInput.removeHitArea("careerFromWorldComplete"),userInput.removeHitArea("challengeFromWorldComplete"),userInput.removeHitArea("backFromWorldComplete"),userInput.removeHitArea("bugGameFromWorldComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromWorldComplete"),panel.removeBut(oImageIds.pvpGameBut),showAd(initMapScreen);break;case"backFromWorldComplete":playSound("click"),userInput.removeHitArea("playFromWorldComplete"),userInput.removeHitArea("batShopFromWorldComplete"),userInput.removeHitArea("careerFromWorldComplete"),userInput.removeHitArea("challengeFromWorldComplete"),userInput.removeHitArea("backFromWorldComplete"),userInput.removeHitArea("bugGameFromWorldComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromWorldComplete"),panel.removeBut(oImageIds.pvpGameBut),initStartScreen(!1);break;case"rewardFromTargetGameEnd":userInput.removeHitArea("playFromTargetGameEnd"),userInput.removeHitArea("batShopFromTargetGameEnd"),userInput.removeHitArea("careerFromTargetGameEnd"),userInput.removeHitArea("arcadeFromTargetGameEnd"),userInput.removeHitArea("awardsFromTargetGameEnd"),userInput.removeHitArea("rewardFromTargetGameEnd"),userInput.removeHitArea("backFromTargetGameEnd"),userInput.removeHitArea("bugGameFromTargetGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromTargetGameEnd"),panel.removeBut(oImageIds.pvpGameBut),showRewardAd("targetGameEnd");break;case"playFromTargetGameEnd":playSound("click"),userInput.removeHitArea("playFromTargetGameEnd"),userInput.removeHitArea("batShopFromTargetGameEnd"),userInput.removeHitArea("careerFromTargetGameEnd"),userInput.removeHitArea("arcadeFromTargetGameEnd"),userInput.removeHitArea("awardsFromTargetGameEnd"),userInput.removeHitArea("rewardFromTargetGameEnd"),userInput.removeHitArea("backFromTargetGameEnd"),userInput.removeHitArea("bugGameFromTargetGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromTargetGameEnd"),panel.removeBut(oImageIds.pvpGameBut),showAd(initGame);break;case"batShopFromTargetGameEnd":t.isDown&&(batShopButDown=!0),t.isUp&&batShopButDown&&(batShopButDown=!1,playSound("click"),userInput.removeHitArea("playFromTargetGameEnd"),userInput.removeHitArea("batShopFromTargetGameEnd"),userInput.removeHitArea("careerFromTargetGameEnd"),userInput.removeHitArea("arcadeFromTargetGameEnd"),userInput.removeHitArea("awardsFromTargetGameEnd"),userInput.removeHitArea("rewardFromTargetGameEnd"),userInput.removeHitArea("backFromTargetGameEnd"),userInput.removeHitArea("bugGameFromTargetGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromTargetGameEnd"),panel.removeBut(oImageIds.pvpGameBut),prevGameplayState=gameplayState,initBatShop());break;case"backFromTargetGameEnd":playSound("click"),userInput.removeHitArea("playFromTargetGameEnd"),userInput.removeHitArea("batShopFromTargetGameEnd"),userInput.removeHitArea("careerFromTargetGameEnd"),userInput.removeHitArea("arcadeFromTargetGameEnd"),userInput.removeHitArea("awardsFromTargetGameEnd"),userInput.removeHitArea("rewardFromTargetGameEnd"),userInput.removeHitArea("backFromTargetGameEnd"),userInput.removeHitArea("bugGameFromTargetGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromTargetGameEnd"),panel.removeBut(oImageIds.pvpGameBut),initStartScreen(!1);break;case"pvpFromTargetGameEnd":playSound("click"),userInput.removeHitArea("playFromTargetGameEnd"),userInput.removeHitArea("batShopFromTargetGameEnd"),userInput.removeHitArea("careerFromTargetGameEnd"),userInput.removeHitArea("arcadeFromTargetGameEnd"),userInput.removeHitArea("awardsFromTargetGameEnd"),userInput.removeHitArea("rewardFromTargetGameEnd"),userInput.removeHitArea("backFromTargetGameEnd"),userInput.removeHitArea("bugGameFromTargetGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromTargetGameEnd"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=4,initPvpGame();break;case"careerFromTargetGameEnd":playSound("click"),userInput.removeHitArea("playFromTargetGameEnd"),userInput.removeHitArea("batShopFromTargetGameEnd"),userInput.removeHitArea("careerFromTargetGameEnd"),userInput.removeHitArea("arcadeFromTargetGameEnd"),userInput.removeHitArea("awardsFromTargetGameEnd"),userInput.removeHitArea("rewardFromTargetGameEnd"),userInput.removeHitArea("backFromTargetGameEnd"),userInput.removeHitArea("bugGameFromTargetGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromTargetGameEnd"),panel.removeBut(oImageIds.pvpGameBut),showAd(initMapScreen);break;case"arcadeFromTargetGameEnd":playSound("click"),userInput.removeHitArea("playFromTargetGameEnd"),userInput.removeHitArea("batShopFromTargetGameEnd"),userInput.removeHitArea("careerFromTargetGameEnd"),userInput.removeHitArea("arcadeFromTargetGameEnd"),userInput.removeHitArea("rewardFromTargetGameEnd"),userInput.removeHitArea("backFromTargetGameEnd"),userInput.removeHitArea("bugGameFromTargetGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromTargetGameEnd"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=0,showAd(initGame);break;case"bugGameFromTargetGameEnd":playSound("click"),userInput.removeHitArea("playFromTargetGameEnd"),userInput.removeHitArea("batShopFromTargetGameEnd"),userInput.removeHitArea("careerFromTargetGameEnd"),userInput.removeHitArea("arcadeFromTargetGameEnd"),userInput.removeHitArea("rewardFromTargetGameEnd"),userInput.removeHitArea("backFromTargetGameEnd"),userInput.removeHitArea("bugGameFromTargetGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromTargetGameEnd"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=3,showAd(initGame);break;case"awardsFromTargetGameEnd":playSound("click"),userInput.removeHitArea("playFromTargetGameEnd"),userInput.removeHitArea("batShopFromTargetGameEnd"),userInput.removeHitArea("careerFromTargetGameEnd"),userInput.removeHitArea("arcadeFromTargetGameEnd"),userInput.removeHitArea("awardsFromTargetGameEnd"),userInput.removeHitArea("rewardFromTargetGameEnd"),userInput.removeHitArea("backFromTargetGameEnd"),userInput.removeHitArea("bugGameFromTargetGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromTargetGameEnd"),panel.removeBut(oImageIds.pvpGameBut),prevGameplayState=gameplayState,initAwards();break;case"rewardFromBugGameEnd":userInput.removeHitArea("playFromBugGameEnd"),userInput.removeHitArea("batShopFromBugGameEnd"),userInput.removeHitArea("careerFromBugGameEnd"),userInput.removeHitArea("arcadeFromBugGameEnd"),userInput.removeHitArea("awardsFromBugGameEnd"),userInput.removeHitArea("rewardFromBugGameEnd"),userInput.removeHitArea("backFromBugGameEnd"),userInput.removeHitArea("challengeFromBugGameEnd"),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromBugGameEnd"),panel.removeBut(oImageIds.pvpGameBut),showRewardAd("bugGameEnd");break;case"playFromBugGameEnd":playSound("click"),userInput.removeHitArea("playFromBugGameEnd"),userInput.removeHitArea("batShopFromBugGameEnd"),userInput.removeHitArea("careerFromBugGameEnd"),userInput.removeHitArea("arcadeFromBugGameEnd"),userInput.removeHitArea("awardsFromBugGameEnd"),userInput.removeHitArea("rewardFromBugGameEnd"),userInput.removeHitArea("backFromBugGameEnd"),userInput.removeHitArea("challengeFromBugGameEnd"),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromBugGameEnd"),panel.removeBut(oImageIds.pvpGameBut),showAd(initGame);break;case"batShopFromBugGameEnd":t.isDown&&(batShopButDown=!0),t.isUp&&batShopButDown&&(batShopButDown=!1,playSound("click"),userInput.removeHitArea("playFromBugGameEnd"),userInput.removeHitArea("batShopFromBugGameEnd"),userInput.removeHitArea("careerFromBugGameEnd"),userInput.removeHitArea("arcadeFromBugGameEnd"),userInput.removeHitArea("awardsFromBugGameEnd"),userInput.removeHitArea("rewardFromBugGameEnd"),userInput.removeHitArea("backFromBugGameEnd"),userInput.removeHitArea("challengeFromBugGameEnd"),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromBugGameEnd"),panel.removeBut(oImageIds.pvpGameBut),prevGameplayState=gameplayState,initBatShop());break;case"backFromBugGameEnd":playSound("click"),userInput.removeHitArea("playFromBugGameEnd"),userInput.removeHitArea("batShopFromBugGameEnd"),userInput.removeHitArea("careerFromBugGameEnd"),userInput.removeHitArea("arcadeFromBugGameEnd"),userInput.removeHitArea("awardsFromBugGameEnd"),userInput.removeHitArea("rewardFromBugGameEnd"),userInput.removeHitArea("backFromBugGameEnd"),userInput.removeHitArea("challengeFromBugGameEnd"),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromBugGameEnd"),panel.removeBut(oImageIds.pvpGameBut),initStartScreen(!1);break;case"pvpFromBugGameEnd":playSound("click"),userInput.removeHitArea("playFromBugGameEnd"),userInput.removeHitArea("batShopFromBugGameEnd"),userInput.removeHitArea("careerFromBugGameEnd"),userInput.removeHitArea("arcadeFromBugGameEnd"),userInput.removeHitArea("awardsFromBugGameEnd"),userInput.removeHitArea("rewardFromBugGameEnd"),userInput.removeHitArea("backFromBugGameEnd"),userInput.removeHitArea("challengeFromBugGameEnd"),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromBugGameEnd"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=4,initPvpGame();break;case"careerFromBugGameEnd":playSound("click"),userInput.removeHitArea("playFromBugGameEnd"),userInput.removeHitArea("batShopFromBugGameEnd"),userInput.removeHitArea("careerFromBugGameEnd"),userInput.removeHitArea("arcadeFromBugGameEnd"),userInput.removeHitArea("awardsFromBugGameEnd"),userInput.removeHitArea("rewardFromBugGameEnd"),userInput.removeHitArea("backFromBugGameEnd"),userInput.removeHitArea("challengeFromBugGameEnd"),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromBugGameEnd"),panel.removeBut(oImageIds.pvpGameBut),showAd(initMapScreen);break;case"arcadeFromBugGameEnd":playSound("click"),userInput.removeHitArea("playFromBugGameEnd"),userInput.removeHitArea("batShopFromBugGameEnd"),userInput.removeHitArea("careerFromBugGameEnd"),userInput.removeHitArea("arcadeFromBugGameEnd"),userInput.removeHitArea("awardsFromBugGameEnd"),userInput.removeHitArea("rewardFromBugGameEnd"),userInput.removeHitArea("backFromBugGameEnd"),userInput.removeHitArea("challengeFromBugGameEnd"),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromBugGameEnd"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=0,showAd(initGame);break;case"challengeFromBugGameEnd":playSound("click"),userInput.removeHitArea("playFromBugGameEnd"),userInput.removeHitArea("batShopFromBugGameEnd"),userInput.removeHitArea("careerFromBugGameEnd"),userInput.removeHitArea("arcadeFromBugGameEnd"),userInput.removeHitArea("awardsFromBugGameEnd"),userInput.removeHitArea("rewardFromBugGameEnd"),userInput.removeHitArea("backFromBugGameEnd"),userInput.removeHitArea("challengeFromBugGameEnd"),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromBugGameEnd"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=1,showAd(initGame);break;case"awardsFromBugGameEnd":playSound("click"),userInput.removeHitArea("playFromBugGameEnd"),userInput.removeHitArea("batShopFromBugGameEnd"),userInput.removeHitArea("careerFromBugGameEnd"),userInput.removeHitArea("arcadeFromBugGameEnd"),userInput.removeHitArea("awardsFromBugGameEnd"),userInput.removeHitArea("rewardFromBugGameEnd"),userInput.removeHitArea("backFromBugGameEnd"),userInput.removeHitArea("challengeFromBugGameEnd"),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromBugGameEnd"),panel.removeBut(oImageIds.pvpGameBut),prevGameplayState=gameplayState,initAwards();break;case"mute":playSound("click"),toggleMute(),muted?(panel.switchBut(oImageIds.muteBut0,oImageIds.muteBut1,oImageIds.muteBut1Over),saveDataHandler.setAudioState(1)):(panel.switchBut(oImageIds.muteBut1,oImageIds.muteBut0,oImageIds.muteBut0Over),saveDataHandler.setAudioState(0));break;case"keyPauseOn":t.isDown||butEventHandler("pause",null);break;case"pause":playSound("click"),1==audioType?(Howler.mute(!0),music.pause()):2==audioType&&music.pause(),userInput.removeHitArea("pause"),userInput.removeHitArea("gameTouch"),userInput.removeHitArea("mute"),userInput.removeKey("keyPauseOn"),initPause();break;case"keyPauseOff":t.isDown||butEventHandler("continueFromPause",null);break;case"continueFromPause":playSound("click"),1==audioType?muted||(Howler.mute(!1),playMusic()):2!=audioType||muted||playMusic(),userInput.removeHitArea("quitFromPause"),userInput.removeHitArea("continueFromPause"),userInput.removeHitArea("mute"),userInput.removeKey("keyPauseOff"),resumeGame();break;case"quitFromPause":t.isDown||t.isBeingDragged||t.hasLeft||(playSound("click"),1==audioType?muted||(Howler.mute(!1),playMusic()):2!=audioType||muted||playMusic(),userInput.removeHitArea("quitFromPause"),userInput.removeHitArea("continueFromPause"),userInput.removeHitArea("mute"),userInput.removeKey("keyPauseOff"),4==gameVariation&&netLib.disconnect(),gameVariation=0,initStartScreen())}}function getSeasonFlags(e){for(var t=[],a=0;a<aFlags.length;a++)t.push(a);t=shuffleArray(t);for(var s=[],a=0;a<6;a++)s.push({id:t[a],rank:getEnemyRank()});return sortBy(s,"rank",!1)}function getEnemyRank(){for(var e=saveDataHandler.getRank(),t=saveDataHandler.getSeason();e==saveDataHandler.getRank();)e=Math.ceil(Math.random()*Math.max(6-t,1)*30+60*Math.max(6-t,0));return e}function shuffleArray(e){for(var t,a=e.length-1;a>0;a--){var s=Math.floor(Math.random()*(a+1));t=[e[s],e[a]],e[a]=t[0],e[s]=t[1]}return e}function sortBy(e,t,a){return(void 0===a&&(a=!0),a)?e.sort(function(e,a){return e[t]<a[t]?-1:e[t]>a[t]?1:0}):e.sort(function(e,a){return e[t]>a[t]?-1:e[t]<a[t]?1:0})}function getSpriteData(e,t){return{img:e.img,bX:e.oData.oAtlasData[oImageIds[t]].x,bY:e.oData.oAtlasData[oImageIds[t]].y,bWidth:e.oData.oAtlasData[oImageIds[t]].width,bHeight:e.oData.oAtlasData[oImageIds[t]].height}}function getMultiLineTextByChars(e,t,a){for(var s=[],i=getText(e,a);i.length>t;){var r=i.substring(0,t).lastIndexOf(" ");-1==r?(s.push(i.substring(0,t)+"-"),i=i.substring(t+1)):(s.push(i.substring(0,r)),i=i.substring(r+1))}return s.push(i),s}function addDirectText(e,t,a,s,i,r,o,n){if(void 0===n&&(n="#202020"),ctx.fillStyle=n,ctx.textAlign=s,a<getDirectWidth(e,t,o))for(t--;a<getDirectWidth(e,t,o)&&(t--,1););ctx.font=t+"px "+assetLib.textData.langText["font"+e][curLang],ctx.fillText(o,i,r)}function addText(e,t,a,s,i,r,o,n){if(void 0===n&&(n="#202020"),ctx.fillStyle=n,ctx.textAlign=s,a<getTextWidth(e,t,o))for(t--;a<getTextWidth(e,t,o)&&(t--,1););"ar"==curLang&&(r-=t/15),ctx.font=t+"px "+assetLib.textData.langText["font"+e][curLang],ctx.fillText(getText(o,e),i,r)}function getText(e,t){var a=assetLib.textData.langText[e][curLang];if("tr"==curLang){for(var s,i="",r=0;r<a.length;)s=a.charAt(r),"Bangers"==assetLib.textData.langText["font"+t][curLang]&&"i"==s&&(s="İ"),i+=s,r++;a=i}return a}function getTextWidth(e,t,a){return ctx.font=t+"px "+assetLib.textData.langText["font"+e][curLang],ctx.measureText(getText(a,e)).width}function getDirectWidth(e,t,a){return ctx.font=t+"px "+assetLib.textData.langText["font"+e][curLang],ctx.measureText(a).width}function getCorrectedTextWidth(e,t,a,s){if(a<getTextWidth(e,t,s))for(t--;a<getTextWidth(e,t,s)&&(t--,1););return ctx.font=t+"px "+assetLib.textData.langText["font"+e][curLang],ctx.measureText(getText(s,e)).width}function checkButtonsOver(){if(!isMobile)for(var e=0;e<panel.aButs.length;e++)panel.aButs[e].isOver=!1,userInput.mouseX>panel.aButs[e].aOverData[0]&&userInput.mouseX<panel.aButs[e].aOverData[2]&&userInput.mouseY>panel.aButs[e].aOverData[1]&&userInput.mouseY<panel.aButs[e].aOverData[3]&&(panel.aButs[e].isOver=!0)}function clearButtonOvers(){userInput.mouseX=-100,userInput.mouseY=-100}function updateScore(e){var t=!1;if("user"==e&&rallyHits>3&&Math.random()>.5&&(playSound("cheer"+Math.floor(6*Math.random())),t=!0),0==gameVariation){if("user"==e){enemyBat.scoreDiff=Math.min(Math.max(enemyBat.scoreDiff+.025,-enemyBat.scoreDiffMax),enemyBat.scoreDiffMax);for(var a=0;a<15;a++){var s=canvas.width/2+70*curLevelStars-70*(levelStarTarg/2-.5)-100*panel.starsX,i=Math.max(onScreenY-200,60)-100*panel.starsY,r=new Elements.Particle(s,i,1,200,24*a*radian,100);aEffects.push(r)}playSound("winStar"),curLevelStars++,panel.tweenStars(!0),curLevelStars!=levelStarTarg||(initGameWon(),playSound("arcadeWin"),t||playSound("cheer"+Math.floor(6*Math.random())))}else enemyBat.scoreDiff=Math.min(Math.max(enemyBat.scoreDiff-.025,-enemyBat.scoreDiffMax),enemyBat.scoreDiffMax),curLevelStars>0&&curLevelStars--,panel.tweenStars(!1),playSound("loseStar")}else if(2==gameVariation||4==gameVariation){var o,n=!1;if("user"==e){if(userScore++,enemyBat.scoreDiff=Math.min(Math.max(enemyBat.scoreDiff+.025,-enemyBat.scoreDiffMax),enemyBat.scoreDiffMax),playSound("classicGameWin",.5),panel.tweenCustomGameScore(0),2==gameVariation)(enemyScore<saveDataHandler.getCareerGames()-1&&userScore==saveDataHandler.getCareerGames()||enemyScore>=saveDataHandler.getCareerGames()-1&&userScore>=enemyScore+2)&&(userSets++,userScore=enemyScore=0,t||playSound("cheer"+Math.floor(6*Math.random())),userSets>=saveDataHandler.getCareerSets()?(initCustomGameComplete(),playSound("classicMatchWin",.5)):(n=!0,playSound("winSet",.3)));else if(4==gameVariation){if(console.log("rallyHits",rallyHits),rallyHits>8||Math.random()>.8){userBat.successFlip(),panel.showCongrats(),playSound("hitTarget",.3),playSound("cheer"+Math.floor(6*Math.random()));for(var a=0;a<25;a++){var l=new Elements.Confetti(canvas.width/2+400*Math.random()-200,.9*canvas.height);aEffects.push(l)}}(enemyScore<10&&11==userScore||enemyScore>=10&&userScore>=enemyScore+2)&&(t||playSound("cheer"+Math.floor(6*Math.random())),initPvpGameComplete(),playSound("classicMatchWin",.5))}o=-80}else enemyScore++,enemyBat.scoreDiff=Math.min(Math.max(enemyBat.scoreDiff-.025,-enemyBat.scoreDiffMax),enemyBat.scoreDiffMax),playSound("classicGameLose",.5),panel.tweenCustomGameScore(1),2==gameVariation?(userScore<saveDataHandler.getCareerGames()-1&&enemyScore==saveDataHandler.getCareerGames()||userScore>=saveDataHandler.getCareerGames()-1&&enemyScore>=userScore+2)&&(enemySets++,userScore=enemyScore=0,t||playSound("cheer"+Math.floor(6*Math.random())),enemySets>=saveDataHandler.getCareerSets()?(initCustomGameComplete(),playSound("classicMatchLose",.5)):(n=!0,playSound("loseSet",.5))):4==gameVariation&&(userScore<10&&11==enemyScore||userScore>=10&&enemyScore>=userScore+2)&&(t||playSound("cheer"+Math.floor(6*Math.random())),initPvpGameComplete(),playSound("classicMatchLose",.5)),o=80;for(var s=canvas.width/2+o,i=Math.max(onScreenY-200,60)-100*panel.starsY-10,a=0;a<15;a++){var r=new Elements.Particle(s,i,1,200,24*a*radian,100,.75,50);aEffects.push(r)}if(n)for(var a=0;a<50;a++){var l=new Elements.Confetti(s+200*Math.random()-100,i+200*Math.random()-100);aEffects.push(l)}}}function addFirework(e,t,a){if(void 0===a&&(a=1),!(aEffects.length>10)){var s=new Elements.Firework;s.x=e,s.y=t,s.endScale=a,s.blowUp(),aEffects.push(s)}}function updateGameEvent(){if("game"==gameState){if(delta=getDelta(),background.render(),4==gameVariation&&(pvpGameTime+=delta,netLib.peer&&netLib.peer.latency&&pvpGameTime>5&&netLib.peer.latency.average>250&&(networkMessage("latency"),netLib.send(!0,"latency")),(networkInc+=delta)>1/30)){var e=getSpriteData(assetLib.getData("gameElements"),"tableEdge").bWidth,t=(userBat.x-canvas.width/2-500*tableTop.offsetX*tableTop.genScale)/(e*tableTop.genScale/2),a=(userBat.y-(onScreenY+352*(1+tableTop.offsetY/2)+50*tableTop.offsetY))*.18+40;netLib.send(!1,"batPos",[Math.round(1e3*t)/1e3,Math.round(1e3*a)/1e3,Math.round(1e3*userBat.rotation)/1e3]),networkInc=0}for(var s=0;s<aBalls.length;s++)0==aBalls[s].curBallState&&(curBallId=s),2==aBalls[s].curBallState&&(aBalls.splice(s,1),s-=1);for(var s=0;s<aBalls.length;s++)aBalls[s].update(),s==curBallId&&(0==gameVariation||2==gameVariation||4==gameVariation)&&enemyBat.update(),aBalls[s].offTable||aBalls[s].offSide||aBalls[s].height<0&&aBalls[s].tablePosY<.5&&(aBalls[s].tablePosX<-1||aBalls[s].tablePosX>1)?(aBalls[s].render(),s==curBallId&&(tableTop.render(),(0==gameVariation||2==gameVariation||4==gameVariation)&&enemyBat.render(),tableTop.renderNet())):aBalls[s].tablePosY>.5?(s==curBallId&&(tableTop.render(),(0==gameVariation||2==gameVariation||4==gameVariation)&&enemyBat.render(),tableTop.renderNet()),aBalls[s].render()):aBalls[s].tablePosY<.5&&(1!=gameVariation&&s==curBallId&&aBalls[s].y<enemyBat.y+200*enemyBat.scale-30?(tableTop.render(),aBalls[s].render(),(0==gameVariation||2==gameVariation||4==gameVariation)&&enemyBat.render(),tableTop.renderNet()):(s==curBallId&&(tableTop.render(),(0==gameVariation||2==gameVariation||4==gameVariation)&&enemyBat.render()),aBalls[s].render(),s==curBallId&&tableTop.renderNet()));(0==aBalls.length||curBallId>=aBalls.length)&&(curBallId=0,tableTop.render(),tableTop.renderNet()),userBat.update(),userBat.render(),panel.update(),panel.render(),awardPanel.render();for(var s=0;s<aEffects.length;s++)aEffects[s].update(),aEffects[s].render(),aEffects[s].removeMe&&(aEffects.splice(s,1),s-=1);checkButtonsOver(),panel.renderPointer(),requestAnimFrame(updateGameEvent)}}function updateAwardsEvent(){if("awards"==gameState){delta=getDelta(),background.render(),panel.update(),panel.render(),awardPanel.render();for(var e=0;e<aEffects.length;e++)aEffects[e].update(),aEffects[e].render(),aEffects[e].removeMe&&(aEffects.splice(e,1),e-=1);checkButtonsOver(),panel.renderPointer(),requestAnimFrame(updateAwardsEvent)}}function updateMapScreenEvent(){if("mapScreen"==gameState){delta=getDelta(),background.render(),panel.update(),panel.render(),awardPanel.render();for(var e=0;e<aEffects.length;e++)aEffects[e].update(),aEffects[e].render(),aEffects[e].removeMe&&(aEffects.splice(e,1),e-=1);checkButtonsOver(),panel.renderPointer(),requestAnimFrame(updateMapScreenEvent)}}function updateBatShopEvent(){if("batShop"==gameState){delta=getDelta(),background.render(),panel.update(),panel.render(),batShop.update(),batShop.render(),awardPanel.render();for(var e=0;e<aEffects.length;e++)aEffects[e].update(),aEffects[e].render(),aEffects[e].removeMe&&(aEffects.splice(e,1),e-=1);checkButtonsOver(),panel.renderPointer(),requestAnimFrame(updateBatShopEvent)}}function updateCreditsScreenEvent(){"credits"==gameState&&(delta=getDelta(),background.render(),panel.update(),panel.render(),awardPanel.render(),checkButtonsOver(),panel.renderPointer(),requestAnimFrame(updateCreditsScreenEvent))}function updateNetworkScreenEvent(){"network"==gameState&&(delta=getDelta(),background.render(),panel.update(),panel.render(),awardPanel.render(),checkButtonsOver(),panel.renderPointer(),requestAnimFrame(updateNetworkScreenEvent))}function updateResetConfirmEvent(){"resetConfirm"==gameState&&(delta=getDelta(),background.render(),panel.update(),panel.render(),awardPanel.render(),checkButtonsOver(),panel.renderPointer(),requestAnimFrame(updateResetConfirmEvent))}function updateLoaderEvent(){"loading"==gameState&&(delta=getDelta(),assetLib.render(),requestAnimFrame(updateLoaderEvent))}function updatePauseEvent(){"pause"==gameState&&(delta=getDelta(),background.render(),panel.update(),panel.render(),checkButtonsOver(),panel.renderPointer(),requestAnimFrame(updatePauseEvent))}function getDelta(){var e=new Date().getTime(),t=(e-previousTime)/1e3;return previousTime=e,t>.5&&(t=0),t}function checkSpriteCollision(e,t){var a=e.x,s=e.y,i=t.x,r=t.y;return(a-i)*(a-i)+(s-r)*(s-r)<e.radius*t.radius}function getScaleImageToMax(e,t){var a;return e.isSpriteSheet?t[0]/e.oData.spriteWidth<t[1]/e.oData.spriteHeight?Math.min(t[0]/e.oData.spriteWidth,1):Math.min(t[1]/e.oData.spriteHeight,1):t[0]/e.img.width<t[1]/e.img.height?Math.min(t[0]/e.img.width,1):Math.min(t[1]/e.img.height,1)}function getCentreFromTopLeft(e,t,a){var s=[];return s.push(e[0]+t.oData.spriteWidth/2*a),s.push(e[1]+t.oData.spriteHeight/2*a),s}function loadPreAssets(){(preAssetLib=new Utils.AssetLoader(curLang,[{id:"loader",file:"images/loader.png"},{id:"loadSpinner",file:"images/loadSpinner.png"}],ctx,canvas.width,canvas.height,!1)).onReady(initLoadAssets)}function initLangSelect(){for(var e,t,a,s=0,i=0,r=0;r<aLangs.length;r++)if(e=preAssetLib.getData("lang"+aLangs[r]),(r+1)*(1*e.img.width)+(r+2)*10<canvas.width)s++;else break;i=Math.ceil(aLangs.length/s);for(var r=0;r<aLangs.length;r++){e=preAssetLib.getData("lang"+aLangs[r]),t=canvas.width/2-s/2*(1*e.img.width)-(s-1)/2*10,t+=r%s*(1*e.img.width+10),a=canvas.height/2-i/2*(1*e.img.height)-(i-1)/2*10,a+=Math.floor(r/s)%i*(1*e.img.height+10),ctx.drawImage(e.img,0,0,e.img.width,e.img.height,t,a,1*e.img.width,1*e.img.height);var o={oImgData:e,aPos:[t+1*e.img.width/2,a+1*e.img.height/2],scale:1,id:"none",noMove:!0};userInput.addHitArea("langSelect",butEventHandler,{lang:aLangs[r]},"image",o)}}function initLoadAssets(){loadAssets()}function loadAssets(){assetLib=new Utils.AssetLoader(curLang,[{id:"uiButs",file:"images/uiButs.png",oAtlasData:{id0:{x:525,y:138,width:132,height:136},id1:{x:525,y:0,width:132,height:136},id10:{x:0,y:548,width:196,height:200},id11:{x:0,y:346,width:196,height:200},id12:{x:0,y:173,width:255,height:171},id13:{x:0,y:0,width:255,height:171},id14:{x:84,y:760,width:82,height:82},id15:{x:168,y:760,width:82,height:82},id16:{x:0,y:760,width:82,height:82},id17:{x:734,y:306,width:82,height:82},id18:{x:600,y:552,width:132,height:136},id19:{x:600,y:414,width:132,height:136},id2:{x:600,y:690,width:132,height:136},id20:{x:600,y:276,width:132,height:136},id21:{x:466,y:690,width:132,height:136},id22:{x:659,y:138,width:82,height:82},id23:{x:734,y:222,width:82,height:82},id24:{x:466,y:552,width:132,height:136},id25:{x:466,y:414,width:132,height:136},id26:{x:466,y:276,width:132,height:136},id27:{x:391,y:138,width:132,height:136},id28:{x:391,y:0,width:132,height:136},id29:{x:332,y:690,width:132,height:136},id3:{x:659,y:0,width:132,height:136},id30:{x:252,y:760,width:54,height:54},id31:{x:793,y:0,width:54,height:54},id32:{x:793,y:56,width:54,height:54},id33:{x:257,y:276,width:54,height:54},id34:{x:257,y:0,width:132,height:136},id35:{x:332,y:414,width:132,height:136},id36:{x:332,y:552,width:132,height:136},id37:{x:198,y:346,width:132,height:136},id38:{x:198,y:622,width:132,height:136},id39:{x:198,y:484,width:132,height:136},id4:{x:734,y:726,width:82,height:82},id40:{x:257,y:138,width:132,height:136},id41:{x:332,y:276,width:132,height:136},id5:{x:734,y:642,width:82,height:82},id6:{x:734,y:558,width:82,height:82},id7:{x:734,y:474,width:82,height:82},id8:{x:734,y:390,width:82,height:82},id9:{x:743,y:138,width:82,height:82}}},{id:"flags",file:"images/flags.png",oAtlasData:{id0:{x:198,y:297,width:97,height:97},id1:{x:396,y:495,width:97,height:97},id10:{x:297,y:198,width:97,height:97},id11:{x:297,y:99,width:97,height:97},id12:{x:297,y:0,width:97,height:97},id13:{x:198,y:495,width:97,height:97},id14:{x:198,y:396,width:97,height:97},id15:{x:495,y:0,width:97,height:97},id16:{x:198,y:198,width:97,height:97},id17:{x:198,y:99,width:97,height:97},id18:{x:198,y:0,width:97,height:97},id19:{x:99,y:495,width:97,height:97},id2:{x:396,y:396,width:97,height:97},id20:{x:99,y:396,width:97,height:97},id21:{x:99,y:297,width:97,height:97},id22:{x:99,y:198,width:97,height:97},id23:{x:99,y:99,width:97,height:97},id24:{x:99,y:0,width:97,height:97},id25:{x:0,y:495,width:97,height:97},id26:{x:0,y:396,width:97,height:97},id27:{x:0,y:297,width:97,height:97},id28:{x:0,y:198,width:97,height:97},id29:{x:0,y:99,width:97,height:97},id3:{x:396,y:297,width:97,height:97},id30:{x:0,y:0,width:97,height:97},id4:{x:396,y:198,width:97,height:97},id5:{x:396,y:99,width:97,height:97},id6:{x:396,y:0,width:97,height:97},id7:{x:297,y:495,width:97,height:97},id8:{x:297,y:396,width:97,height:97},id9:{x:297,y:297,width:97,height:97}}},{id:"flare",file:"images/flare.png"},{id:"gameElements",file:"images/gameElements.png",oAtlasData:{id0:{x:0,y:47,width:618,height:51},id1:{x:182,y:1395,width:62,height:62},id10:{x:1226,y:564,width:172,height:280},id11:{x:1310,y:0,width:172,height:280},id12:{x:1400,y:1692,width:172,height:280},id13:{x:1400,y:1128,width:172,height:280},id14:{x:1574,y:1692,width:172,height:280},id15:{x:1574,y:1410,width:172,height:280},id16:{x:1574,y:1128,width:172,height:280},id17:{x:1574,y:846,width:172,height:280},id18:{x:1574,y:564,width:172,height:280},id19:{x:1484,y:0,width:172,height:280},id2:{x:182,y:1357,width:65,height:36},id20:{x:1478,y:282,width:172,height:280},id21:{x:1136,y:0,width:172,height:280},id22:{x:1400,y:1410,width:172,height:280},id23:{x:1304,y:282,width:172,height:280},id24:{x:1400,y:846,width:172,height:280},id25:{x:1400,y:564,width:172,height:280},id26:{x:1226,y:1692,width:172,height:280},id27:{x:1226,y:1410,width:172,height:280},id28:{x:1226,y:1128,width:172,height:280},id29:{x:1226,y:846,width:172,height:280},id3:{x:0,y:845,width:299,height:87},id30:{x:356,y:1409,width:172,height:280},id31:{x:356,y:1127,width:172,height:280},id32:{x:1130,y:282,width:172,height:280},id33:{x:530,y:1409,width:172,height:280},id34:{x:356,y:1691,width:172,height:280},id35:{x:1052,y:1739,width:172,height:280},id36:{x:1052,y:1457,width:172,height:280},id37:{x:1052,y:1175,width:172,height:280},id38:{x:1052,y:893,width:172,height:280},id39:{x:356,y:845,width:172,height:280},id4:{x:0,y:552,width:606,height:13},id40:{x:962,y:0,width:172,height:280},id41:{x:956,y:329,width:172,height:280},id42:{x:878,y:1792,width:172,height:280},id43:{x:878,y:1510,width:172,height:280},id44:{x:878,y:1228,width:172,height:280},id45:{x:878,y:946,width:172,height:280},id46:{x:878,y:664,width:172,height:280},id47:{x:788,y:47,width:172,height:280},id48:{x:782,y:382,width:172,height:280},id49:{x:704,y:1680,width:172,height:280},id5:{x:0,y:0,width:896,height:45},id50:{x:704,y:1398,width:172,height:280},id51:{x:704,y:1116,width:172,height:280},id52:{x:704,y:834,width:172,height:280},id53:{x:614,y:100,width:172,height:280},id54:{x:608,y:552,width:172,height:280},id55:{x:530,y:1691,width:172,height:280},id56:{x:0,y:1780,width:178,height:284},id57:{x:1748,y:920,width:165,height:332},id58:{x:0,y:1214,width:180,height:278},id59:{x:1908,y:1549,width:148,height:286},id6:{x:182,y:1459,width:37,height:21},id60:{x:1748,y:1254,width:158,height:293},id61:{x:1748,y:1549,width:158,height:289},id62:{x:180,y:1786,width:174,height:290},id63:{x:1658,y:0,width:166,height:291},id64:{x:182,y:934,width:172,height:280},id65:{x:0,y:567,width:606,height:49},id66:{x:0,y:326,width:612,height:224},id67:{x:182,y:1216,width:120,height:139},id68:{x:0,y:1494,width:178,height:284},id69:{x:1748,y:586,width:165,height:332},id7:{x:530,y:845,width:172,height:280},id70:{x:0,y:934,width:180,height:278},id71:{x:1915,y:586,width:148,height:286},id72:{x:1908,y:1254,width:158,height:293},id73:{x:1826,y:0,width:158,height:289},id74:{x:180,y:1494,width:174,height:290},id75:{x:1748,y:293,width:166,height:291},id76:{x:0,y:618,width:603,height:225},id77:{x:0,y:100,width:612,height:224},id8:{x:1052,y:611,width:172,height:280},id9:{x:530,y:1127,width:172,height:280}}},{id:"uiElements",file:"images/uiElements.png",oAtlasData:{id0:{x:193,y:1054,width:70,height:66},id1:{x:271,y:825,width:182,height:177},id10:{x:653,y:1067,width:62,height:58},id11:{x:359,y:1034,width:85,height:86},id12:{x:628,y:751,width:171,height:249},id13:{x:868,y:248,width:167,height:245},id14:{x:801,y:747,width:168,height:245},id15:{x:868,y:0,width:168,height:246},id16:{x:751,y:500,width:168,height:245},id17:{x:404,y:500,width:172,height:281},id18:{x:0,y:1054,width:191,height:70},id19:{x:894,y:1053,width:40,height:37},id2:{x:718,y:1002,width:59,height:60},id20:{x:837,y:994,width:56,height:57},id21:{x:578,y:500,width:171,height:249},id22:{x:455,y:783,width:171,height:249},id23:{x:0,y:792,width:311,height:31},id24:{x:0,y:760,width:311,height:30},id25:{x:921,y:495,width:165,height:242},id26:{x:717,y:1067,width:59,height:60},id27:{x:313,y:760,width:84,height:48},id28:{x:779,y:1002,width:56,height:57},id29:{x:838,y:1053,width:54,height:54},id3:{x:271,y:1017,width:42,height:11},id30:{x:936,y:1044,width:31,height:47},id31:{x:446,y:1034,width:71,height:81},id32:{x:653,y:1002,width:63,height:63},id33:{x:0,y:0,width:866,height:498},id34:{x:0,y:825,width:269,height:227},id35:{x:895,y:994,width:36,height:48},id36:{x:933,y:994,width:36,height:48},id37:{x:0,y:630,width:402,height:128},id38:{x:399,y:783,width:49,height:38},id39:{x:0,y:500,width:402,height:128},id4:{x:271,y:1004,width:42,height:11},id40:{x:315,y:1004,width:33,height:28},id5:{x:519,y:1034,width:65,height:65},id6:{x:271,y:1034,width:86,height:86},id7:{x:971,y:739,width:160,height:248},id8:{x:586,y:1034,width:65,height:65},id9:{x:778,y:1064,width:58,height:56}}},{id:"awards",file:"images/awards.png",oAtlasData:{id0:{x:294,y:330,width:145,height:163},id1:{x:588,y:330,width:145,height:163},id10:{x:240,y:165,width:145,height:163},id11:{x:240,y:0,width:145,height:163},id12:{x:147,y:591,width:145,height:163},id13:{x:147,y:426,width:145,height:163},id14:{x:0,y:591,width:145,height:163},id15:{x:0,y:426,width:145,height:163},id16:{x:0,y:278,width:153,height:146},id17:{x:0,y:0,width:238,height:276},id2:{x:534,y:165,width:145,height:163},id3:{x:534,y:0,width:145,height:163},id4:{x:441,y:495,width:145,height:163},id5:{x:441,y:330,width:145,height:163},id6:{x:387,y:165,width:145,height:163},id7:{x:387,y:0,width:145,height:163},id8:{x:294,y:495,width:145,height:163},id9:{x:588,y:495,width:145,height:163}}},{id:"bugs",file:"images/bugs.png",oAtlasData:{id0:{x:124,y:300,width:122,height:115},id1:{x:372,y:194,width:122,height:104},id2:{x:248,y:301,width:122,height:101},id3:{x:248,y:194,width:122,height:105},id4:{x:372,y:300,width:122,height:136},id5:{x:124,y:194,width:122,height:104},id6:{x:0,y:304,width:122,height:105},id7:{x:0,y:194,width:122,height:108},id8:{x:0,y:0,width:502,height:192}}},{id:"langText",file:"json/text.json"},{id:"info",file:"images/splashLogo.png"},{id:"bg0",file:"images/bg0.jpg"},{id:"bg1",file:"images/bg1.jpg"},{id:"bg2",file:"images/bg2.jpg"},{id:"bg3",file:"images/bg3.jpg"},{id:"bg4",file:"images/bg4.jpg"},{id:"fadeBg0",file:"images/spinBg0.jpg"},{id:"fadeBg1",file:"images/spinBg1.jpg"},{id:"fadeBg2",file:"images/spinBg2.jpg"}],ctx,canvas.width,canvas.height),oImageIds.net="id0",oImageIds.ball0="id1",oImageIds.ballShadow="id2",oImageIds.batShadow="id3",oImageIds.tableClip="id4",oImageIds.tableEdge="id5",oImageIds.bounceMark="id6",oImageIds.bat0="id7",oImageIds.bat1="id8",oImageIds.bat2="id9",oImageIds.bat3="id10",oImageIds.bat4="id11",oImageIds.bat5="id12",oImageIds.bat6="id13",oImageIds.bat7="id14",oImageIds.bat8="id15",oImageIds.bat9="id16",oImageIds.bat10="id17",oImageIds.bat11="id18",oImageIds.bat12="id19",oImageIds.bat13="id20",oImageIds.bat14="id21",oImageIds.bat15="id22",oImageIds.bat16="id23",oImageIds.bat17="id24",oImageIds.bat18="id25",oImageIds.bat19="id26",oImageIds.bat20="id27",oImageIds.bat21="id28",oImageIds.bat22="id29",oImageIds.bat23="id30",oImageIds.bat24="id31",oImageIds.bat25="id32",oImageIds.bat26="id33",oImageIds.bat27="id34",oImageIds.bat28="id35",oImageIds.bat29="id36",oImageIds.bat30="id37",oImageIds.bat31="id38",oImageIds.bat32="id39",oImageIds.bat33="id40",oImageIds.bat34="id41",oImageIds.bat35="id42",oImageIds.bat36="id43",oImageIds.bat37="id44",oImageIds.bat38="id45",oImageIds.bat39="id46",oImageIds.bat40="id47",oImageIds.bat41="id48",oImageIds.bat42="id49",oImageIds.bat43="id50",oImageIds.bat44="id51",oImageIds.bat45="id52",oImageIds.bat46="id53",oImageIds.bat47="id54",oImageIds.bat48="id55",oImageIds.bat49="id56",oImageIds.bat50="id57",oImageIds.bat51="id58",oImageIds.bat52="id59",oImageIds.bat53="id60",oImageIds.bat54="id61",oImageIds.bat55="id62",oImageIds.bat56="id63",oImageIds.batBehind0="id64",oImageIds.netReflect="id65",oImageIds.target0="id66",oImageIds.bot="id67",oImageIds.batBehind49="id68",oImageIds.batBehind50="id69",oImageIds.batBehind51="id70",oImageIds.batBehind52="id71",oImageIds.batBehind53="id72",oImageIds.batBehind54="id73",oImageIds.batBehind55="id74",oImageIds.batBehind56="id75",oImageIds.targetZoom="id76",oImageIds.target1="id77",oImageIds.bug0="id0",oImageIds.bug1="id1",oImageIds.bug2="id2",oImageIds.bug3="id3",oImageIds.bug4="id4",oImageIds.bug5="id5",oImageIds.bug6="id6",oImageIds.bug7="id7",oImageIds.bugBack="id8",oImageIds.award0="id0",oImageIds.award1="id1",oImageIds.award2="id2",oImageIds.award3="id3",oImageIds.award4="id4",oImageIds.award5="id5",oImageIds.award6="id6",oImageIds.award7="id7",oImageIds.award8="id8",oImageIds.award9="id9",oImageIds.award10="id10",oImageIds.award11="id11",oImageIds.award12="id12",oImageIds.award13="id13",oImageIds.award14="id14",oImageIds.award15="id15",oImageIds.award16="id16",oImageIds.awardBg="id17",oImageIds.batShopBut="id0",oImageIds.batShopButOver="id1",oImageIds.pvpGameBut="id2",oImageIds.pvpGameButOver="id3",oImageIds.infoBut="id4",oImageIds.infoButOver="id5",oImageIds.muteBut1="id6",oImageIds.muteBut1Over="id7",oImageIds.muteBut0="id8",oImageIds.muteBut0Over="id9",oImageIds.playBut="id10",oImageIds.playButOver="id11",oImageIds.rewardMultiplyBut="id12",oImageIds.rewardMultiplyButOver="id13",oImageIds.backBut="id14",oImageIds.backButOver="id15",oImageIds.pauseBut="id16",oImageIds.pauseButOver="id17",oImageIds.quitBut="id18",oImageIds.quitButOver="id19",oImageIds.continueBut="id20",oImageIds.continueButOver="id21",oImageIds.resetBut="id22",oImageIds.resetButOver="id23",oImageIds.awardsBut="id24",oImageIds.awardsButOver="id25",oImageIds.challengeBut="id26",oImageIds.challengeButOver="id27",oImageIds.arcadeBut="id28",oImageIds.arcadeButOver="id29",oImageIds.minusBut="id30",oImageIds.minusButOver="id31",oImageIds.plusBut="id32",oImageIds.plusButOver="id33",oImageIds.bugGameBut="id34",oImageIds.bugGameButOver="id35",oImageIds.tickBut="id36",oImageIds.tickButOver="id37",oImageIds.careerBut="id38",oImageIds.careerButOver="id39",oImageIds.shareBut="id40",oImageIds.shareButOver="id41",oImageIds.smallGem=getAssetId(!0),oImageIds.bigGem=getAssetId(),oImageIds.smallCup=getAssetId(),oImageIds.progressLine0=getAssetId(),oImageIds.progressLine1=getAssetId(),oImageIds.progressCup0=getAssetId(),oImageIds.progressCup2=getAssetId(),oImageIds.startFinger=getAssetId(),oImageIds.progressCup1=getAssetId(),oImageIds.star1=getAssetId(),oImageIds.star0=getAssetId(),oImageIds.progressCup3=getAssetId(),oImageIds.batShopOverlay0=getAssetId(),oImageIds.batShopUnderlay0=getAssetId(),oImageIds.batShopUnderlay1=getAssetId(),oImageIds.batShopUnderlay2=getAssetId(),oImageIds.batShopUnderlay3=getAssetId(),oImageIds.batDropShadow=getAssetId(),oImageIds.batLock=getAssetId(),oImageIds.rewardIcon=getAssetId(),oImageIds.tick=getAssetId(),oImageIds.batShopOverlay1=getAssetId(),oImageIds.batShopOverlay2=getAssetId(),oImageIds.batShopBorder0=getAssetId(),oImageIds.batShopBorder1=getAssetId(),oImageIds.batShopGlow=getAssetId(),oImageIds.targetIcon=getAssetId(),oImageIds.setsBg=getAssetId(),oImageIds.classicTick1=getAssetId(),oImageIds.classicTick0=getAssetId(),oImageIds.mousePointer=getAssetId(),oImageIds.stopWatch=getAssetId(),oImageIds.bugIcon=getAssetId(),oImageIds.map=getAssetId(),oImageIds.pin0=getAssetId(),oImageIds.pin1=getAssetId(),oImageIds.pin2=getAssetId(),oImageIds.shareHeader0=getAssetId(),oImageIds.shareTick=getAssetId(),oImageIds.shareHeader1=getAssetId(),oImageIds.crown=getAssetId(),oImageIds.flag0=getAssetId(!0);for(var e=1;e<aFlags.length;e++)oImageIds["flag"+e]=getAssetId();assetLib.onReady(initSplash),gameState="loading",previousTime=new Date().getTime(),updateLoaderEvent()}function getAssetId(e){return void 0===e&&(e=!1),e&&(assetIdInc=0),"id"+assetIdInc++}function resizeCanvas(){var e,t,a,s,i=window.innerWidth,r=window.innerHeight;switch(canvas.height=r,canvas.width=i,canvas.style.width=i+"px",canvas.style.height=r+"px",canvasScale=1,i<r?(e=maxWidth,t=maxHeight,a=minWidth,s=minHeight):(e=maxHeight,t=maxWidth,a=minHeight,s=minWidth),canvas.width/canvas.height<a/s?(canvas.width=e,canvas.height=e*(r/i),canvasScale=e/i):(canvas.height=s,canvas.width=s*(i/r),canvasScale=s/r),gameState){case"network":userInput.removeHitArea("urlAreaFromNetwork"),userInput.addHitArea("urlAreaFromNetwork",butEventHandler,null,"rect",{aRect:[200,200,canvas.width-200,canvas.height-200]},!0);break;case"game":isMobile&&1==gameplayState?(userInput.removeHitArea("gameTouch"),userInput.addHitArea("gameTouch",butEventHandler,{isDraggable:!0,multiTouch:!0},"rect",{aRect:[0,100,canvas.width,canvas.height]},!0)):0==gameplayState&&4!=gameVariation&&updateStartScreenButs();break;case"batShop":userInput.removeHitArea("batShopTouch"),userInput.addHitArea("batShopTouch",butEventHandler,{isDraggable:!0,multiTouch:!0},"rect",{aRect:[0,0,canvas.width,canvas.height]},!0)}prevCanvasWidth=i,prevCanvasHeight=r,window.scrollTo(0,0)}function playSound(e,t){if(void 0===t&&(t=1),1==audioType){var a=sound.play(e);sound.volume(t,a)}}function toggleMute(){muted=!muted,1==audioType?muted?(Howler.mute(!0),music.pause()):(Howler.mute(!1),playMusic(),1==gameplayState?music.volume(minMusicVol):music.volume(maxMusicVol)):2==audioType&&(muted?music.pause():playMusic())}